(function(A){var z="0.4.0",w="hasOwnProperty",v=/[\.\/]/,u="*",t=function(){},q=function(d,c){return d-c},p,o,n={n:{}},l=function(J,I){var H=n,G=o,F=Array.prototype.slice.call(arguments,2),E=l.listeners(J),D=0,C=!1,B,k=[],j={},i=[],h=[];p=J,o=0;for(var M=0,L=E.length;M<L;M++){"zIndex" in E[M]&&(k.push(E[M].zIndex),E[M].zIndex<0&&(j[E[M].zIndex]=E[M]))}k.sort(q);while(k[D]<0){B=j[k[D++]],i.push(B.apply(I,F));if(o){o=G;return i}}for(M=0;M<L;M++){B=E[M];if("zIndex" in B){if(B.zIndex==k[D]){i.push(B.apply(I,F));if(o){o=G;return i}do{D++,B=j[k[D]],B&&i.push(B.apply(I,F));if(o){o=G;return i}}while(B)}else{j[B.zIndex]=B}}else{i.push(B.apply(I,F));if(o){o=G;return i}}}o=G;return i.length?i:null};l.listeners=function(L){var J=L.split(v),I=n,H,G,F,E,D,C,B,j,e=[I],d=[];for(E=0,D=J.length;E<D;E++){j=[];for(C=0,B=e.length;C<B;C++){I=e[C].n,G=[I[J[E]],I[u]],F=2;while(F--){H=G[F],H&&(j.push(H),d=d.concat(H.f||[]))}}e=j}return d},l.on=function(f,d){var B=f.split(v),k=n;for(var j=0,i=B.length;j<i;j++){k=k.n,!k[B[j]]&&(k[B[j]]={n:{}}),k=k[B[j]]}k.f=k.f||[];for(j=0,i=k.f.length;j<i;j++){if(k.f[j]==d){return t}}k.f.push(d);return function(c){+c==+c&&(d.zIndex=+c)}},l.stop=function(){o=1},l.nt=function(c){if(c){return(new RegExp("(?:\\.|\\/|^)"+c+"(?:\\.|\\/|$)")).test(p)}return p},l.unbind=function(I,H){var G=I.split(v),F,E,D,C,B,j,e,d=[n];for(C=0,B=G.length;C<B;C++){for(j=0;j<d.length;j+=D.length-2){D=[j,1],F=d[j].n;if(G[C]!=u){F[G[C]]&&D.push(F[G[C]])}else{for(E in F){F[w](E)&&D.push(F[E])}}d.splice.apply(d,D)}}for(C=0,B=d.length;C<B;C++){F=d[C];while(F.n){if(H){if(F.f){for(j=0,e=F.f.length;j<e;j++){if(F.f[j]==H){F.f.splice(j,1);break}}!F.f.length&&delete F.f}for(E in F.n){if(F.n[w](E)&&F.n[E].f){var c=F.n[E].f;for(j=0,e=c.length;j<e;j++){if(c[j]==H){c.splice(j,1);break}}!c.length&&delete F.n[E].f}}}else{delete F.f;for(E in F.n){F.n[w](E)&&F.n[E].f&&delete F.n[E].f}}F=F.n}}},l.once=function(e,d){var f=function(){d.apply(this,arguments),l.unbind(e,f)};return l.on(e,f)},l.version=z,l.toString=function(){return"You are running Eve "+z},typeof module!="undefined"&&module.exports?module.exports=l:A.eve=l})(this),function(){function ad(bu,bt,bs,br,bq,bp){bs=cG(bs);var bo,bn,bm,bl=[],bk,bj,bh,be=bu.ms,bc={},ba={},Y={};if(br){for(U=0,S=ak.length;U<S;U++){var W=ak[U];if(W.el.id==bt.id&&W.anim==bu){W.percent!=bs?(ak.splice(U,1),bm=1):bn=W,bt.attr(W.totalOrigin);break}}}else{br=+ba}for(var U=0,S=bu.percents.length;U<S;U++){if(bu.percents[U]==bs||bu.percents[U]>br*bu.top){bs=bu.percents[U],bj=bu.percents[U-1]||0,be=be/bu.top*(bs-bj),bk=bu.percents[U+1],bo=bu.anim[bs];break}br&&bt.attr(bu.anim[bu.percents[U]])}if(!!bo){if(!bn){for(var bi in bo){if(bo[aR](bi)){if(cx[aR](bi)||bt.paper.customAttributes[aR](bi)){bc[bi]=bt.attr(bi),bc[bi]==null&&(bc[bi]=cA[bi]),ba[bi]=bo[bi];switch(cx[bi]){case c3:Y[bi]=(ba[bi]-bc[bi])/be;break;case"colour":bc[bi]=a2.getRGB(bc[bi]);var bg=a2.getRGB(ba[bi]);Y[bi]={r:(bg.r-bc[bi].r)/be,g:(bg.g-bc[bi].g)/be,b:(bg.b-bc[bi].b)/be};break;case"path":var bf=dj(bc[bi],ba[bi]),bd=bf[1];bc[bi]=bf[0],Y[bi]=[];for(U=0,S=bc[bi].length;U<S;U++){Y[bi][U]=[0];for(var bb=1,Z=bc[bi][U].length;bb<Z;bb++){Y[bi][U][bb]=(bd[U][bb]-bc[bi][U][bb])/be}}break;case"transform":var X=bt._,V=da(X[bi],ba[bi]);if(V){bc[bi]=V.from,ba[bi]=V.to,Y[bi]=[],Y[bi].real=!0;for(U=0,S=bc[bi].length;U<S;U++){Y[bi][U]=[bc[bi][U][0]];for(bb=1,Z=bc[bi][U].length;bb<Z;bb++){Y[bi][U][bb]=(ba[bi][U][bb]-bc[bi][U][bb])/be}}}else{var T=bt.matrix||new c9,Q={_:{transform:X.transform},getBBox:function(){return bt.getBBox(1)}};bc[bi]=[T.a,T.b,T.c,T.d,T.e,T.f],dc(Q,ba[bi]),ba[bi]=Q._.transform,Y[bi]=[(Q.matrix.a-T.a)/be,(Q.matrix.b-T.b)/be,(Q.matrix.c-T.c)/be,(Q.matrix.d-T.d)/be,(Q.matrix.e-T.e)/be,(Q.matrix.e-T.f)/be]}break;case"csv":var N=aA(bo[bi])[ay](aZ),C=aA(bc[bi])[ay](aZ);if(bi=="clip-rect"){bc[bi]=C,Y[bi]=[],U=C.length;while(U--){Y[bi][U]=(N[U]-bc[bi][U])/be}}ba[bi]=N;break;default:N=[][aI](bo[bi]),C=[][aI](bc[bi]),Y[bi]=[],U=bt.paper.customAttributes[bi].length;while(U--){Y[bi][U]=((N[U]||0)-(C[U]||0))/be}}}}}var n=bo.easing,c=a2.easing_formulas[n];if(!c){c=aA(n).match(cL);if(c&&c.length==5){var a=c;c=function(d){return af(d,+a[1],+a[2],+a[3],+a[4],be)}}else{c=cB}}bh=bo.start||bu.start||+(new Date),W={anim:bu,percent:bs,timestamp:bh,start:bh+(bu.del||0),status:0,initstatus:br||0,stop:!1,ms:be,easing:c,from:bc,diff:Y,to:ba,el:bt,callback:bo.callback,prev:bj,next:bk,repeat:bp||bu.times,origin:bt.attr(),totalOrigin:bq},ak.push(W);if(br&&!bn&&!bm){W.stop=!0,W.start=new Date-be*br;if(ak.length==1){return ah()}}bm&&(W.start=new Date-W.ms*br),ak.length==1&&ai(ah)}else{bn.initstatus=br,bn.start=new Date-bn.ms*br}eve("anim.start."+bt.id,bt,bu)}}function ae(h,f){var k=[],j={};this.ms=f,this.times=1;if(h){for(var i in h){h[aR](i)&&(j[cG(i)]=h[i],k.push(cG(i)))}k.sort(cF)}this.anim=j,this.top=k[k.length-1],this.percents=k}function af(H,G,F,E,D,C){function p(i,h){var L,J,I,o,n,l;for(I=i,l=0;l<8;l++){o=t(I)-i;if(aj(o)<h){return I}n=(3*z*I+2*A)*I+B;if(aj(n)<0.000001){break}I=I-o/n}L=0,J=1,I=i;if(I<L){return L}if(I>J){return J}while(L<J){o=t(I);if(aj(o-i)<h){return I}i>o?L=I:J=I,I=(J-L)/2+L}return I}function q(e,d){var f=p(e,d);return((u*f+v)*f+w)*f}function t(c){return((z*c+A)*c+B)*c}var B=3*G,A=3*(E-G)-B,z=1-B-A,w=3*F,v=3*(D-F)-w,u=1-w-v;return q(H,1/(200*C))}function aC(){return this.x+aB+this.y+aB+this.width+" × "+this.height}function aE(){return this.x+aB+this.y}function c9(i,h,n,l,k,j){i!=null?(this.a=+i,this.b=+h,this.c=+n,this.d=+l,this.e=+k,this.f=+j):(this.a=1,this.b=0,this.c=0,this.d=1,this.e=0,this.f=0)}function aV(h){var f=[];for(var k=0,j=h.length;j-2>k;k+=2){var i=[{x:+h[k],y:+h[k+1]},{x:+h[k],y:+h[k+1]},{x:+h[k+2],y:+h[k+3]},{x:+h[k+4],y:+h[k+5]}];j-4==k?(i[0]={x:+h[k-2],y:+h[k-1]},i[3]=i[2]):k&&(i[0]={x:+h[k-2],y:+h[k-1]}),f.push(["C",(-i[0].x+6*i[1].x+i[2].x)/6,(-i[0].y+6*i[1].y+i[2].y)/6,(i[1].x+6*i[2].x-i[3].x)/6,(i[1].y+6*i[2].y-i[3].y)/6,i[2].x,i[2].y])}return f}function aX(){return this.hex}function a1(f,e,i){function h(){var j=Array.prototype.slice.call(arguments,0),d=j.join("␀"),c=h.cache=h.cache||{},a=h.count=h.count||[];if(c[aR](d)){a3(a,d);return i?i(c[d]):c[d]}a.length>=1000&&delete c[a.shift()],a.push(d),c[d]=f[aJ](e,j);return i?i(c[d]):c[d]}return h}function a3(f,e){for(var i=0,h=f.length;i<h;i++){if(f[i]===e){return f.push(f.splice(i,1)[0])}}}function a2(h){if(a2.is(h,"function")){return a0?h():eve.on("DOMload",h)}if(a2.is(h,cZ)){return a2._engine.create[aJ](a2,h.splice(0,3+a2.is(h[0],c3))).add(h)}var f=Array.prototype.slice.call(arguments,0);if(a2.is(f[f.length-1],"function")){var a=f.pop();return a0?a.call(a2._engine.create[aJ](a2,f)):eve.on("DOMload",function(){a.call(a2._engine.create[aJ](a2,f))})}return a2._engine.create[aJ](a2,arguments)}a2.version="2.0.1",a2.eve=eve;var a0,aZ=/[, ]+/,aW={circle:1,rect:1,path:1,ellipse:1,text:1,image:1},aU=/\{(\d+)\}/g,aT="prototype",aR="hasOwnProperty",aP={doc:document,win:window},aN={was:Object.prototype[aR].call(aP.win,"Raphael"),is:aP.win.Raphael},aM=function(){this.ca=this.customAttributes={}},aL,aK="appendChild",aJ="apply",aI="concat",aG="createTouch" in aP.doc,aD="",aB=" ",aA=String,ay="split",aw="click dblclick mousedown mousemove mouseout mouseover mouseup touchstart touchmove touchend touchcancel"[ay](aB),au={mousedown:"touchstart",mousemove:"touchmove",mouseup:"touchend"},ar=aA.prototype.toLowerCase,ap=Math,an=ap.max,al=ap.min,aj=ap.abs,c7=ap.pow,c5=ap.PI,c3="number",c1="string",cZ="array",cX="toString",cV="fill",cT=Object.prototype.toString,cR={},cQ="push",cP=a2._ISURL=/^url\(['"]?([^\)]+?)['"]?\)$/i,cO=/^\s*((#[a-f\d]{6})|(#[a-f\d]{3})|rgba?\(\s*([\d\.]+%?\s*,\s*[\d\.]+%?\s*,\s*[\d\.]+%?(?:\s*,\s*[\d\.]+%?)?)\s*\)|hsba?\(\s*([\d\.]+(?:deg|\xb0|%)?\s*,\s*[\d\.]+%?\s*,\s*[\d\.]+(?:%?\s*,\s*[\d\.]+)?)%?\s*\)|hsla?\(\s*([\d\.]+(?:deg|\xb0|%)?\s*,\s*[\d\.]+%?\s*,\s*[\d\.]+(?:%?\s*,\s*[\d\.]+)?)%?\s*\))\s*$/i,cN={NaN:1,Infinity:1,"-Infinity":1},cL=/^(?:cubic-)?bezier\(([^,]+),([^,]+),([^,]+),([^\)]+)\)/,cK=ap.round,cI="setAttribute",cG=parseFloat,cE=parseInt,cC=aA.prototype.toUpperCase,cA=a2._availableAttrs={"arrow-end":"none","arrow-start":"none",blur:0,"clip-rect":"0 0 1e9 1e9",cursor:"default",cx:0,cy:0,fill:"#fff","fill-opacity":1,font:'10px "Arial"',"font-family":'"Arial"',"font-size":"10","font-style":"normal","font-weight":400,gradient:0,height:0,href:"http://raphaeljs.com/","letter-spacing":0,opacity:1,path:"M0,0",r:0,rx:0,ry:0,src:"",stroke:"#000","stroke-dasharray":"","stroke-linecap":"butt","stroke-linejoin":"butt","stroke-miterlimit":0,"stroke-opacity":1,"stroke-width":1,target:"_blank","text-anchor":"middle",title:"Raphael",transform:"",width:0,x:0,y:0},cx=a2._availableAnimAttrs={blur:c3,"clip-rect":"csv",cx:c3,cy:c3,fill:"colour","fill-opacity":c3,"font-size":c3,height:c3,opacity:c3,path:"path",r:c3,rx:c3,ry:c3,stroke:"colour","stroke-opacity":c3,"stroke-width":c3,transform:"transform",width:c3,x:c3,y:c3},cv=/\s*,\s*/,b8={hs:1,rg:1},b6=/,?([achlmqrstvxz]),?/gi,b4=/([achlmrqstvz])[\s,]*((-?\d*\.?\d*(?:e[\-+]?\d+)?\s*,?\s*)+)/ig,b2=/([rstm])[\s,]*((-?\d*\.?\d*(?:e[\-+]?\d+)?\s*,?\s*)+)/ig,dr=/(-?\d*\.?\d*(?:e[\-+]?\d+)?)\s*,?\s*/ig,a6=a2._radial_gradient=/^r(?:\(([^,]+?)\s*,\s*([^\)]+?)\))?/,cJ={},cH=function(d,c){return d.key-c.key},cF=function(d,c){return cG(d)-cG(c)},cD=function(){},cB=function(c){return c},cy=a2._rectPath=function(h,f,k,j,i){if(i){return[["M",h+i,f],["l",k-i*2,0],["a",i,i,0,0,1,i,i],["l",0,j-i*2],["a",i,i,0,0,1,-i,i],["l",i*2-k,0],["a",i,i,0,0,1,-i,-i],["l",0,i*2-j],["a",i,i,0,0,1,i,-i],["z"]]}return[["M",h,f],["l",k,0],["l",0,j],["l",-k,0],["z"]]},cw=function(f,e,i,h){h==null&&(h=i);return[["M",f,e],["m",0,-h],["a",i,h,0,1,1,0,2*h],["a",i,h,0,1,1,0,-2*h],["z"]]},b9=a2._getPath={path:function(c){return c.attr("path")},circle:function(d){var c=d.attrs;return cw(c.cx,c.cy,c.r)},ellipse:function(d){var c=d.attrs;return cw(c.cx,c.cy,c.rx,c.ry)},rect:function(d){var c=d.attrs;return cy(c.x,c.y,c.width,c.height,c.r)},image:function(d){var c=d.attrs;return cy(c.x,c.y,c.width,c.height)},text:function(d){var c=d._getBBox();return cy(c.x,c.y,c.width,c.height)}},b7=a2.mapPath=function(u,t){if(!t){return u}var q,p,o,n,l,k,j;u=dj(u);for(o=0,l=u.length;o<l;o++){j=u[o];for(n=1,k=j.length;n<k;n+=2){q=t.x(j[n],j[n+1]),p=t.y(j[n],j[n+1]),j[n]=q,j[n+1]=p}}return u};a2._g=aP,a2.type=aP.win.SVGAngle||aP.doc.implementation.hasFeature("http://www.w3.org/TR/SVG11/feature#BasicStructure","1.1")?"SVG":"VML";if(a2.type=="VML"){var b5=aP.doc.createElement("div"),b3;b5.innerHTML='<v:shape adj="1"/>',b3=b5.firstChild,b3.style.behavior="url(#default#VML)";if(!b3||typeof b3.adj!="object"){return a2.type=aD}b5=null}a2.svg=!(a2.vml=a2.type=="VML"),a2._Paper=aM,a2.fn=aL=aM.prototype=a2.prototype,a2._id=0,a2._oid=0,a2.is=function(d,c){c=ar.call(c);if(c=="finite"){return !cN[aR](+d)}if(c=="array"){return d instanceof Array}return c=="null"&&d===null||c==typeof d&&d!==null||c=="object"&&d===Object(d)||c=="array"&&Array.isArray&&Array.isArray(d)||cT.call(d).slice(8,-1).toLowerCase()==c},a2.angle=function(a,q,p,o,n,l){if(n==null){var k=a-p,j=q-o;if(!k&&!j){return 0}return(180+ap.atan2(-j,-k)*180/c5+360)%360}return a2.angle(a,q,n,l)-a2.angle(p,o,n,l)},a2.rad=function(c){return c%360*c5/180},a2.deg=function(c){return c*180/c5%360},a2.snapTo=function(a,k,j){j=a2.is(j,"finite")?j:10;if(a2.is(a,cZ)){var i=a.length;while(i--){if(aj(a[i]-k)<=j){return a[i]}}}else{a=+a;var h=k%a;if(h<j){return k-h}if(h>a-j){return k-h+a}}return k};var b1=a2.createUUID=function(d,c){return function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(d,c).toUpperCase()}}(/[xy]/g,function(e){var d=ap.random()*16|0,f=e=="x"?d:d&3|8;return f.toString(16)});a2.setWindow=function(a){eve("setWindow",a2,aP.win,a),aP.win=a,aP.doc=aP.win.document,a2._engine.initWin&&a2._engine.initWin(aP.win)};var b0=function(a){if(a2.vml){var o=/^\s+|\s+$/g,n;try{var l=new ActiveXObject("htmlfile");l.write("<body>"),l.close(),n=l.body}catch(k){n=createPopup().document.body}var j=n.createTextRange();b0=a1(function(d){try{n.style.color=aA(d).replace(o,aD);var c=j.queryCommandValue("ForeColor");c=(c&255)<<16|c&65280|(c&16711680)>>>16;return"#"+("000000"+c.toString(16)).slice(-6)}catch(f){return"none"}})}else{var h=aP.doc.createElement("i");h.title="Raphaël Colour Picker",h.style.display="none",aP.doc.body.appendChild(h),b0=a1(function(c){h.style.color=c;return aP.doc.defaultView.getComputedStyle(h,aD).getPropertyValue("color")})}return b0(a)},a9=function(){return"hsb("+[this.h,this.s,this.b]+")"},a8=function(){return"hsl("+[this.h,this.s,this.l]+")"},a7=function(){return this.hex},a5=function(a,i,h){i==null&&a2.is(a,"object")&&"r" in a&&"g" in a&&"b" in a&&(h=a.b,i=a.g,a=a.r);if(i==null&&a2.is(a,c1)){var f=a2.getRGB(a);a=f.r,i=f.g,h=f.b}if(a>1||i>1||h>1){a/=255,i/=255,h/=255}return[a,i,h]},a4=function(a,k,j,i){a*=255,k*=255,j*=255;var h={r:a,g:k,b:j,hex:a2.rgb(a,k,j),toString:a7};a2.is(i,"finite")&&(h.opacity=i);return h};a2.color=function(a){var d;a2.is(a,"object")&&"h" in a&&"s" in a&&"b" in a?(d=a2.hsb2rgb(a),a.r=d.r,a.g=d.g,a.b=d.b,a.hex=d.hex):a2.is(a,"object")&&"h" in a&&"s" in a&&"l" in a?(d=a2.hsl2rgb(a),a.r=d.r,a.g=d.g,a.b=d.b,a.hex=d.hex):(a2.is(a,"string")&&(a=a2.getRGB(a)),a2.is(a,"object")&&"r" in a&&"g" in a&&"b" in a?(d=a2.rgb2hsl(a),a.h=d.h,a.s=d.s,a.l=d.l,d=a2.rgb2hsb(a),a.v=d.b):(a={hex:"none"},a.r=a.g=a.b=a.h=a.s=a.v=a.l=-1)),a.toString=a7;return a},a2.hsb2rgb=function(u,t,q,p){this.is(u,"object")&&"h" in u&&"s" in u&&"b" in u&&(q=u.b,t=u.s,u=u.h,p=u.o),u*=360;var o,n,l,k,j;u=u%360/60,j=q*t,k=j*(1-aj(u%2-1)),o=n=l=q-j,u=~~u,o+=[j,k,0,0,k,j][u],n+=[k,j,j,k,0,0][u],l+=[0,0,k,j,j,k][u];return a4(o,n,l,p)},a2.hsl2rgb=function(u,t,q,p){this.is(u,"object")&&"h" in u&&"s" in u&&"l" in u&&(q=u.l,t=u.s,u=u.h);if(u>1||t>1||q>1){u/=360,t/=100,q/=100}u*=360;var o,n,l,k,j;u=u%360/60,j=2*t*(q<0.5?q:1-q),k=j*(1-aj(u%2-1)),o=n=l=q-j/2,u=~~u,o+=[j,k,0,0,k,j][u],n+=[k,j,j,k,0,0][u],l+=[0,0,k,j,j,k][u];return a4(o,n,l,p)},a2.rgb2hsb=function(i,h,o){o=a5(i,h,o),i=o[0],h=o[1],o=o[2];var n,l,k,j;k=an(i,h,o),j=k-al(i,h,o),n=j==0?null:k==i?(h-o)/j:k==h?(o-i)/j+2:(i-h)/j+4,n=(n+360)%6*60/360,l=j==0?0:j/k;return{h:n,s:l,b:k,toString:a9}},a2.rgb2hsl=function(u,t,q){q=a5(u,t,q),u=q[0],t=q[1],q=q[2];var p,o,n,l,k,j;l=an(u,t,q),k=al(u,t,q),j=l-k,p=j==0?null:l==u?(t-q)/j:l==t?(q-u)/j+2:(u-t)/j+4,p=(p+360)%6*60/360,n=(l+k)/2,o=j==0?0:n<0.5?j/(2*n):j/(2-2*n);return{h:p,s:o,l:n,toString:a8}},a2._path2string=function(){return this.join(",").replace(b6,"$1")};var aY=a2._preload=function(e,d){var f=aP.doc.createElement("img");f.style.cssText="position:absolute;left:-9999em;top:-9999em",f.onload=function(){d.call(this),this.onload=null,aP.doc.body.removeChild(this)},f.onerror=function(){aP.doc.body.removeChild(this)},aP.doc.body.appendChild(f),f.src=e};a2.getRGB=a1(function(v){if(!v||!!((v=aA(v)).indexOf("-")+1)){return{r:-1,g:-1,b:-1,hex:"none",error:1,toString:aX}}if(v=="none"){return{r:-1,g:-1,b:-1,hex:"none",toString:aX}}!b8[aR](v.toLowerCase().substring(0,2))&&v.charAt()!="#"&&(v=b0(v));var u,t,q,p,o,n,l,a=v.match(cO);if(a){a[2]&&(p=cE(a[2].substring(5),16),q=cE(a[2].substring(3,5),16),t=cE(a[2].substring(1,3),16)),a[3]&&(p=cE((n=a[3].charAt(3))+n,16),q=cE((n=a[3].charAt(2))+n,16),t=cE((n=a[3].charAt(1))+n,16)),a[4]&&(l=a[4][ay](cv),t=cG(l[0]),l[0].slice(-1)=="%"&&(t*=2.55),q=cG(l[1]),l[1].slice(-1)=="%"&&(q*=2.55),p=cG(l[2]),l[2].slice(-1)=="%"&&(p*=2.55),a[1].toLowerCase().slice(0,4)=="rgba"&&(o=cG(l[3])),l[3]&&l[3].slice(-1)=="%"&&(o/=100));if(a[5]){l=a[5][ay](cv),t=cG(l[0]),l[0].slice(-1)=="%"&&(t*=2.55),q=cG(l[1]),l[1].slice(-1)=="%"&&(q*=2.55),p=cG(l[2]),l[2].slice(-1)=="%"&&(p*=2.55),(l[0].slice(-3)=="deg"||l[0].slice(-1)=="°")&&(t/=360),a[1].toLowerCase().slice(0,4)=="hsba"&&(o=cG(l[3])),l[3]&&l[3].slice(-1)=="%"&&(o/=100);return a2.hsb2rgb(t,q,p,o)}if(a[6]){l=a[6][ay](cv),t=cG(l[0]),l[0].slice(-1)=="%"&&(t*=2.55),q=cG(l[1]),l[1].slice(-1)=="%"&&(q*=2.55),p=cG(l[2]),l[2].slice(-1)=="%"&&(p*=2.55),(l[0].slice(-3)=="deg"||l[0].slice(-1)=="°")&&(t/=360),a[1].toLowerCase().slice(0,4)=="hsla"&&(o=cG(l[3])),l[3]&&l[3].slice(-1)=="%"&&(o/=100);return a2.hsl2rgb(t,q,p,o)}a={r:t,g:q,b:p,toString:aX},a.hex="#"+(16777216|p|q<<8|t<<16).toString(16).slice(1),a2.is(o,"finite")&&(a.opacity=o);return a}return{r:-1,g:-1,b:-1,hex:"none",error:1,toString:aX}},a2),a2.hsb=a1(function(a,f,e){return a2.hsb2rgb(a,f,e).hex}),a2.hsl=a1(function(a,f,e){return a2.hsl2rgb(a,f,e).hex}),a2.rgb=a1(function(e,d,f){return"#"+(16777216|f|d<<8|e<<16).toString(16).slice(1)}),a2.getColor=function(e){var d=this.getColor.start=this.getColor.start||{h:0,s:1,b:e||0.75},f=this.hsb2rgb(d.h,d.s,d.b);d.h+=0.075,d.h>1&&(d.h=0,d.s-=0.2,d.s<=0&&(this.getColor.start={h:0,s:1,b:d.b}));return f.hex},a2.getColor.reset=function(){delete this.start},a2.parsePathString=a1(function(a){if(!a){return null}var f={a:7,c:6,h:1,l:2,m:2,r:4,q:4,s:4,t:2,v:1,z:0},e=[];a2.is(a,cZ)&&a2.is(a[0],cZ)&&(e=aQ(a)),e.length||aA(a).replace(b4,function(d,c,j){var i=[],h=c.toLowerCase();j.replace(dr,function(l,k){k&&i.push(+k)}),h=="m"&&i.length>2&&(e.push([c][aI](i.splice(0,2))),h="l",c=c=="m"?"l":"L");if(h=="r"){e.push([c][aI](i))}else{while(i.length>=f[h]){e.push([c][aI](i.splice(0,f[h])));if(!f[h]){break}}}}),e.toString=a2._path2string;return e}),a2.parseTransformString=a1(function(a){if(!a){return null}var f={r:3,s:4,t:2,m:6},e=[];a2.is(a,cZ)&&a2.is(a[0],cZ)&&(e=aQ(a)),e.length||aA(a).replace(b2,function(h,d,k){var j=[],i=ar.call(d);k.replace(dr,function(l,c){c&&j.push(+c)}),e.push([d][aI](j))}),e.toString=a2._path2string;return e}),a2.findDotsAtSegment=function(Y,X,W,V,U,T,S,R,Q){var P=1-Q,O=c7(P,3),N=c7(P,2),M=Q*Q,L=M*Q,J=O*Y+N*3*Q*W+P*3*Q*Q*U+L*S,I=O*X+N*3*Q*V+P*3*Q*Q*T+L*R,H=Y+2*Q*(W-Y)+M*(U-2*W+Y),G=X+2*Q*(V-X)+M*(T-2*V+X),F=W+2*Q*(U-W)+M*(S-2*U+W),E=V+2*Q*(T-V)+M*(R-2*T+V),D=P*Y+Q*W,C=P*X+Q*V,B=P*U+Q*S,A=P*T+Q*R,w=90-ap.atan2(H-F,G-E)*180/c5;(H>F||G<E)&&(w+=180);return{x:J,y:I,m:{x:H,y:G},n:{x:F,y:E},start:{x:D,y:C},end:{x:B,y:A},alpha:w}},a2._removedFactory=function(c){return function(){throw new Error("Raphaël: you are calling to method “"+c+"” of removed object")}};var aS=a1(function(A){if(!A){return{x:0,y:0,width:0,height:0}}A=dj(A);var z=0,w=0,v=[],u=[],t;for(var q=0,p=A.length;q<p;q++){t=A[q];if(t[0]=="M"){z=t[1],w=t[2],v.push(z),u.push(w)}else{var o=dk(z,w,t[1],t[2],t[3],t[4],t[5],t[6]);v=v[aI](o.min.x,o.max.x),u=u[aI](o.min.y,o.max.y),z=t[5],w=t[6]}}var n=al[aJ](0,v),l=al[aJ](0,u);return{x:n,y:l,width:an[aJ](0,v)-n,height:an[aJ](0,u)-l}},null,function(c){return{x:c.x,y:c.y,width:c.width,height:c.height}}),aQ=function(a){var l=[];if(!a2.is(a,cZ)||!a2.is(a&&a[0],cZ)){a=a2.parsePathString(a)}for(var k=0,j=a.length;k<j;k++){l[k]=[];for(var i=0,h=a[k].length;i<h;i++){l[k][i]=a[k][i]}}l.toString=a2._path2string;return l},aO=a2._pathToRelative=a1(function(J){if(!a2.is(J,cZ)||!a2.is(J&&J[0],cZ)){J=a2.parsePathString(J)}var I=[],H=0,G=0,F=0,E=0,D=0;J[0][0]=="M"&&(H=J[0][1],G=J[0][2],F=H,E=G,D++,I.push(["M",H,G]));for(var C=D,B=J.length;C<B;C++){var A=I[C]=[],z=J[C];if(z[0]!=ar.call(z[0])){A[0]=ar.call(z[0]);switch(A[0]){case"a":A[1]=z[1],A[2]=z[2],A[3]=z[3],A[4]=z[4],A[5]=z[5],A[6]=+(z[6]-H).toFixed(3),A[7]=+(z[7]-G).toFixed(3);break;case"v":A[1]=+(z[1]-G).toFixed(3);break;case"m":F=z[1],E=z[2];default:for(var w=1,v=z.length;w<v;w++){A[w]=+(z[w]-(w%2?H:G)).toFixed(3)}}}else{A=I[C]=[],z[0]=="m"&&(F=z[1]+H,E=z[2]+G);for(var u=0,t=z.length;u<t;u++){I[C][u]=z[u]}}var a=I[C].length;switch(I[C][0]){case"z":H=F,G=E;break;case"h":H+=+I[C][a-1];break;case"v":G+=+I[C][a-1];break;default:H+=+I[C][a-2],G+=+I[C][a-1]}}I.toString=a2._path2string;return I},0,aQ),dq=a2._pathToAbsolute=a1(function(I){if(!a2.is(I,cZ)||!a2.is(I&&I[0],cZ)){I=a2.parsePathString(I)}if(!I||!I.length){return[["M",0,0]]}var H=[],G=0,F=0,E=0,D=0,C=0;I[0][0]=="M"&&(G=+I[0][1],F=+I[0][2],E=G,D=F,C++,H[0]=["M",G,F]);for(var B,A,z=C,w=I.length;z<w;z++){H.push(B=[]),A=I[z];if(A[0]!=cC.call(A[0])){B[0]=cC.call(A[0]);switch(B[0]){case"A":B[1]=A[1],B[2]=A[2],B[3]=A[3],B[4]=A[4],B[5]=A[5],B[6]=+(A[6]+G),B[7]=+(A[7]+F);break;case"V":B[1]=+A[1]+F;break;case"H":B[1]=+A[1]+G;break;case"R":var v=[G,F][aI](A.slice(1));for(var u=2,t=v.length;u<t;u++){v[u]=+v[u]+G,v[++u]=+v[u]+F}H.pop(),H=H[aI](aV(v));break;case"M":E=+A[1]+G,D=+A[2]+F;default:for(u=1,t=A.length;u<t;u++){B[u]=+A[u]+(u%2?G:F)}}}else{if(A[0]=="R"){v=[G,F][aI](A.slice(1)),H.pop(),H=H[aI](aV(v)),B=["R"][aI](A.slice(-2))}else{for(var n=0,a=A.length;n<a;n++){B[n]=A[n]}}}switch(B[0]){case"Z":G=E,F=D;break;case"H":G=B[1];break;case"V":F=B[1];break;case"M":E=B[B.length-2],D=B[B.length-1];default:G=B[B.length-2],F=B[B.length-1]}}H.toString=a2._path2string;return H},null,aQ),dp=function(f,e,i,h){return[f,e,i,h,i,h]},dn=function(j,i,q,p,o,n){var l=1/3,k=2/3;return[l*j+k*q,l*i+k*p,l*o+k*q,l*n+k*p,o,n]},dm=function(bM,bL,bK,bJ,bI,bH,bG,bF,bE,bD){var bC=c5*120/180,bB=c5/180*(+bI||0),bA=[],bz,by=a1(function(h,f,k){var j=h*ap.cos(k)-f*ap.sin(k),i=h*ap.sin(k)+f*ap.cos(k);return{x:j,y:i}});if(!bD){bz=by(bM,bL,-bB),bM=bz.x,bL=bz.y,bz=by(bF,bE,-bB),bF=bz.x,bE=bz.y;var bx=ap.cos(c5/180*bI),bw=ap.sin(c5/180*bI),bv=(bM-bF)/2,bu=(bL-bE)/2,bt=bv*bv/(bK*bK)+bu*bu/(bJ*bJ);bt>1&&(bt=ap.sqrt(bt),bK=bt*bK,bJ=bt*bJ);var bs=bK*bK,br=bJ*bJ,bq=(bH==bG?-1:1)*ap.sqrt(aj((bs*br-bs*bu*bu-br*bv*bv)/(bs*bu*bu+br*bv*bv))),bp=bq*bK*bu/bJ+(bM+bF)/2,bo=bq*-bJ*bv/bK+(bL+bE)/2,bn=ap.asin(((bL-bo)/bJ).toFixed(9)),bm=ap.asin(((bE-bo)/bJ).toFixed(9));bn=bM<bp?c5-bn:bn,bm=bF<bp?c5-bm:bm,bn<0&&(bn=c5*2+bn),bm<0&&(bm=c5*2+bm),bG&&bn>bm&&(bn=bn-c5*2),!bG&&bm>bn&&(bm=bm-c5*2)}else{bn=bD[0],bm=bD[1],bp=bD[2],bo=bD[3]}var bl=bm-bn;if(aj(bl)>bC){var bk=bm,bj=bF,bi=bE;bm=bn+bC*(bG&&bm>bn?1:-1),bF=bp+bK*ap.cos(bm),bE=bo+bJ*ap.sin(bm),bA=dm(bF,bE,bK,bJ,bI,0,bG,bj,bi,[bm,bk,bp,bo])}bl=bm-bn;var bh=ap.cos(bn),bg=ap.sin(bn),bf=ap.cos(bm),be=ap.sin(bm),bd=ap.tan(bl/4),bc=4/3*bK*bd,bb=4/3*bJ*bd,ba=[bM,bL],Z=[bM+bc*bg,bL-bb*bh],Y=[bF+bc*be,bE-bb*bf],B=[bF,bE];Z[0]=2*ba[0]-Z[0],Z[1]=2*ba[1]-Z[1];if(bD){return[Z,Y,B][aI](bA)}bA=[Z,Y,B][aI](bA).join()[ay](",");var z=[];for(var w=0,n=bA.length;w<n;w++){z[w]=w%2?by(bA[w-1],bA[w],bB).y:by(bA[w],bA[w+1],bB).x}return z},dl=function(w,v,u,t,q,p,o,n,l){var k=1-l;return{x:c7(k,3)*w+c7(k,2)*3*l*u+k*3*l*l*q+c7(l,3)*o,y:c7(k,3)*v+c7(k,2)*3*l*t+k*3*l*l*p+c7(l,3)*n}},dk=a1(function(L,J,I,H,G,F,E,D){var C=G-2*I+L-(E-2*G+I),B=2*(I-L)-2*(G-I),A=L-I,z=(-B+ap.sqrt(B*B-4*C*A))/2/C,w=(-B-ap.sqrt(B*B-4*C*A))/2/C,v=[J,D],u=[L,E],t;aj(z)>"1e12"&&(z=0.5),aj(w)>"1e12"&&(w=0.5),z>0&&z<1&&(t=dl(L,J,I,H,G,F,E,D,z),u.push(t.x),v.push(t.y)),w>0&&w<1&&(t=dl(L,J,I,H,G,F,E,D,w),u.push(t.x),v.push(t.y)),C=F-2*H+J-(D-2*F+H),B=2*(H-J)-2*(F-H),A=J-H,z=(-B+ap.sqrt(B*B-4*C*A))/2/C,w=(-B-ap.sqrt(B*B-4*C*A))/2/C,aj(z)>"1e12"&&(z=0.5),aj(w)>"1e12"&&(w=0.5),z>0&&z<1&&(t=dl(L,J,I,H,G,F,E,D,z),u.push(t.x),v.push(t.y)),w>0&&w<1&&(t=dl(L,J,I,H,G,F,E,D,w),u.push(t.x),v.push(t.y));return{min:{x:al[aJ](0,u),y:al[aJ](0,v)},max:{x:an[aJ](0,u),y:an[aJ](0,v)}}}),dj=a2._path2curve=a1(function(I,H){var G=dq(I),F=H&&dq(H),E={x:0,y:0,bx:0,by:0,X:0,Y:0,qx:null,qy:null},D={x:0,y:0,bx:0,by:0,X:0,Y:0,qx:null,qy:null},C=function(f,e){var i,h;if(!f){return["C",e.x,e.y,e.x,e.y,e.x,e.y]}!(f[0] in {T:1,Q:1})&&(e.qx=e.qy=null);switch(f[0]){case"M":e.X=f[1],e.Y=f[2];break;case"A":f=["C"][aI](dm[aJ](0,[e.x,e.y][aI](f.slice(1))));break;case"S":i=e.x+(e.x-(e.bx||e.x)),h=e.y+(e.y-(e.by||e.y)),f=["C",i,h][aI](f.slice(1));break;case"T":e.qx=e.x+(e.x-(e.qx||e.x)),e.qy=e.y+(e.y-(e.qy||e.y)),f=["C"][aI](dn(e.x,e.y,e.qx,e.qy,f[1],f[2]));break;case"Q":e.qx=f[1],e.qy=f[2],f=["C"][aI](dn(e.x,e.y,f[1],f[2],f[3],f[4]));break;case"L":f=["C"][aI](dp(e.x,e.y,f[1],f[2]));break;case"H":f=["C"][aI](dp(e.x,e.y,f[1],e.y));break;case"V":f=["C"][aI](dp(e.x,e.y,e.x,f[1]));break;case"Z":f=["C"][aI](dp(e.x,e.y,e.X,e.Y))}return f},B=function(d,c){if(d[c].length>7){d[c].shift();var f=d[c];while(f.length){d.splice(c++,0,["C"][aI](f.splice(0,6)))}d.splice(c,1),w=an(G.length,F&&F.length||0)}},A=function(d,c,j,i,h){d&&c&&d[h][0]=="M"&&c[h][0]!="M"&&(c.splice(h,0,["M",i.x,i.y]),j.bx=0,j.by=0,j.x=d[h][1],j.y=d[h][2],w=an(G.length,F&&F.length||0))};for(var z=0,w=an(G.length,F&&F.length||0);z<w;z++){G[z]=C(G[z],E),B(G,z),F&&(F[z]=C(F[z],D)),F&&B(F,z),A(G,F,E,D,z),A(F,G,D,E,z);var v=G[z],u=F&&F[z],t=v.length,n=F&&u.length;E.x=v[t-2],E.y=v[t-1],E.bx=cG(v[t-4])||E.x,E.by=cG(v[t-3])||E.y,D.bx=F&&(cG(u[n-4])||D.x),D.by=F&&(cG(u[n-3])||D.y),D.x=F&&u[n-2],D.y=F&&u[n-1]}return F?[G,F]:G},null,aQ),di=a2._parseDots=a1(function(w){var v=[];for(var u=0,t=w.length;u<t;u++){var q={},p=w[u].match(/^([^:]*):?([\d\.]*)/);q.color=a2.getRGB(p[1]);if(q.color.error){return null}q.color=q.color.hex,p[2]&&(q.offset=p[2]+"%"),v.push(q)}for(u=1,t=v.length-1;u<t;u++){if(!v[u].offset){var o=cG(v[u-1].offset||0),n=0;for(var l=u+1;l<t;l++){if(v[l].offset){n=v[l].offset;break}}n||(n=100,l=t),n=cG(n);var a=(n-o)/(l-u+1);for(;u<l;u++){o+=a,v[u].offset=o+"%"}}}return v}),dh=a2._tear=function(d,c){d==c.top&&(c.top=d.prev),d==c.bottom&&(c.bottom=d.next),d.next&&(d.next.prev=d.prev),d.prev&&(d.prev.next=d.next)},dg=a2._tofront=function(d,c){c.top!==d&&(dh(d,c),d.next=null,d.prev=c.top,c.top.next=d,c.top=d)},df=a2._toback=function(d,c){c.bottom!==d&&(dh(d,c),d.next=c.bottom,d.prev=null,c.bottom.prev=d,c.bottom=d)},de=a2._insertafter=function(e,d,f){dh(e,f),d==f.top&&(f.top=e),d.next&&(d.next.prev=e),e.next=d.next,e.prev=d,d.next=e},dd=a2._insertbefore=function(e,d,f){dh(e,f),d==f.bottom&&(f.bottom=e),d.prev&&(d.prev.next=e),e.prev=d.prev,d.prev=e,e.next=d},dc=a2._extractTransform=function(T,S){if(S==null){return T._.transform}S=aA(S).replace(/\.{3}|\u2026/g,T._.transform||aD);var R=a2.parseTransformString(S),Q=0,P=0,O=0,N=1,M=1,L=T._,J=new c9;L.transform=R||[];if(R){for(var I=0,H=R.length;I<H;I++){var G=R[I],F=G.length,E=aA(G[0]).toLowerCase(),D=G[0]!=E,C=D?J.invert():0,B,A,z,p,a;E=="t"&&F==3?D?(B=C.x(0,0),A=C.y(0,0),z=C.x(G[1],G[2]),p=C.y(G[1],G[2]),J.translate(z-B,p-A)):J.translate(G[1],G[2]):E=="r"?F==2?(a=a||T.getBBox(1),J.rotate(G[1],a.x+a.width/2,a.y+a.height/2),Q+=G[1]):F==4&&(D?(z=C.x(G[2],G[3]),p=C.y(G[2],G[3]),J.rotate(G[1],z,p)):J.rotate(G[1],G[2],G[3]),Q+=G[1]):E=="s"?F==2||F==3?(a=a||T.getBBox(1),J.scale(G[1],G[F-1],a.x+a.width/2,a.y+a.height/2),N*=G[1],M*=G[F-1]):F==5&&(D?(z=C.x(G[3],G[4]),p=C.y(G[3],G[4]),J.scale(G[1],G[2],z,p)):J.scale(G[1],G[2],G[3],G[4]),N*=G[1],M*=G[2]):E=="m"&&F==7&&J.add(G[1],G[2],G[3],G[4],G[5],G[6]),L.dirtyT=1,T.matrix=J}}T.matrix=J,L.sx=N,L.sy=M,L.deg=Q,L.dx=P=J.e,L.dy=O=J.f,N==1&&M==1&&!Q&&L.bbox?(L.bbox.x+=+P,L.bbox.y+=+O):L.dirtyT=1},db=function(d){var c=d[0];switch(c.toLowerCase()){case"t":return[c,0,0];case"m":return[c,1,0,0,1,0,0];case"r":return d.length==4?[c,0,d[2],d[3]]:[c,0];case"s":return d.length==5?[c,1,1,d[3],d[4]]:d.length==3?[c,1,1]:[c,1]}},da=a2._equaliseTransform=function(w,v){v=aA(v).replace(/\.{3}|\u2026/g,w),w=a2.parseTransformString(w)||[],v=a2.parseTransformString(v)||[];var u=an(w.length,v.length),t=[],q=[],p=0,o,n,l,a;for(;p<u;p++){l=w[p]||db(v[p]),a=v[p]||db(l);if(l[0]!=a[0]||l[0].toLowerCase()=="r"&&(l[2]!=a[2]||l[3]!=a[3])||l[0].toLowerCase()=="s"&&(l[3]!=a[3]||l[4]!=a[4])){return}t[p]=[],q[p]=[];for(o=0,n=an(l.length,a.length);o<n;o++){o in l&&(t[p][o]=l[o]),o in a&&(q[p][o]=a[o])}}return{from:t,to:q}};a2._getContainer=function(a,k,j,i){var h;h=i==null&&!a2.is(a,"object")?aP.doc.getElementById(a):a;if(h!=null){if(h.tagName){return k==null?{container:h,width:h.style.pixelWidth||h.offsetWidth,height:h.style.pixelHeight||h.offsetHeight}:{container:h,width:k,height:j}}return{container:1,x:a,y:k,width:j,height:i}}},a2.pathToRelative=aO,a2._engine={},a2.path2curve=dj,a2.matrix=function(i,h,n,l,k,j){return new c9(i,h,n,l,k,j)},function(a){function e(d){var c=ap.sqrt(f(d));d[0]&&(d[0]/=c),d[1]&&(d[1]/=c)}function f(c){return c[0]*c[0]+c[1]*c[1]}a.add=function(D,C,B,A,z,w){var v=[[],[],[]],u=[[this.a,this.c,this.e],[this.b,this.d,this.f],[0,0,1]],t=[[D,B,z],[C,A,w],[0,0,1]],q,p,o,n;D&&D instanceof c9&&(t=[[D.a,D.c,D.e],[D.b,D.d,D.f],[0,0,1]]);for(q=0;q<3;q++){for(p=0;p<3;p++){n=0;for(o=0;o<3;o++){n+=u[q][o]*t[o][p]}v[q][p]=n}}this.a=v[0][0],this.b=v[1][0],this.c=v[0][1],this.d=v[1][1],this.e=v[0][2],this.f=v[1][2]},a.invert=function(){var d=this,c=d.a*d.d-d.b*d.c;return new c9(d.d/c,-d.b/c,-d.c/c,d.a/c,(d.c*d.f-d.d*d.e)/c,(d.b*d.e-d.a*d.f)/c)},a.clone=function(){return new c9(this.a,this.b,this.c,this.d,this.e,this.f)},a.translate=function(d,c){this.add(1,0,0,1,d,c)},a.scale=function(i,h,k,j){h==null&&(h=i),(k||j)&&this.add(1,0,0,1,k,j),this.add(i,0,0,h,0,0),(k||j)&&this.add(1,0,0,1,-k,-j)},a.rotate=function(h,l,k){h=a2.rad(h),l=l||0,k=k||0;var j=+ap.cos(h).toFixed(9),i=+ap.sin(h).toFixed(9);this.add(j,i,-i,j,l,k),this.add(1,0,0,1,-l,-k)},a.x=function(d,c){return d*this.a+c*this.c+this.e},a.y=function(d,c){return d*this.b+c*this.d+this.f},a.get=function(c){return +this[aA.fromCharCode(97+c)].toFixed(4)},a.toString=function(){return a2.svg?"matrix("+[this.get(0),this.get(1),this.get(2),this.get(3),this.get(4),this.get(5)].join()+")":[this.get(0),this.get(2),this.get(1),this.get(3),0,0].join()},a.toFilter=function(){return"progid:DXImageTransform.Microsoft.Matrix(M11="+this.get(0)+", M12="+this.get(2)+", M21="+this.get(1)+", M22="+this.get(3)+", Dx="+this.get(4)+", Dy="+this.get(5)+", sizingmethod='auto expand')"},a.offset=function(){return[this.e.toFixed(4),this.f.toFixed(4)]},a.split=function(){var c={};c.dx=this.e,c.dy=this.f;var i=[[this.a,this.c],[this.b,this.d]];c.scalex=ap.sqrt(f(i[0])),e(i[0]),c.shear=i[0][0]*i[1][0]+i[0][1]*i[1][1],i[1]=[i[1][0]-i[0][0]*c.shear,i[1][1]-i[0][1]*c.shear],c.scaley=ap.sqrt(f(i[1])),e(i[1]),c.shear/=c.scaley;var h=-i[0][1],d=i[1][1];d<0?(c.rotate=a2.deg(ap.acos(d)),h<0&&(c.rotate=360-c.rotate)):c.rotate=a2.deg(ap.asin(h)),c.isSimple=!+c.shear.toFixed(9)&&(c.scalex.toFixed(9)==c.scaley.toFixed(9)||!c.rotate),c.isSuperSimple=!+c.shear.toFixed(9)&&c.scalex.toFixed(9)==c.scaley.toFixed(9)&&!c.rotate,c.noRotation=!+c.shear.toFixed(9)&&!c.rotate;return c},a.toTransformString=function(d){var c=d||this[ay]();if(c.isSimple){c.scalex=+c.scalex.toFixed(4),c.scaley=+c.scaley.toFixed(4),c.rotate=+c.rotate.toFixed(4);return(c.dx&&c.dy?"t"+[c.dx,c.dy]:aD)+(c.scalex!=1||c.scaley!=1?"s"+[c.scalex,c.scaley,0,0]:aD)+(c.rotate?"r"+[c.rotate,0,0]:aD)}return"m"+[this.get(0),this.get(1),this.get(2),this.get(3),this.get(4),this.get(5)]}}(c9.prototype);var c8=navigator.userAgent.match(/Version\/(.*?)\s/)||navigator.userAgent.match(/Chrome\/(\d+)/);navigator.vendor=="Apple Computer, Inc."&&(c8&&c8[1]<4||navigator.platform.slice(0,2)=="iP")||navigator.vendor=="Google Inc."&&c8&&c8[1]<8?aL.safari=function(){var c=this.rect(-99,-99,this.width+99,this.height+99).attr({stroke:"none"});setTimeout(function(){c.remove()})}:aL.safari=cD;var c6=function(){this.returnValue=!1},c4=function(){return this.originalEvent.preventDefault()},c2=function(){this.cancelBubble=!0},c0=function(){return this.originalEvent.stopPropagation()},cY=function(){if(aP.doc.addEventListener){return function(i,h,n,l){var k=aG&&au[h]?au[h]:h,j=function(t){var q=aP.doc.documentElement.scrollTop||aP.doc.body.scrollTop,p=aP.doc.documentElement.scrollLeft||aP.doc.body.scrollLeft,o=t.clientX+p,d=t.clientY+q;if(aG&&au[aR](h)){for(var c=0,a=t.targetTouches&&t.targetTouches.length;c<a;c++){if(t.targetTouches[c].target==i){var u=t;t=t.targetTouches[c],t.originalEvent=u,t.preventDefault=c4,t.stopPropagation=c0;break}}}return n.call(l,t,o,d)};i.addEventListener(k,j,!1);return function(){i.removeEventListener(k,j,!1);return !0}}}if(aP.doc.attachEvent){return function(i,h,n,l){var k=function(d){d=d||aP.win.event;var c=aP.doc.documentElement.scrollTop||aP.doc.body.scrollTop,q=aP.doc.documentElement.scrollLeft||aP.doc.body.scrollLeft,p=d.clientX+q,o=d.clientY+c;d.preventDefault=d.preventDefault||c6,d.stopPropagation=d.stopPropagation||c2;return n.call(l,d,p,o)};i.attachEvent("on"+h,k);var j=function(){i.detachEvent("on"+h,k);return !0};return j}}}(),cW=[],cU=function(F){var E=F.clientX,D=F.clientY,C=aP.doc.documentElement.scrollTop||aP.doc.body.scrollTop,B=aP.doc.documentElement.scrollLeft||aP.doc.body.scrollLeft,A,z=cW.length;while(z--){A=cW[z];if(aG){var w=F.touches.length,v;while(w--){v=F.touches[w];if(v.identifier==A.el._drag.id){E=v.clientX,D=v.clientY,(F.originalEvent?F.originalEvent:F).preventDefault();break}}}else{F.preventDefault()}var u=A.el.node,t,q=u.nextSibling,o=u.parentNode,h=u.style.display;aP.win.opera&&o.removeChild(u),u.style.display="none",t=A.el.paper.getElementByPoint(E,D),u.style.display=h,aP.win.opera&&(q?o.insertBefore(u,q):o.appendChild(u)),t&&eve("drag.over."+A.el.id,A.el,t),E+=B,D+=C,eve("drag.move."+A.el.id,A.move_scope||A.el,E-A.el._drag.x,D-A.el._drag.y,E,D,F)}},cS=function(a){a2.unmousemove(cU).unmouseup(cS);var f=cW.length,e;while(f--){e=cW[f],e.el._drag={},eve("drag.end."+e.el.id,e.end_scope||e.start_scope||e.move_scope||e.el,a)}cW=[]},ds=a2.el={};for(var cM=aw.length;cM--;){(function(a){a2[a]=ds[a]=function(f,e){a2.is(f,"function")&&(this.events=this.events||[],this.events.push({name:a,f:f,unbind:cY(this.shape||this.node||aP.doc,a,f,e||this)}));return this},a2["un"+a]=ds["un"+a]=function(e){var h=this.events,f=h.length;while(f--){if(h[f].name==a&&h[f].f==e){h[f].unbind(),h.splice(f,1),!h.length&&delete this.events;return this}}return this}})(aw[cM])}ds.data=function(a,i){var h=cJ[this.id]=cJ[this.id]||{};if(arguments.length==1){if(a2.is(a,"object")){for(var f in a){a[aR](f)&&this.data(f,a[f])}return this}eve("data.get."+this.id,this,h[a],a);return h[a]}h[a]=i,eve("data.set."+this.id,this,i,a);return this},ds.removeData=function(c){c==null?cJ[this.id]={}:cJ[this.id]&&delete cJ[this.id][c];return this},ds.hover=function(f,e,i,h){return this.mouseover(f,i).mouseout(e,h||i)},ds.unhover=function(d,c){return this.unmouseover(d).unmouseout(c)};var aH=[];ds.drag=function(a,o,n,l,k,j){function h(e){(e.originalEvent||e).preventDefault();var d=aP.doc.documentElement.scrollTop||aP.doc.body.scrollTop,c=aP.doc.documentElement.scrollLeft||aP.doc.body.scrollLeft;this._drag.x=e.clientX+c,this._drag.y=e.clientY+d,this._drag.id=e.identifier,!cW.length&&a2.mousemove(cU).mouseup(cS),cW.push({el:this,move_scope:l,start_scope:k,end_scope:j}),o&&eve.on("drag.start."+this.id,o),a&&eve.on("drag.move."+this.id,a),n&&eve.on("drag.end."+this.id,n),eve("drag.start."+this.id,k||l||this,e.clientX+c,e.clientY+d,e)}this._drag={},aH.push({el:this,start:h}),this.mousedown(h);return this},ds.onDragOver=function(c){c?eve.on("drag.over."+this.id,c):eve.unbind("drag.over."+this.id)},ds.undrag=function(){var a=aH.length;while(a--){aH[a].el==this&&(this.unmousedown(aH[a].start),aH.splice(a,1),eve.unbind("drag.*."+this.id))}!aH.length&&a2.unmousemove(cU).unmouseup(cS)},aL.circle=function(a,i,h){var f=a2._engine.circle(this,a||0,i||0,h||0);this.__set__&&this.__set__.push(f);return f},aL.rect=function(a,l,k,j,i){var h=a2._engine.rect(this,a||0,l||0,k||0,j||0,i||0);this.__set__&&this.__set__.push(h);return h},aL.ellipse=function(a,k,j,i){var h=a2._engine.ellipse(this,a||0,k||0,j||0,i||0);this.__set__&&this.__set__.push(h);return h},aL.path=function(a){a&&!a2.is(a,c1)&&!a2.is(a[0],cZ)&&(a+=aD);var d=a2._engine.path(a2.format[aJ](a2,arguments),this);this.__set__&&this.__set__.push(d);return d},aL.image=function(a,l,k,j,i){var h=a2._engine.image(this,a||"about:blank",l||0,k||0,j||0,i||0);this.__set__&&this.__set__.push(h);return h},aL.text=function(a,i,h){var f=a2._engine.text(this,a||0,i||0,aA(h));this.__set__&&this.__set__.push(f);return f},aL.set=function(a){!a2.is(a,"array")&&(a=Array.prototype.splice.call(arguments,0,arguments.length));var d=new ac(a);this.__set__&&this.__set__.push(d);return d},aL.setStart=function(c){this.__set__=c||this.set()},aL.setFinish=function(d){var c=this.__set__;delete this.__set__;return c},aL.setSize=function(a,d){return a2._engine.setSize.call(this,a,d)},aL.setViewBox=function(a,k,j,i,h){return a2._engine.setViewBox.call(this,a,k,j,i,h)},aL.top=aL.bottom=null,aL.raphael=a2;var aF=function(u){var t=u.getBoundingClientRect(),q=u.ownerDocument,p=q.body,o=q.documentElement,n=o.clientTop||p.clientTop||0,l=o.clientLeft||p.clientLeft||0,k=t.top+(aP.win.pageYOffset||o.scrollTop||p.scrollTop)-n,h=t.left+(aP.win.pageXOffset||o.scrollLeft||p.scrollLeft)-l;return{y:k,x:h}};aL.getElementByPoint=function(j,h){var q=this,p=q.canvas,o=aP.doc.elementFromPoint(j,h);if(aP.win.opera&&o.tagName=="svg"){var n=aF(p),l=p.createSVGRect();l.x=j-n.x,l.y=h-n.y,l.width=l.height=1;var k=p.getIntersectionList(l,null);k.length&&(o=k[k.length-1])}if(!o){return null}while(o.parentNode&&o!=p.parentNode&&!o.raphael){o=o.parentNode}o==q.canvas.parentNode&&(o=p),o=o&&o.raphael?q.getById(o.raphaelid):null;return o},aL.getById=function(d){var c=this.bottom;while(c){if(c.id==d){return c}c=c.next}return null},aL.forEach=function(e,d){var f=this.bottom;while(f){if(e.call(d,f)===!1){return this}f=f.next}return this},ds.getBBox=function(d){if(this.removed){return{}}var c=this._;if(d){if(c.dirty||!c.bboxwt){this.realPath=b9[this.type](this),c.bboxwt=aS(this.realPath),c.bboxwt.toString=aC,c.dirty=0}return c.bboxwt}if(c.dirty||c.dirtyT||!c.bbox){if(c.dirty||!this.realPath){c.bboxwt=0,this.realPath=b9[this.type](this)}c.bbox=aS(b7(this.realPath,this.matrix)),c.bbox.toString=aC,c.dirty=c.dirtyT=0}return c.bbox},ds.clone=function(){if(this.removed){return null}var c=this.paper[this.type]().attr(this.attr());this.__set__&&this.__set__.push(c);return c},ds.glow=function(i){if(this.type=="text"){return null}i=i||{};var h={width:(i.width||10)+(+this.attr("stroke-width")||1),fill:i.fill||!1,opacity:i.opacity||0.5,offsetx:i.offsetx||0,offsety:i.offsety||0,color:i.color||"#000"},o=h.width/2,n=this.paper,l=n.set(),k=this.realPath||b9[this.type](this);k=this.matrix?b7(k,this.matrix):k;for(var j=1;j<o+1;j++){l.push(n.path(k).attr({stroke:h.color,fill:h.fill?h.color:"none","stroke-linejoin":"round","stroke-linecap":"round","stroke-width":+(h.width/o*j).toFixed(3),opacity:+(h.opacity/o).toFixed(3)}))}return l.insertBefore(this).translate(h.offsetx,h.offsety)};var az={},ax=function(L,J,I,H,G,F,E,D,C){var B=0,A=100,z=[L,J,I,H,G,F,E,D].join(),w=az[z],v,u;!w&&(az[z]=w={data:[]}),w.timer&&clearTimeout(w.timer),w.timer=setTimeout(function(){delete az[z]},2000);if(C!=null&&!w.precision){var t=ax(L,J,I,H,G,F,E,D);w.precision=~~t*10,w.data=[]}A=w.precision||A;for(var a=0;a<A+1;a++){w.data[a*A]?u=w.data[a*A]:(u=a2.findDotsAtSegment(L,J,I,H,G,F,E,D,a/A),w.data[a*A]=u),a&&(B+=c7(c7(v.x-u.x,2)+c7(v.y-u.y,2),0.5));if(C!=null&&B>=C){return u}v=u}if(C==null){return B}},av=function(a,d){return function(F,E,D){F=dj(F);var C,B,A,z,w="",v={},u,t=0;for(var q=0,c=F.length;q<c;q++){A=F[q];if(A[0]=="M"){C=+A[1],B=+A[2]}else{z=ax(C,B,A[1],A[2],A[3],A[4],A[5],A[6]);if(t+z>E){if(d&&!v.start){u=ax(C,B,A[1],A[2],A[3],A[4],A[5],A[6],E-t),w+=["C"+u.start.x,u.start.y,u.m.x,u.m.y,u.x,u.y];if(D){return w}v.start=w,w=["M"+u.x,u.y+"C"+u.n.x,u.n.y,u.end.x,u.end.y,A[5],A[6]].join(),t+=z,C=+A[5],B=+A[6];continue}if(!a&&!d){u=ax(C,B,A[1],A[2],A[3],A[4],A[5],A[6],E-t);return{x:u.x,y:u.y,alpha:u.alpha}}}t+=z,C=+A[5],B=+A[6]}w+=A.shift()+A}v.end=w,u=a?t:d?v:a2.findDotsAtSegment(C,B,A[0],A[1],A[2],A[3],A[4],A[5],1),u.alpha&&(u={x:u.x,y:u.y,alpha:u.alpha});return u}},at=av(1),aq=av(),ao=av(0,1);a2.getTotalLength=at,a2.getPointAtLength=aq,a2.getSubpath=function(f,e,i){if(this.getTotalLength(f)-i<0.000001){return ao(f,e).end}var h=ao(f,i,1);return e?ao(h,e).end:h},ds.getTotalLength=function(){if(this.type=="path"){if(this.node.getTotalLength){return this.node.getTotalLength()}return at(this.attrs.path)}},ds.getPointAtLength=function(c){if(this.type=="path"){return aq(this.attrs.path,c)}},ds.getSubpath=function(a,d){if(this.type=="path"){return a2.getSubpath(this.attrs.path,a,d)}};var am=a2.easing_formulas={linear:function(c){return c},"<":function(c){return c7(c,1.7)},">":function(c){return c7(c,0.48)},"<>":function(j){var i=0.48-j/1.04,q=ap.sqrt(0.1734+i*i),p=q-i,o=c7(aj(p),1/3)*(p<0?-1:1),n=-q-i,l=c7(aj(n),1/3)*(n<0?-1:1),k=o+l+0.5;return(1-k)*3*k*k+k*k*k},backIn:function(d){var c=1.70158;return d*d*((c+1)*d-c)},backOut:function(d){d=d-1;var c=1.70158;return d*d*((c+1)*d+c)+1},elastic:function(c){if(c==!!c){return c}return c7(2,-10*c)*ap.sin((c-0.075)*2*c5/0.3)+1},bounce:function(f){var e=7.5625,i=2.75,h;f<1/i?h=e*f*f:f<2/i?(f-=1.5/i,h=e*f*f+0.75):f<2.5/i?(f-=2.25/i,h=e*f*f+0.9375):(f-=2.625/i,h=e*f*f+0.984375);return h}};am.easeIn=am["ease-in"]=am["<"],am.easeOut=am["ease-out"]=am[">"],am.easeInOut=am["ease-in-out"]=am["<>"],am["back-in"]=am.backIn,am["back-out"]=am.backOut;var ak=[],ai=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(c){setTimeout(c,16)},ah=function(){var V=+(new Date),U=0;for(;U<ak.length;U++){var T=ak[U];if(T.el.removed||T.paused){continue}var S=V-T.start,R=T.ms,Q=T.easing,P=T.from,O=T.diff,N=T.to,M=T.t,L=T.el,J={},I,G={},F;T.initstatus?(S=(T.initstatus*T.anim.top-T.prev)/(T.percent-T.prev)*R,T.status=T.initstatus,delete T.initstatus,T.stop&&ak.splice(U--,1)):T.status=(T.prev+(T.percent-T.prev)*(S/R))/T.anim.top;if(S<0){continue}if(S<R){var E=Q(S/R);for(var D in P){if(P[aR](D)){switch(cx[D]){case c3:I=+P[D]+E*R*O[D];break;case"colour":I="rgb("+[ag(cK(P[D].r+E*R*O[D].r)),ag(cK(P[D].g+E*R*O[D].g)),ag(cK(P[D].b+E*R*O[D].b))].join(",")+")";break;case"path":I=[];for(var C=0,B=P[D].length;C<B;C++){I[C]=[P[D][C][0]];for(var q=1,n=P[D][C].length;q<n;q++){I[C][q]=+P[D][C][q]+E*R*O[D][C][q]}I[C]=I[C].join(aB)}I=I.join(aB);break;case"transform":if(O[D].real){I=[];for(C=0,B=P[D].length;C<B;C++){I[C]=[P[D][C][0]];for(q=1,n=P[D][C].length;q<n;q++){I[C][q]=P[D][C][q]+E*R*O[D][C][q]}}}else{var a=function(c){return +P[D][c]+E*R*O[D][c]};I=[["m",a(0),a(1),a(2),a(3),a(4),a(5)]]}break;case"csv":if(D=="clip-rect"){I=[],C=4;while(C--){I[C]=+P[D][C]+E*R*O[D][C]}}break;default:var H=[][aI](P[D]);I=[],C=L.paper.customAttributes[D].length;while(C--){I[C]=+H[C]+E*R*O[D][C]}}J[D]=I}}L.attr(J),function(e,d,f){setTimeout(function(){eve("anim.frame."+e,d,f)})}(L.id,L,T.anim)}else{(function(e,h,f){setTimeout(function(){eve("anim.frame."+h.id,h,f),eve("anim.finish."+h.id,h,f),a2.is(e,"function")&&e.call(h)})})(T.callback,L,T.anim),L.attr(N),ak.splice(U--,1);if(T.repeat>1&&!T.next){for(F in N){N[aR](F)&&(G[F]=T.totalOrigin[F])}T.el.attr(G),ad(T.anim,T.el,T.anim.percents[0],null,T.totalOrigin,T.repeat-1)}T.next&&!T.stop&&ad(T.anim,T.el,T.next,null,T.totalOrigin,T.repeat)}}a2.svg&&L&&L.paper&&L.paper.safari(),ak.length&&ai(ah)},ag=function(c){return c>255?255:c<0?0:c};ds.animateWith=function(a,q,p,o,n,l){var k=p?a2.animation(p,o,n,l):q,j=a.status(q);return this.animate(k).status(k,j*q.ms/k.ms)},ds.onAnimation=function(c){c?eve.on("anim.frame."+this.id,c):eve.unbind("anim.frame."+this.id);return this},ae.prototype.delay=function(d){var c=new ae(this.anim,this.ms);c.times=this.times,c.del=+d||0;return c},ae.prototype.repeat=function(d){var c=new ae(this.anim,this.ms);c.del=this.del,c.times=ap.floor(an(d,0))||1;return c},a2.animation=function(a,p,o,n){if(a instanceof ae){return a}if(a2.is(o,"function")||!o){n=n||o||null,o=null}a=Object(a),p=+p||0;var l={},k,j;for(j in a){a[aR](j)&&cG(j)!=j&&cG(j)+"%"!=j&&(k=!0,l[j]=a[j])}if(!k){return new ae(a,p)}o&&(l.easing=o),n&&(l.callback=n);return new ae({100:l},p)},ds.animate=function(a,l,k,j){var i=this;if(i.removed){j&&j.call(i);return i}var h=a instanceof ae?a:a2.animation(a,l,k,j);ad(h,i,h.percents[0],null,i.attr());return i},ds.setTime=function(d,c){d&&c!=null&&this.status(d,al(c,d.ms)/d.ms);return this},ds.status=function(i,h){var n=[],l=0,k,j;if(h!=null){ad(i,this,-1,al(h,1));return this}k=ak.length;for(;l<k;l++){j=ak[l];if(j.el.id==this.id&&(!i||j.anim==i)){if(i){return j.status}n.push({anim:j.anim,status:j.status})}}if(i){return 0}return n},ds.pause=function(d){for(var c=0;c<ak.length;c++){ak[c].el.id==this.id&&(!d||ak[c].anim==d)&&eve("anim.pause."+this.id,this,ak[c].anim)!==!1&&(ak[c].paused=!0)}return this},ds.resume=function(e){for(var d=0;d<ak.length;d++){if(ak[d].el.id==this.id&&(!e||ak[d].anim==e)){var f=ak[d];eve("anim.resume."+this.id,this,f.anim)!==!1&&(delete f.paused,this.status(f.anim,f.status))}}return this},ds.stop=function(d){for(var c=0;c<ak.length;c++){ak[c].el.id==this.id&&(!d||ak[c].anim==d)&&eve("anim.stop."+this.id,this,ak[c].anim)!==!1&&ak.splice(c--,1)}return this},ds.toString=function(){return"Raphaël’s object"};var ac=function(e){this.items=[],this.length=0,this.type="set";if(e){for(var d=0,f=e.length;d<f;d++){e[d]&&(e[d].constructor==ds.constructor||e[d].constructor==ac)&&(this[this.items.length]=this.items[this.items.length]=e[d],this.length++)}}},ab=ac.prototype;ab.push=function(){var f,e;for(var i=0,h=arguments.length;i<h;i++){f=arguments[i],f&&(f.constructor==ds.constructor||f.constructor==ac)&&(e=this.items.length,this[e]=this.items[e]=f,this.length++)}return this},ab.pop=function(){this.length&&delete this[this.length--];return this.items.pop()},ab.forEach=function(f,e){for(var i=0,h=this.items.length;i<h;i++){if(f.call(e,this.items[i],i)===!1){return this}}return this};for(var aa in ds){ds[aR](aa)&&(ab[aa]=function(c){return function(){var a=arguments;return this.forEach(function(d){d[c][aJ](d,a)})}}(aa))}ab.attr=function(a,l){if(a&&a2.is(a,cZ)&&a2.is(a[0],"object")){for(var k=0,j=a.length;k<j;k++){this.items[k].attr(a[k])}}else{for(var i=0,h=this.items.length;i<h;i++){this.items[i].attr(a,l)}}return this},ab.clear=function(){while(this.length){this.pop()}},ab.splice=function(j,i,q){j=j<0?an(this.length+j,0):j,i=an(0,al(this.length-j,i));var p=[],o=[],n=[],l;for(l=2;l<arguments.length;l++){n.push(arguments[l])}for(l=0;l<i;l++){o.push(this[j+l])}for(;l<this.length-j;l++){p.push(this[j+l])}var k=n.length;for(l=0;l<k+p.length;l++){this.items[j+l]=this[j+l]=l<k?n[l]:p[l-k]}l=this.items.length=this.length-=i-k;while(this[l]){delete this[l++]}return new ac(o)},ab.exclude=function(e){for(var d=0,f=this.length;d<f;d++){if(this[d]==e){this.splice(d,1);return !0}}},ab.animate=function(w,v,u,t){(a2.is(u,"function")||!u)&&(t=u||null);var q=this.items.length,p=q,o,n=this,l;if(!q){return this}t&&(l=function(){!--q&&t.call(n)}),u=a2.is(u,c1)?u:l;var a=a2.animation(w,v,u,l);o=this.items[--p].animate(a);while(p--){this.items[p]&&!this.items[p].removed&&this.items[p].animateWith(o,a)}return this},ab.insertAfter=function(d){var c=this.items.length;while(c--){this.items[c].insertAfter(d)}return this},ab.getBBox=function(){var i=[],h=[],n=[],l=[];for(var k=this.items.length;k--;){if(!this.items[k].removed){var j=this.items[k].getBBox();i.push(j.x),h.push(j.y),n.push(j.x+j.width),l.push(j.y+j.height)}}i=al[aJ](0,i),h=al[aJ](0,h);return{x:i,y:h,width:an[aJ](0,n)-i,height:an[aJ](0,l)-h}},ab.clone=function(e){e=new ac;for(var d=0,f=this.items.length;d<f;d++){e.push(this.items[d].clone())}return e},ab.toString=function(){return"Raphaël‘s set"},a2.registerFont=function(j){if(!j.face){return j}this.fonts=this.fonts||{};var i={w:j.w,face:{},glyphs:{}},p=j.face["font-family"];for(var o in j.face){j.face[aR](o)&&(i.face[o]=j.face[o])}this.fonts[p]?this.fonts[p].push(i):this.fonts[p]=[i];if(!j.svg){i.face["units-per-em"]=cE(j.face["units-per-em"],10);for(var n in j.glyphs){if(j.glyphs[aR](n)){var l=j.glyphs[n];i.glyphs[n]={w:l.w,k:{},d:l.d&&"M"+l.d.replace(/[mlcxtrv]/g,function(c){return{l:"L",c:"C",x:"z",t:"m",r:"l",v:"c"}[c]||"M"})+"z"};if(l.k){for(var k in l.k){l[aR](k)&&(i.glyphs[n].k[k]=l.k[k])}}}}}return j},aL.getFont=function(z,w,v,u){u=u||"normal",v=v||"normal",w=+w||{normal:400,bold:700,lighter:300,bolder:800}[w]||400;if(!!a2.fonts){var t=a2.fonts[z];if(!t){var q=new RegExp("(^|\\s)"+z.replace(/[^\w\d\s+!~.:_-]/g,aD)+"(\\s|$)","i");for(var p in a2.fonts){if(a2.fonts[aR](p)&&q.test(p)){t=a2.fonts[p];break}}}var o;if(t){for(var n=0,a=t.length;n<a;n++){o=t[n];if(o.face["font-weight"]==w&&(o.face["font-style"]==v||!o.face["font-style"])&&o.face["font-stretch"]==u){break}}}return o}},aL.print=function(Q,P,O,N,M,L,J){L=L||"middle",J=an(al(J||0,1),-1);var I=this.set(),H=aA(O)[ay](aD),G=0,F=aD,E;a2.is(N,O)&&(N=this.getFont(N));if(N){E=(M||16)/N.face["units-per-em"];var D=N.face.bbox[ay](aZ),C=+D[0],B=+D[1]+(L=="baseline"?D[3]-D[1]+ +N.face.descent:(D[3]-D[1])/2);for(var A=0,p=H.length;A<p;A++){var c=A&&N.glyphs[H[A-1]]||{},a=N.glyphs[H[A]];G+=A?(c.w||N.w)+(c.k&&c.k[H[A]]||0)+N.w*J:0,a&&a.d&&I.push(this.path(a.d).attr({fill:"#000",stroke:"none",transform:[["t",G*E,0]]}))}I.transform(["...s",E,E,C,B,"t",(Q-C)/E,(P-B)/E])}return I},aL.add=function(a){if(a2.is(a,"array")){var k=this.set(),j=0,i=a.length,d;for(;j<i;j++){d=a[j]||{},aW[aR](d.type)&&k.push(this[d.type]().attr(d))}}return k},a2.format=function(a,f){var e=a2.is(f,cZ)?[0][aI](f):arguments;a&&a2.is(a,c1)&&e.length-1&&(a=a.replace(aU,function(d,c){return e[++c]==null?aD:e[c]}));return a||aD},a2.fullfill=function(){var e=/\{([^\}]+)\}/g,d=/(?:(?:^|\.)(.+?)(?=\[|\.|$|\()|\[('|")(.+?)\2\])(\(\))?/g,f=function(h,k,j){var i=j;k.replace(d,function(n,l,q,p,o){l=l||p,i&&(l in i&&(i=i[l]),typeof i=="function"&&o&&(i=i()))}),i=(i==null||i==j?h:i)+"";return i};return function(a,c){return String(a).replace(e,function(i,h){return f(i,h,c)})}}(),a2.ninja=function(){aN.was?aP.win.Raphael=aN.is:delete Raphael;return a2},a2.st=ab,function(a,i,h){function f(){/in/.test(a.readyState)?setTimeout(f,9):a2.eve("DOMload")}a.readyState==null&&a.addEventListener&&(a.addEventListener(i,h=function(){a.removeEventListener(i,h,!1),a.readyState="complete"},!1),a.readyState="loading"),f()}(document,"DOMContentLoaded"),aN.was?aP.win.Raphael=a2:Raphael=a2,eve.on("DOMload",function(){a0=!0})}(),window.Raphael.svg&&function(ag){var af="hasOwnProperty",ae=String,ad=parseFloat,ac=parseInt,ab=Math,aa=ab.max,Z=ab.abs,Y=ab.pow,X=/[, ]+/,W=ag.eve,V="",U=" ",T="http://www.w3.org/1999/xlink",S={block:"M5,0 0,2.5 5,5z",classic:"M5,0 0,2.5 5,5 3.5,3 3.5,2z",diamond:"M2.5,0 5,2.5 2.5,5 0,2.5z",open:"M6,1 1,3.5 6,6",oval:"M2.5,0A2.5,2.5,0,0,1,2.5,5 2.5,2.5,0,0,1,2.5,0z"},R={};ag.toString=function(){return"Your browser supports SVG.\nYou are running Raphaël "+this.version};var P=function(h,c){if(c){typeof h=="string"&&(h=P(h));for(var a in c){c[af](a)&&(a.substring(0,6)=="xlink:"?h.setAttributeNS(T,a.substring(6),ae(c[a])):h.setAttribute(a,ae(c[a])))}}else{h=ag._g.doc.createElementNS("http://www.w3.org/2000/svg",h),h.style&&(h.style.webkitTapHighlightColor="rgba(0,0,0,0)")}return h},N=function(A,q){var l="linear",i=A.id+q,h=0.5,f=0.5,d=A.node,c=A.paper,a=d.style,ak=ag._g.doc.getElementById(i);if(!ak){q=ae(q).replace(ag._radial_gradient,function(k,j,o){l="radial";if(j&&o){h=ad(j),f=ad(o);var n=(f>0.5)*2-1;Y(h-0.5,2)+Y(f-0.5,2)>0.25&&(f=ab.sqrt(0.25-Y(h-0.5,2))*n+0.5)&&f!=0.5&&(f=f.toFixed(5)-0.00001*n)}return V}),q=q.split(/\s*\-\s*/);if(l=="linear"){var aj=q.shift();aj=-ad(aj);if(isNaN(aj)){return null}var ai=[0,0,ab.cos(ag.rad(aj)),ab.sin(ag.rad(aj))],ah=1/(aa(Z(ai[2]),Z(ai[3]))||1);ai[2]*=ah,ai[3]*=ah,ai[2]<0&&(ai[0]=-ai[2],ai[2]=0),ai[3]<0&&(ai[1]=-ai[3],ai[3]=0)}var C=ag._parseDots(q);if(!C){return null}i=i.replace(/[\(\)\s,\xb0#]/g,"_"),A.gradient&&i!=A.gradient.id&&(c.defs.removeChild(A.gradient),delete A.gradient);if(!A.gradient){ak=P(l+"Gradient",{id:i}),A.gradient=ak,P(ak,l=="radial"?{fx:h,fy:f}:{x1:ai[0],y1:ai[1],x2:ai[2],y2:ai[3],gradientTransform:A.matrix.invert()}),c.defs.appendChild(ak);for(var B=0,z=C.length;B<z;B++){ak.appendChild(P("stop",{offset:C[B].offset?C[B].offset:B?"100%":"0%","stop-color":C[B].color||"#fff"}))}}}P(d,{fill:"url(#"+i+")",opacity:1,"fill-opacity":1}),a.fill=V,a.opacity=1,a.fillOpacity=1;return 1},L=function(d){var c=d.getBBox(1);P(d.pattern,{patternTransform:d.matrix.invert()+" translate("+c.x+","+c.y+")"})},J=function(aB,aA,az){if(aB.type=="path"){var ay=ae(aA).toLowerCase().split("-"),ax=aB.paper,aw=az?"end":"start",av=aB.node,au=aB.attrs,at=au["stroke-width"],ar=ay.length,ao="classic",am,ak,ai,q,p,o=3,c=3,a=5;while(ar--){switch(ay[ar]){case"block":case"classic":case"oval":case"diamond":case"open":case"none":ao=ay[ar];break;case"wide":c=5;break;case"narrow":c=2;break;case"long":o=5;break;case"short":o=2}}ao=="open"?(o+=2,c+=2,a+=2,ai=1,q=az?4:1,p={fill:"none",stroke:au.stroke}):(q=ai=o/2,p={fill:au.stroke,stroke:"none"}),aB._.arrows?az?(aB._.arrows.endPath&&R[aB._.arrows.endPath]--,aB._.arrows.endMarker&&R[aB._.arrows.endMarker]--):(aB._.arrows.startPath&&R[aB._.arrows.startPath]--,aB._.arrows.startMarker&&R[aB._.arrows.startMarker]--):aB._.arrows={};if(ao!="none"){var aq="raphael-marker-"+ao,ap="raphael-marker-"+aw+ao+o+c;ag._g.doc.getElementById(aq)?R[aq]++:(ax.defs.appendChild(P(P("path"),{"stroke-linecap":"round",d:S[ao],id:aq})),R[aq]=1);var an=ag._g.doc.getElementById(ap),al;an?(R[ap]++,al=an.getElementsByTagName("use")[0]):(an=P(P("marker"),{id:ap,markerHeight:c,markerWidth:o,orient:"auto",refX:q,refY:c/2}),al=P(P("use"),{"xlink:href":"#"+aq,transform:(az?" rotate(180 "+o/2+" "+c/2+") ":U)+"scale("+o/a+","+c/a+")","stroke-width":1/((o/a+c/a)/2)}),an.appendChild(al),ax.defs.appendChild(an),R[ap]=1),P(al,p);var aj=ai*(ao!="diamond"&&ao!="oval");az?(am=aB._.arrows.startdx*at||0,ak=ag.getTotalLength(au.path)-aj*at):(am=aj*at,ak=ag.getTotalLength(au.path)-(aB._.arrows.enddx*at||0)),p={},p["marker-"+aw]="url(#"+ap+")";if(ak||am){p.d=Raphael.getSubpath(au.path,am,ak)}P(av,p),aB._.arrows[aw+"Path"]=aq,aB._.arrows[aw+"Marker"]=ap,aB._.arrows[aw+"dx"]=aj,aB._.arrows[aw+"Type"]=ao,aB._.arrows[aw+"String"]=aA}else{az?(am=aB._.arrows.startdx*at||0,ak=ag.getTotalLength(au.path)-am):(am=0,ak=ag.getTotalLength(au.path)-(aB._.arrows.enddx*at||0)),aB._.arrows[aw+"Path"]&&P(av,{d:Raphael.getSubpath(au.path,am,ak)}),delete aB._.arrows[aw+"Path"],delete aB._.arrows[aw+"Marker"],delete aB._.arrows[aw+"dx"],delete aB._.arrows[aw+"Type"],delete aB._.arrows[aw+"String"]}for(p in R){if(R[af](p)&&!R[p]){var ah=ag._g.doc.getElementById(p);ah&&ah.parentNode.removeChild(ah)}}}},I={"":[0],none:[0],"-":[3,1],".":[1,1],"-.":[3,1,1,1],"-..":[3,1,1,1,1,1],". ":[1,3],"- ":[4,3],"--":[8,3],"- .":[4,3,1,3],"--.":[8,3,1,3],"--..":[8,3,1,3,1,3]},H=function(i,c,o){c=I[ae(c).toLowerCase()];if(c){var n=i.attrs["stroke-width"]||"1",l={round:n,square:n,butt:0}[i.attrs["stroke-linecap"]||o["stroke-linecap"]]||0,k=[],j=c.length;while(j--){k[j]=c[j]*n+(j%2?1:-1)*l}P(i.node,{"stroke-dasharray":k.join(",")})}},G=function(aq,ap){var ao=aq.node,an=aq.attrs,am=ao.style.visibility;ao.style.visibility="hidden";for(var al in ap){if(ap[af](al)){if(!ag._availableAttrs[af](al)){continue}var ak=ap[al];an[al]=ak;switch(al){case"blur":aq.blur(ak);break;case"href":case"title":case"target":var t=ao.parentNode;if(t.tagName.toLowerCase()!="a"){var l=P("a");t.insertBefore(l,ao),l.appendChild(ao),t=l}al=="target"&&ak=="blank"?t.setAttributeNS(T,"show","new"):t.setAttributeNS(T,al,ak);break;case"cursor":ao.style.cursor=ak;break;case"transform":aq.transform(ak);break;case"arrow-start":J(aq,ak);break;case"arrow-end":J(aq,ak,1);break;case"clip-rect":var h=ae(ak).split(X);if(h.length==4){aq.clip&&aq.clip.parentNode.parentNode.removeChild(aq.clip.parentNode);var a=P("clipPath"),aj=P("rect");a.id=ag.createUUID(),P(aj,{x:h[0],y:h[1],width:h[2],height:h[3]}),a.appendChild(aj),aq.paper.defs.appendChild(a),P(ao,{"clip-path":"url(#"+a.id+")"}),aq.clip=aj}if(!ak){var ai=ao.getAttribute("clip-path");if(ai){var ah=ag._g.doc.getElementById(ai.replace(/(^url\(#|\)$)/g,V));ah&&ah.parentNode.removeChild(ah),P(ao,{"clip-path":V}),delete aq.clip}}break;case"path":aq.type=="path"&&(P(ao,{d:ak?an.path=ag._pathToAbsolute(ak):"M0,0"}),aq._.dirty=1,aq._.arrows&&("startString" in aq._.arrows&&J(aq,aq._.arrows.startString),"endString" in aq._.arrows&&J(aq,aq._.arrows.endString,1)));break;case"width":ao.setAttribute(al,ak),aq._.dirty=1;if(an.fx){al="x",ak=an.x}else{break}case"x":an.fx&&(ak=-an.x-(an.width||0));case"rx":if(al=="rx"&&aq.type=="rect"){break}case"cx":ao.setAttribute(al,ak),aq.pattern&&L(aq),aq._.dirty=1;break;case"height":ao.setAttribute(al,ak),aq._.dirty=1;if(an.fy){al="y",ak=an.y}else{break}case"y":an.fy&&(ak=-an.y-(an.height||0));case"ry":if(al=="ry"&&aq.type=="rect"){break}case"cy":ao.setAttribute(al,ak),aq.pattern&&L(aq),aq._.dirty=1;break;case"r":aq.type=="rect"?P(ao,{rx:ak,ry:ak}):ao.setAttribute(al,ak),aq._.dirty=1;break;case"src":aq.type=="image"&&ao.setAttributeNS(T,"href",ak);break;case"stroke-width":if(aq._.sx!=1||aq._.sy!=1){ak/=aa(Z(aq._.sx),Z(aq._.sy))||1}aq.paper._vbSize&&(ak*=aq.paper._vbSize),ao.setAttribute(al,ak),an["stroke-dasharray"]&&H(aq,an["stroke-dasharray"],ap),aq._.arrows&&("startString" in aq._.arrows&&J(aq,aq._.arrows.startString),"endString" in aq._.arrows&&J(aq,aq._.arrows.endString,1));break;case"stroke-dasharray":H(aq,ak,ap);break;case"fill":var v=ae(ak).match(ag._ISURL);if(v){a=P("pattern");var q=P("image");a.id=ag.createUUID(),P(a,{x:0,y:0,patternUnits:"userSpaceOnUse",height:1,width:1}),P(q,{x:0,y:0,"xlink:href":v[1]}),a.appendChild(q),function(d){ag._preload(v[1],function(){var f=this.offsetWidth,i=this.offsetHeight;P(d,{width:f,height:i}),P(q,{width:f,height:i}),aq.paper.safari()})}(a),aq.paper.defs.appendChild(a),ao.style.fill="url(#"+a.id+")",P(ao,{fill:"url(#"+a.id+")"}),aq.pattern=a,aq.pattern&&L(aq);break}var n=ag.getRGB(ak);if(!n.error){delete ap.gradient,delete an.gradient,!ag.is(an.opacity,"undefined")&&ag.is(ap.opacity,"undefined")&&P(ao,{opacity:an.opacity}),!ag.is(an["fill-opacity"],"undefined")&&ag.is(ap["fill-opacity"],"undefined")&&P(ao,{"fill-opacity":an["fill-opacity"]})}else{if((aq.type=="circle"||aq.type=="ellipse"||ae(ak).charAt()!="r")&&N(aq,ak)){if("opacity" in an||"fill-opacity" in an){var j=ag._g.doc.getElementById(ao.getAttribute("fill").replace(/^url\(#|\)$/g,V));if(j){var e=j.getElementsByTagName("stop");P(e[e.length-1],{"stop-opacity":("opacity" in an?an.opacity:1)*("fill-opacity" in an?an["fill-opacity"]:1)})}}an.gradient=ak,an.fill="none";break}}n[af]("opacity")&&P(ao,{"fill-opacity":n.opacity>1?n.opacity/100:n.opacity});case"stroke":n=ag.getRGB(ak),ao.setAttribute(al,n.hex),al=="stroke"&&n[af]("opacity")&&P(ao,{"stroke-opacity":n.opacity>1?n.opacity/100:n.opacity}),al=="stroke"&&aq._.arrows&&("startString" in aq._.arrows&&J(aq,aq._.arrows.startString),"endString" in aq._.arrows&&J(aq,aq._.arrows.endString,1));break;case"gradient":(aq.type=="circle"||aq.type=="ellipse"||ae(ak).charAt()!="r")&&N(aq,ak);break;case"opacity":an.gradient&&!an[af]("stroke-opacity")&&P(ao,{"stroke-opacity":ak>1?ak/100:ak});case"fill-opacity":if(an.gradient){j=ag._g.doc.getElementById(ao.getAttribute("fill").replace(/^url\(#|\)$/g,V)),j&&(e=j.getElementsByTagName("stop"),P(e[e.length-1],{"stop-opacity":ak}));break}default:al=="font-size"&&(ak=ac(ak,10)+"px");var c=al.replace(/(\-.)/g,function(d){return d.substring(1).toUpperCase()});ao.style[c]=ak,aq._.dirty=1,ao.setAttribute(al,ak)}}}E(aq,ap),ao.style.visibility=am},F=1.2,E=function(B,A){if(B.type=="text"&&!!(A[af]("text")||A[af]("font")||A[af]("font-size")||A[af]("x")||A[af]("y"))){var z=B.attrs,w=B.node,v=w.firstChild?ac(ag._g.doc.defaultView.getComputedStyle(w.firstChild,V).getPropertyValue("font-size"),10):10;if(A[af]("text")){z.text=A.text;while(w.firstChild){w.removeChild(w.firstChild)}var u=ae(A.text).split("\n"),t=[],q;for(var l=0,e=u.length;l<e;l++){q=P("tspan"),l&&P(q,{dy:v*F,x:z.x}),q.appendChild(ag._g.doc.createTextNode(u[l])),w.appendChild(q),t[l]=q}}else{t=w.getElementsByTagName("tspan");for(l=0,e=t.length;l<e;l++){l?P(t[l],{dy:v*F,x:z.x}):P(t[0],{dy:0})}}P(w,{x:z.x,y:z.y}),B._.dirty=1;var c=B._getBBox(),a=z.y-(c.y+c.height/2);a&&ag.is(a,"finite")&&P(t[0],{dy:a})}},D=function(a,i){var h=0,f=0;this[0]=this.node=a,a.raphael=!0,this.id=ag._oid++,a.raphaelid=this.id,this.matrix=ag.matrix(),this.realPath=null,this.paper=i,this.attrs=this.attrs||{},this._={transform:[],sx:1,sy:1,deg:0,dx:0,dy:0,dirty:1},!i.bottom&&(i.bottom=this),this.prev=i.top,i.top&&(i.top.next=this),i.top=this,this.next=null},Q=ag.el;D.prototype=Q,Q.constructor=D,ag._engine.path=function(f,e){var i=P("path");e.canvas&&e.canvas.appendChild(i);var h=new D(i,e);h.type="path",G(h,{fill:"none",stroke:"#000",path:f});return h},Q.rotate=function(d,c,i){if(this.removed){return this}d=ae(d).split(X),d.length-1&&(c=ad(d[1]),i=ad(d[2])),d=ad(d[0]),i==null&&(c=i);if(c==null||i==null){var h=this.getBBox(1);c=h.x+h.width/2,i=h.y+h.height/2}this.transform(this._.transform.concat([["r",d,c,i]]));return this},Q.scale=function(d,c,j,i){if(this.removed){return this}d=ae(d).split(X),d.length-1&&(c=ad(d[1]),j=ad(d[2]),i=ad(d[3])),d=ad(d[0]),c==null&&(c=d),i==null&&(j=i);if(j==null||i==null){var h=this.getBBox(1)}j=j==null?h.x+h.width/2:j,i=i==null?h.y+h.height/2:i,this.transform(this._.transform.concat([["s",d,c,j,i]]));return this},Q.translate=function(d,c){if(this.removed){return this}d=ae(d).split(X),d.length-1&&(c=ad(d[1])),d=ad(d[0])||0,c=+c||0,this.transform(this._.transform.concat([["t",d,c]]));return this},Q.transform=function(h){var f=this._;if(h==null){return f.transform}ag._extractTransform(this,h),this.clip&&P(this.clip,{transform:this.matrix.invert()}),this.pattern&&L(this),this.node&&P(this.node,{transform:this.matrix});if(f.sx!=1||f.sy!=1){var a=this.attrs[af]("stroke-width")?this.attrs["stroke-width"]:1;this.attr({"stroke-width":a})}return this},Q.hide=function(){!this.removed&&this.paper.safari(this.node.style.display="none");return this},Q.show=function(){!this.removed&&this.paper.safari(this.node.style.display="");return this},Q.remove=function(){if(!this.removed){var a=this.paper;a.__set__&&a.__set__.exclude(this),W.unbind("*.*."+this.id),this.gradient&&a.defs.removeChild(this.gradient),ag._tear(this,a),this.node.parentNode.removeChild(this.node);for(var d in this){this[d]=typeof this[d]=="function"?ag._removedFactory(d):null}this.removed=!0}},Q._getBBox=function(){if(this.node.style.display=="none"){this.show();var e=!0}var d={};try{d=this.node.getBBox()}catch(f){}finally{d=d||{}}e&&this.hide();return d},Q.attr=function(C,B){if(this.removed){return this}if(C==null){var A={};for(var z in this.attrs){this.attrs[af](z)&&(A[z]=this.attrs[z])}A.gradient&&A.fill=="none"&&(A.fill=A.gradient)&&delete A.gradient,A.transform=this._.transform;return A}if(B==null&&ag.is(C,"string")){if(C=="fill"&&this.attrs.fill=="none"&&this.attrs.gradient){return this.attrs.gradient}if(C=="transform"){return this._.transform}var w=C.split(X),v={};for(var u=0,t=w.length;u<t;u++){C=w[u],C in this.attrs?v[C]=this.attrs[C]:ag.is(this.paper.customAttributes[C],"function")?v[C]=this.paper.customAttributes[C].def:v[C]=ag._availableAttrs[C]}return t-1?v:v[w[0]]}if(B==null&&ag.is(C,"array")){v={};for(u=0,t=C.length;u<t;u++){v[C[u]]=this.attr(C[u])}return v}if(B!=null){var q={};q[C]=B}else{C!=null&&ag.is(C,"object")&&(q=C)}for(var k in q){W("attr."+k+"."+this.id,this,q[k])}for(k in this.paper.customAttributes){if(this.paper.customAttributes[af](k)&&q[af](k)&&ag.is(this.paper.customAttributes[k],"function")){var j=this.paper.customAttributes[k].apply(this,[].concat(q[k]));this.attrs[k]=q[k];for(var a in j){j[af](a)&&(q[a]=j[a])}}}G(this,q);return this},Q.toFront=function(){if(this.removed){return this}this.node.parentNode.tagName.toLowerCase()=="a"?this.node.parentNode.parentNode.appendChild(this.node.parentNode):this.node.parentNode.appendChild(this.node);var a=this.paper;a.top!=this&&ag._tofront(this,a);return this},Q.toBack=function(){if(this.removed){return this}var a=this.node.parentNode;a.tagName.toLowerCase()=="a"?a.parentNode.insertBefore(this.node.parentNode,this.node.parentNode.parentNode.firstChild):a.firstChild!=this.node&&a.insertBefore(this.node,this.node.parentNode.firstChild),ag._toback(this,this.paper);var d=this.paper;return this},Q.insertAfter=function(a){if(this.removed){return this}var d=a.node||a[a.length-1].node;d.nextSibling?d.parentNode.insertBefore(this.node,d.nextSibling):d.parentNode.appendChild(this.node),ag._insertafter(this,a,this.paper);return this},Q.insertBefore=function(a){if(this.removed){return this}var d=a.node||a[0].node;d.parentNode.insertBefore(this.node,d),ag._insertbefore(this,a,this.paper);return this},Q.blur=function(a){var i=this;if(+a!==0){var h=P("filter"),f=P("feGaussianBlur");i.attrs.blur=a,h.id=ag.createUUID(),P(f,{stdDeviation:+a||1.5}),h.appendChild(f),i.paper.defs.appendChild(h),i._blur=h,P(i.node,{filter:"url(#"+h.id+")"})}else{i._blur&&(i._blur.parentNode.removeChild(i._blur),delete i._blur,delete i.attrs.blur),i.node.removeAttribute("filter")}},ag._engine.circle=function(i,h,n,l){var k=P("circle");i.canvas&&i.canvas.appendChild(k);var j=new D(k,i);j.attrs={cx:h,cy:n,r:l,fill:"none",stroke:"#000"},j.type="circle",P(k,j.attrs);return j},ag._engine.rect=function(j,i,q,p,o,n){var l=P("rect");j.canvas&&j.canvas.appendChild(l);var k=new D(l,j);k.attrs={x:i,y:q,width:p,height:o,r:n||0,rx:n||0,ry:n||0,fill:"none",stroke:"#000"},k.type="rect",P(l,k.attrs);return k},ag._engine.ellipse=function(i,h,o,n,l){var k=P("ellipse");i.canvas&&i.canvas.appendChild(k);var j=new D(k,i);j.attrs={cx:h,cy:o,rx:n,ry:l,fill:"none",stroke:"#000"},j.type="ellipse",P(k,j.attrs);return j},ag._engine.image=function(j,i,q,p,o,n){var l=P("image");P(l,{x:q,y:p,width:o,height:n,preserveAspectRatio:"none"}),l.setAttributeNS(T,"href",i),j.canvas&&j.canvas.appendChild(l);var k=new D(l,j);k.attrs={x:q,y:p,width:o,height:n,src:i},k.type="image";return k},ag._engine.text=function(a,l,k,j){var i=P("text");a.canvas&&a.canvas.appendChild(i);var h=new D(i,a);h.attrs={x:l,y:k,"text-anchor":"middle",text:j,font:ag._availableAttrs.font,stroke:"none",fill:"#000"},h.type="text",G(h,h.attrs);return h},ag._engine.setSize=function(d,c){this.width=d||this.width,this.height=c||this.height,this.canvas.setAttribute("width",this.width),this.canvas.setAttribute("height",this.height),this._viewBox&&this.setViewBox.apply(this,this._viewBox);return this},ag._engine.create=function(){var u=ag._getContainer.apply(0,arguments),t=u&&u.container,q=u.x,p=u.y,o=u.width,n=u.height;if(!t){throw new Error("SVG container not found.")}var l=P("svg"),k="overflow:hidden;",a;q=q||0,p=p||0,o=o||512,n=n||342,P(l,{height:n,version:1.1,width:o,xmlns:"http://www.w3.org/2000/svg"}),t==1?(l.style.cssText=k+"position:absolute;left:"+q+"px;top:"+p+"px",ag._g.doc.body.appendChild(l),a=1):(l.style.cssText=k+"position:relative",t.firstChild?t.insertBefore(l,t.firstChild):t.appendChild(l)),t=new ag._Paper,t.width=o,t.height=n,t.canvas=l,t.clear(),t._left=t._top=0,a&&(t.renderfix=function(){}),t.renderfix();return t},ag._engine.setViewBox=function(z,w,v,u,t){W("setViewBox",this,this._viewBox,[z,w,v,u,t]);var q=aa(v/this.width,u/this.height),p=this.top,o=t?"meet":"xMinYMin",n,k;z==null?(this._vbSize&&(q=1),delete this._vbSize,n="0 0 "+this.width+U+this.height):(this._vbSize=q,n=z+U+w+U+v+U+u),P(this.canvas,{viewBox:n,preserveAspectRatio:o});while(q&&p){k="stroke-width" in p.attrs?p.attrs["stroke-width"]:1,p.attr({"stroke-width":k}),p._.dirty=1,p._.dirtyT=1,p=p.prev}this._viewBox=[z,w,v,u,!!t];return this},ag.prototype.renderfix=function(){var h=this.canvas,f=h.style,k=h.getScreenCTM()||h.createSVGMatrix(),j=-k.e%1,i=-k.f%1;if(j||i){j&&(this._left=(this._left+j)%1,f.left=this._left+"px"),i&&(this._top=(this._top+i)%1,f.top=this._top+"px")}},ag.prototype.clear=function(){ag.eve("clear",this);var a=this.canvas;while(a.firstChild){a.removeChild(a.firstChild)}this.bottom=this.top=null,(this.desc=P("desc")).appendChild(ag._g.doc.createTextNode("Created with Raphaël "+ag.version)),a.appendChild(this.desc),a.appendChild(this.defs=P("defs"))},ag.prototype.remove=function(){W("remove",this),this.canvas.parentNode&&this.canvas.parentNode.removeChild(this.canvas);for(var a in this){this[a]=typeof this[a]=="function"?ag._removedFactory(a):null}};var O=ag.st;for(var M in Q){Q[af](M)&&!O[af](M)&&(O[M]=function(c){return function(){var a=arguments;return this.forEach(function(d){d[c].apply(d,a)})}}(M))}}(window.Raphael),window.Raphael.vml&&function(aq){var ap="hasOwnProperty",ao=String,an=parseFloat,am=Math,al=am.round,ak=am.max,aj=am.min,ai=am.abs,ah="fill",ag=/[, ]+/,af=aq.eve,ae=" progid:DXImageTransform.Microsoft",ad=" ",ac="",ab={M:"m",L:"l",C:"c",Z:"x",m:"t",l:"r",c:"v",z:"x"},Z=/([clmz]),?([^clmz]*)/gi,X=/ progid:\S+Blur\([^\)]+\)/g,V=/-?[^,\s-]+/g,T="position:absolute;left:0;top:0;width:1px;height:1px",R=21600,P={path:1,rect:1,image:1},N={circle:1,ellipse:1},L=function(w){var v=/[ahqstv]/ig,u=aq._pathToAbsolute;ao(w).match(v)&&(u=aq._path2curve),v=/[clmz]/g;if(u==aq._pathToAbsolute&&!ao(w).match(v)){var t=ao(w).replace(Z,function(i,h,z){var l=[],k=h.toLowerCase()=="m",j=ab[h];z.replace(V,function(d){k&&l.length==2&&(j+=l+ab[h=="m"?"l":"L"],l=[]),l.push(al(d*R))});return j+l});return t}var q=u(w),p,o;t=[];for(var n=0,f=q.length;n<f;n++){p=q[n],o=q[n][0].toLowerCase(),o=="z"&&(o="x");for(var c=1,a=p.length;c<a;c++){o+=al(p[c]*R)+(c!=a-1?",":ac)}t.push(o)}return t.join(ad)},J=function(a,i,h){var f=aq.matrix();f.rotate(-a,0.5,0.5);return{dx:f.x(i,h),dy:f.y(i,h)}},I=function(av,au,at,ar,H,G){var F=av._,E=av.matrix,D=F.fillpos,C=av.node,B=C.style,A=1,z="",w,u=R/au,n=R/at;B.visibility="hidden";if(!!au&&!!at){C.coordsize=ai(u)+ad+ai(n),B.rotation=G*(au*at<0?-1:1);if(G){var j=J(G,ar,H);ar=j.dx,H=j.dy}au<0&&(z+="x"),at<0&&(z+=" y")&&(A=-1),B.flip=z,C.coordorigin=ar*-u+ad+H*-n;if(D||F.fillsize){var i=C.getElementsByTagName(ah);i=i&&i[0],C.removeChild(i),D&&(j=J(G,E.x(D[0],D[1]),E.y(D[0],D[1])),i.position=j.dx*A+ad+j.dy*A),F.fillsize&&(i.size=F.fillsize[0]*ai(au)+ad+F.fillsize[1]*ai(at)),C.appendChild(i)}B.visibility="visible"}};aq.toString=function(){return"Your browser doesn’t support SVG. Falling down to VML.\nYou are running Raphaël "+this.version};var aa=function(w,v,u){var t=ao(v).toLowerCase().split("-"),q=u?"end":"start",p=t.length,o="classic",n="medium",l="medium";while(p--){switch(t[p]){case"block":case"classic":case"oval":case"diamond":case"open":case"none":o=t[p];break;case"wide":case"narrow":l=t[p];break;case"long":case"short":n=t[p]}}var c=w.node.getElementsByTagName("stroke")[0];c[q+"arrow"]=o,c[q+"arrowlength"]=n,c[q+"arrowwidth"]=l},Y=function(aJ,aI){aJ.attrs=aJ.attrs||{};var aH=aJ.node,aG=aJ.attrs,aF=aH.style,aE,aC=P[aJ.type]&&(aI.x!=aG.x||aI.y!=aG.y||aI.width!=aG.width||aI.height!=aG.height||aI.cx!=aG.cx||aI.cy!=aG.cy||aI.rx!=aG.rx||aI.ry!=aG.ry||aI.r!=aG.r),aA=N[aJ.type]&&(aG.cx!=aI.cx||aG.cy!=aI.cy||aG.r!=aI.r||aG.rx!=aI.rx||aG.ry!=aI.ry),az=aJ;for(var au in aI){aI[ap](au)&&(aG[au]=aI[au])}aC&&(aG.path=aq._getPath[aJ.type](aJ),aJ._.dirty=1),aI.href&&(aH.href=aI.href),aI.title&&(aH.title=aI.title),aI.target&&(aH.target=aI.target),aI.cursor&&(aF.cursor=aI.cursor),"blur" in aI&&aJ.blur(aI.blur);if(aI.path&&aJ.type=="path"||aC){aH.path=L(~ao(aG.path).toLowerCase().indexOf("r")?aq._pathToAbsolute(aG.path):aG.path),aJ.type=="image"&&(aJ._.fillpos=[aG.x,aG.y],aJ._.fillsize=[aG.width,aG.height],I(aJ,1,1,0,0,0))}"transform" in aI&&aJ.transform(aI.transform);if(aA){var aD=+aG.cx,aB=+aG.cy,ay=+aG.rx||+aG.r||0,ax=+aG.ry||+aG.r||0;aH.path=aq.format("ar{0},{1},{2},{3},{4},{1},{4},{1}x",al((aD-ay)*R),al((aB-ax)*R),al((aD+ay)*R),al((aB+ax)*R),al(aD*R))}if("clip-rect" in aI){var aw=ao(aI["clip-rect"]).split(ag);if(aw.length==4){aw[2]=+aw[2]+ +aw[0],aw[3]=+aw[3]+ +aw[1];var av=aH.clipRect||aq._g.doc.createElement("div"),at=av.style;at.clip=aq.format("rect({1}px {2}px {3}px {0}px)",aw),aH.clipRect||(at.position="absolute",at.top=0,at.left=0,at.width=aJ.paper.width+"px",at.height=aJ.paper.height+"px",aH.parentNode.insertBefore(av,aH),av.appendChild(aH),aH.clipRect=av)}aI["clip-rect"]||aH.clipRect&&(aH.clipRect.style.clip="auto")}if(aJ.textpath){var ar=aJ.textpath.style;aI.font&&(ar.font=aI.font),aI["font-family"]&&(ar.fontFamily='"'+aI["font-family"].split(",")[0].replace(/^['"]+|['"]+$/g,ac)+'"'),aI["font-size"]&&(ar.fontSize=aI["font-size"]),aI["font-weight"]&&(ar.fontWeight=aI["font-weight"]),aI["font-style"]&&(ar.fontStyle=aI["font-style"])}"arrow-start" in aI&&aa(az,aI["arrow-start"]),"arrow-end" in aI&&aa(az,aI["arrow-end"],1);if(aI.opacity!=null||aI["stroke-width"]!=null||aI.fill!=null||aI.src!=null||aI.stroke!=null||aI["stroke-width"]!=null||aI["stroke-opacity"]!=null||aI["fill-opacity"]!=null||aI["stroke-dasharray"]!=null||aI["stroke-miterlimit"]!=null||aI["stroke-linejoin"]!=null||aI["stroke-linecap"]!=null){var F=aH.getElementsByTagName(ah),C=!1;F=F&&F[0],!F&&(C=F=Q(ah)),aJ.type=="image"&&aI.src&&(F.src=aI.src),aI.fill&&(F.on=!0);if(F.on==null||aI.fill=="none"||aI.fill===null){F.on=!1}if(F.on&&aI.fill){var A=ao(aI.fill).match(aq._ISURL);if(A){F.parentNode==aH&&aH.removeChild(F),F.rotate=!0,F.src=A[1],F.type="tile";var z=aJ.getBBox(1);F.position=z.x+ad+z.y,aJ._.fillpos=[z.x,z.y],aq._preload(A[1],function(){aJ._.fillsize=[this.offsetWidth,this.offsetHeight]})}else{F.color=aq.getRGB(aI.fill).hex,F.src=ac,F.type="solid",aq.getRGB(aI.fill).error&&(az.type in {circle:1,ellipse:1}||ao(aI.fill).charAt()!="r")&&W(az,aI.fill,F)&&(aG.fill="none",aG.gradient=aI.fill,F.rotate=!1)}}if("fill-opacity" in aI||"opacity" in aI){var w=((+aG["fill-opacity"]+1||2)-1)*((+aG.opacity+1||2)-1)*((+aq.getRGB(aI.fill).o+1||2)-1);w=aj(ak(w,0),1),F.opacity=w,F.src&&(F.color="none")}aH.appendChild(F);var u=aH.getElementsByTagName("stroke")&&aH.getElementsByTagName("stroke")[0],k=!1;!u&&(k=u=Q("stroke"));if(aI.stroke&&aI.stroke!="none"||aI["stroke-width"]||aI["stroke-opacity"]!=null||aI["stroke-dasharray"]||aI["stroke-miterlimit"]||aI["stroke-linejoin"]||aI["stroke-linecap"]){u.on=!0}(aI.stroke=="none"||aI.stroke===null||u.on==null||aI.stroke==0||aI["stroke-width"]==0)&&(u.on=!1);var j=aq.getRGB(aI.stroke);u.on&&aI.stroke&&(u.color=j.hex),w=((+aG["stroke-opacity"]+1||2)-1)*((+aG.opacity+1||2)-1)*((+j.o+1||2)-1);var h=(an(aI["stroke-width"])||1)*0.75;w=aj(ak(w,0),1),aI["stroke-width"]==null&&(h=aG["stroke-width"]),aI["stroke-width"]&&(u.weight=h),h&&h<1&&(w*=h)&&(u.weight=1),u.opacity=w,aI["stroke-linejoin"]&&(u.joinstyle=aI["stroke-linejoin"]||"miter"),u.miterlimit=aI["stroke-miterlimit"]||8,aI["stroke-linecap"]&&(u.endcap=aI["stroke-linecap"]=="butt"?"flat":aI["stroke-linecap"]=="square"?"square":"round");if(aI["stroke-dasharray"]){var f={"-":"shortdash",".":"shortdot","-.":"shortdashdot","-..":"shortdashdotdot",". ":"dot","- ":"dash","--":"longdash","- .":"dashdot","--.":"longdashdot","--..":"longdashdotdot"};u.dashstyle=f[ap](aI["stroke-dasharray"])?f[aI["stroke-dasharray"]]:ac}k&&aH.appendChild(u)}if(az.type=="text"){az.paper.canvas.style.display=ac;var d=az.paper.span,c=100,a=aG.font&&aG.font.match(/\d+(?:\.\d*)?(?=px)/);aF=d.style,aG.font&&(aF.font=aG.font),aG["font-family"]&&(aF.fontFamily=aG["font-family"]),aG["font-weight"]&&(aF.fontWeight=aG["font-weight"]),aG["font-style"]&&(aF.fontStyle=aG["font-style"]),a=an(aG["font-size"]||a&&a[0])||10,aF.fontSize=a*c+"px",az.textpath.string&&(d.innerHTML=ao(az.textpath.string).replace(/</g,"&#60;").replace(/&/g,"&#38;").replace(/\n/g,"<br>"));var n=d.getBoundingClientRect();az.W=aG.w=(n.right-n.left)/c,az.H=aG.h=(n.bottom-n.top)/c,az.X=aG.x,az.Y=aG.y+az.H/2,("x" in aI||"y" in aI)&&(az.path.v=aq.format("m{0},{1}l{2},{1}",al(aG.x*R),al(aG.y*R),al(aG.x*R)+1));var aK=["x","y","text","font","font-family","font-weight","font-style","font-size"];for(var v=0,o=aK.length;v<o;v++){if(aK[v] in aI){az._.dirty=1;break}}switch(aG["text-anchor"]){case"start":az.textpath.style["v-text-align"]="left",az.bbx=az.W/2;break;case"end":az.textpath.style["v-text-align"]="right",az.bbx=-az.W/2;break;default:az.textpath.style["v-text-align"]="center",az.bbx=0}az.textpath.style["v-text-kern"]=!0}},W=function(B,A,z){B.attrs=B.attrs||{};var w=B.attrs,v=Math.pow,u,o,n="linear",e=".5 .5";B.attrs.gradient=A,A=ao(A).replace(aq._radial_gradient,function(h,f,i){n="radial",f&&i&&(f=an(f),i=an(i),v(f-0.5,2)+v(i-0.5,2)>0.25&&(i=am.sqrt(0.25-v(f-0.5,2))*((i>0.5)*2-1)+0.5),e=f+ad+i);return ac}),A=A.split(/\s*\-\s*/);if(n=="linear"){var d=A.shift();d=-an(d);if(isNaN(d)){return null}}var c=aq._parseDots(A);if(!c){return null}B=B.shape||B.node;if(c.length){B.removeChild(z),z.on=!0,z.method="none",z.color=c[0].color,z.color2=c[c.length-1].color;var a=[];for(var D=0,C=c.length;D<C;D++){c[D].offset&&a.push(c[D].offset+ad+c[D].color)}z.colors=a.length?a.join():"0% "+z.color,n=="radial"?(z.type="gradientTitle",z.focus="100%",z.focussize="0 0",z.focusposition=e,z.angle=0):(z.type="gradient",z.angle=(270-d)%360),B.appendChild(z)}return 1},U=function(a,d){this[0]=this.node=a,a.raphael=!0,this.id=aq._oid++,a.raphaelid=this.id,this.X=0,this.Y=0,this.attrs={},this.paper=d,this.matrix=aq.matrix(),this._={transform:[],sx:1,sy:1,dx:0,dy:0,deg:0,dirty:1,dirtyT:1},!d.bottom&&(d.bottom=this),this.prev=d.top,d.top&&(d.top.next=this),d.top=this,this.next=null},S=aq.el;U.prototype=S,S.constructor=U,S.transform=function(E){if(E==null){return this._.transform}var D=this.paper._viewBoxShift,C=D?"s"+[D.scale,D.scale]+"-1-1t"+[D.dx,D.dy]:ac,B;D&&(B=E=ao(E).replace(/\.{3}|\u2026/g,this._.transform||ac)),aq._extractTransform(this,C+E);var A=this.matrix.clone(),z=this.skew,w=this.node,v,u=~ao(this.attrs.fill).indexOf("-"),t=!ao(this.attrs.fill).indexOf("url(");A.translate(-0.5,-0.5);if(t||u||this.type=="image"){z.matrix="1 0 0 1",z.offset="0 0",v=A.split();if(u&&v.noRotation||!v.isSimple){w.style.filter=A.toFilter();var o=this.getBBox(),n=this.getBBox(1),c=o.x-n.x,a=o.y-n.y;w.coordorigin=c*-R+ad+a*-R,I(this,1,1,c,a,0)}else{w.style.filter=ac,I(this,v.scalex,v.scaley,v.dx,v.dy,v.rotate)}}else{w.style.filter=ac,z.matrix=ao(A),z.offset=A.offset()}B&&(this._.transform=B);return this},S.rotate=function(d,c,i){if(this.removed){return this}if(d!=null){d=ao(d).split(ag),d.length-1&&(c=an(d[1]),i=an(d[2])),d=an(d[0]),i==null&&(c=i);if(c==null||i==null){var h=this.getBBox(1);c=h.x+h.width/2,i=h.y+h.height/2}this._.dirtyT=1,this.transform(this._.transform.concat([["r",d,c,i]]));return this}},S.translate=function(d,c){if(this.removed){return this}d=ao(d).split(ag),d.length-1&&(c=an(d[1])),d=an(d[0])||0,c=+c||0,this._.bbox&&(this._.bbox.x+=d,this._.bbox.y+=c),this.transform(this._.transform.concat([["t",d,c]]));return this},S.scale=function(d,c,j,i){if(this.removed){return this}d=ao(d).split(ag),d.length-1&&(c=an(d[1]),j=an(d[2]),i=an(d[3]),isNaN(j)&&(j=null),isNaN(i)&&(i=null)),d=an(d[0]),c==null&&(c=d),i==null&&(j=i);if(j==null||i==null){var h=this.getBBox(1)}j=j==null?h.x+h.width/2:j,i=i==null?h.y+h.height/2:i,this.transform(this._.transform.concat([["s",d,c,j,i]])),this._.dirtyT=1;return this},S.hide=function(){!this.removed&&(this.node.style.display="none");return this},S.show=function(){!this.removed&&(this.node.style.display=ac);return this},S._getBBox=function(){if(this.removed){return{}}return{x:this.X+(this.bbx||0)-this.W/2,y:this.Y-this.H,width:this.W,height:this.H}},S.remove=function(){if(!this.removed){this.paper.__set__&&this.paper.__set__.exclude(this),aq.eve.unbind("*.*."+this.id),aq._tear(this,this.paper),this.node.parentNode.removeChild(this.node),this.shape&&this.shape.parentNode.removeChild(this.shape);for(var a in this){this[a]=typeof this[a]=="function"?aq._removedFactory(a):null}this.removed=!0}},S.attr=function(C,B){if(this.removed){return this}if(C==null){var A={};for(var z in this.attrs){this.attrs[ap](z)&&(A[z]=this.attrs[z])}A.gradient&&A.fill=="none"&&(A.fill=A.gradient)&&delete A.gradient,A.transform=this._.transform;return A}if(B==null&&aq.is(C,"string")){if(C==ah&&this.attrs.fill=="none"&&this.attrs.gradient){return this.attrs.gradient}var w=C.split(ag),v={};for(var u=0,t=w.length;u<t;u++){C=w[u],C in this.attrs?v[C]=this.attrs[C]:aq.is(this.paper.customAttributes[C],"function")?v[C]=this.paper.customAttributes[C].def:v[C]=aq._availableAttrs[C]}return t-1?v:v[w[0]]}if(this.attrs&&B==null&&aq.is(C,"array")){v={};for(u=0,t=C.length;u<t;u++){v[C[u]]=this.attr(C[u])}return v}var l;B!=null&&(l={},l[C]=B),B==null&&aq.is(C,"object")&&(l=C);for(var k in l){af("attr."+k+"."+this.id,this,l[k])}if(l){for(k in this.paper.customAttributes){if(this.paper.customAttributes[ap](k)&&l[ap](k)&&aq.is(this.paper.customAttributes[k],"function")){var j=this.paper.customAttributes[k].apply(this,[].concat(l[k]));this.attrs[k]=l[k];for(var a in j){j[ap](a)&&(l[a]=j[a])}}}l.text&&this.type=="text"&&(this.textpath.string=l.text),Y(this,l)}return this},S.toFront=function(){!this.removed&&this.node.parentNode.appendChild(this.node),this.paper&&this.paper.top!=this&&aq._tofront(this,this.paper);return this},S.toBack=function(){if(this.removed){return this}this.node.parentNode.firstChild!=this.node&&(this.node.parentNode.insertBefore(this.node,this.node.parentNode.firstChild),aq._toback(this,this.paper));return this},S.insertAfter=function(a){if(this.removed){return this}a.constructor==aq.st.constructor&&(a=a[a.length-1]),a.node.nextSibling?a.node.parentNode.insertBefore(this.node,a.node.nextSibling):a.node.parentNode.appendChild(this.node),aq._insertafter(this,a,this.paper);return this},S.insertBefore=function(a){if(this.removed){return this}a.constructor==aq.st.constructor&&(a=a[0]),a.node.parentNode.insertBefore(this.node,a.node),aq._insertbefore(this,a,this.paper);return this},S.blur=function(a){var f=this.node.runtimeStyle,e=f.filter;e=e.replace(X,ac),+a!==0?(this.attrs.blur=a,f.filter=e+ad+ae+".Blur(pixelradius="+(+a||1.5)+")",f.margin=aq.format("-{0}px 0 0 -{0}px",al(+a||1.5))):(f.filter=e,f.margin=0,delete this.attrs.blur)},aq._engine.path=function(i,h){var n=Q("shape");n.style.cssText=T,n.coordsize=R+ad+R,n.coordorigin=h.coordorigin;var l=new U(n,h),k={fill:"none",stroke:"#000"};i&&(k.path=i),l.type="path",l.path=[],l.Path=ac,Y(l,k),h.canvas.appendChild(n);var j=Q("skew");j.on=!0,n.appendChild(j),l.skew=j,l.transform(ac);return l},aq._engine.rect=function(u,t,q,p,o,n){var l=aq._rectPath(t,q,p,o,n),k=u.path(l),a=k.attrs;k.X=a.x=t,k.Y=a.y=q,k.W=a.width=p,k.H=a.height=o,a.r=n,a.path=l,k.type="rect";return k},aq._engine.ellipse=function(i,h,o,n,l){var k=i.path(),j=k.attrs;k.X=h-n,k.Y=o-l,k.W=n*2,k.H=l*2,k.type="ellipse",Y(k,{cx:h,cy:o,rx:n,ry:l});return k},aq._engine.circle=function(i,h,n,l){var k=i.path(),j=k.attrs;k.X=h-l,k.Y=n-l,k.W=k.H=l*2,k.type="circle",Y(k,{cx:h,cy:n,r:l});return k},aq._engine.image=function(z,w,v,u,t,q){var p=aq._rectPath(v,u,t,q),o=z.path(p).attr({stroke:"none"}),n=o.attrs,j=o.node,a=j.getElementsByTagName(ah)[0];n.src=w,o.X=n.x=v,o.Y=n.y=u,o.W=n.width=t,o.H=n.height=q,n.path=p,o.type="image",a.parentNode==j&&j.removeChild(a),a.rotate=!0,a.src=w,a.type="tile",o._.fillpos=[v,u],o._.fillsize=[t,q],j.appendChild(a),I(o,1,1,0,0,0);return o},aq._engine.text=function(v,u,t,q){var p=Q("shape"),o=Q("path"),n=Q("textpath");u=u||0,t=t||0,q=q||"",o.v=aq.format("m{0},{1}l{2},{1}",al(u*R),al(t*R),al(u*R)+1),o.textpathok=!0,n.string=ao(q),n.on=!0,p.style.cssText=T,p.coordsize=R+ad+R,p.coordorigin="0 0";var f=new U(p,v),c={fill:"#000",stroke:"none",font:aq._availableAttrs.font,text:q};f.shape=p,f.path=o,f.textpath=n,f.type="text",f.attrs.text=ao(q),f.attrs.x=u,f.attrs.y=t,f.attrs.w=1,f.attrs.h=1,Y(f,c),p.appendChild(n),p.appendChild(o),v.canvas.appendChild(p);var a=Q("skew");a.on=!0,p.appendChild(a),f.skew=a,f.transform(ac);return f},aq._engine.setSize=function(a,f){var e=this.canvas.style;this.width=a,this.height=f,a==+a&&(a+="px"),f==+f&&(f+="px"),e.width=a,e.height=f,e.clip="rect(0 "+a+" "+f+" 0)",this._viewBox&&aq._engine.setViewBox.apply(this,this._viewBox);return this},aq._engine.setViewBox=function(z,w,v,u,t){aq.eve("setViewBox",this,this._viewBox,[z,w,v,u,t]);var q=this.width,p=this.height,o=1/ak(v/q,u/p),n,a;t&&(n=p/u,a=q/v,v*n<q&&(z-=(q-v*n)/2/n),u*a<p&&(w-=(p-u*a)/2/a)),this._viewBox=[z,w,v,u,!!t],this._viewBoxShift={dx:-z,dy:-w,scale:o},this.forEach(function(c){c.transform("...")});return this};var Q;aq._engine.initWin=function(e){var d=e.document;d.createStyleSheet().addRule(".rvml","behavior:url(#default#VML)");try{!d.namespaces.rvml&&d.namespaces.add("rvml","urn:schemas-microsoft-com:vml"),Q=function(c){return d.createElement("<rvml:"+c+' class="rvml">')}}catch(f){Q=function(c){return d.createElement("<"+c+' xmlns="urn:schemas-microsoft.com:vml" class="rvml">')}}},aq._engine.initWin(aq._g.win),aq._engine.create=function(){var w=aq._getContainer.apply(0,arguments),v=w.container,u=w.height,t,q=w.width,p=w.x,o=w.y;if(!v){throw new Error("VML container not found.")}var n=new aq._Paper,l=n.canvas=aq._g.doc.createElement("div"),a=l.style;p=p||0,o=o||0,q=q||512,u=u||342,n.width=q,n.height=u,q==+q&&(q+="px"),u==+u&&(u+="px"),n.coordsize=R*1000+ad+R*1000,n.coordorigin="0 0",n.span=aq._g.doc.createElement("span"),n.span.style.cssText="position:absolute;left:-9999em;top:-9999em;padding:0;margin:0;line-height:1;",l.appendChild(n.span),a.cssText=aq.format("top:0;left:0;width:{0};height:{1};display:inline-block;position:relative;clip:rect(0 {0} {1} 0);overflow:hidden",q,u),v==1?(aq._g.doc.body.appendChild(l),a.left=p+"px",a.top=o+"px",a.position="absolute"):v.firstChild?v.insertBefore(l,v.firstChild):v.appendChild(l),n.renderfix=function(){};return n},aq.prototype.clear=function(){aq.eve("clear",this),this.canvas.innerHTML=ac,this.span=aq._g.doc.createElement("span"),this.span.style.cssText="position:absolute;left:-9999em;top:-9999em;padding:0;margin:0;line-height:1;display:inline;",this.canvas.appendChild(this.span),this.bottom=this.top=null},aq.prototype.remove=function(){aq.eve("remove",this),this.canvas.parentNode.removeChild(this.canvas);for(var a in this){this[a]=typeof this[a]=="function"?aq._removedFactory(a):null}return !0};var O=aq.st;for(var M in S){S[ap](M)&&!O[ap](M)&&(O[M]=function(c){return function(){var a=arguments;return this.forEach(function(d){d[c].apply(d,a)})}}(M))}}(window.Raphael);(function(){var N,M,L,J,I,H,G,F,E,D,C,B,A,z,w,v,u=Object.prototype.hasOwnProperty,t=function(f,e){function h(){this.constructor=f}for(var i in e){u.call(e,i)&&(f[i]=e[i])}h.prototype=e.prototype,f.prototype=new h,f.__super__=e.prototype;return f};D=typeof exports!="undefined"&&exports!==null?exports:this,F=(B=D.chroma)!=null?B:D.chroma={},typeof module!="undefined"&&module!==null&&(module.exports=F),F.version="0.3.0",L=function(){function c(a,l,k,j){var i,h;i=this,a==null&&l==null&&k==null&&j==null&&(a=[255,0,255]),C(a)==="array"&&a.length===3&&(j==null&&(j=l),h=a,a=h[0],l=h[1],k=h[2]),C(a)==="string"?j="hex":j==null&&(j="rgb"),j==="rgb"?i.rgb=[a,l,k]:j==="hsl"?i.rgb=c.hsl2rgb(a,l,k):j==="hsv"?i.rgb=c.hsv2rgb(a,l,k):j==="hex"?i.rgb=c.hex2rgb(a):j==="lab"?i.rgb=c.lab2rgb(a,l,k):j==="hcl"?i.rgb=c.hcl2rgb(a,l,k):j==="hsi"&&(i.rgb=c.hsi2rgb(a,l,k))}c.prototype.hex=function(){return c.rgb2hex(this.rgb)},c.prototype.toString=function(){return this.hex()},c.prototype.hsl=function(){return c.rgb2hsl(this.rgb)},c.prototype.hsv=function(){return c.rgb2hsv(this.rgb)},c.prototype.lab=function(){return c.rgb2lab(this.rgb)},c.prototype.hcl=function(){return c.rgb2hcl(this.rgb)},c.prototype.hsi=function(){return c.rgb2hsi(this.rgb)},c.prototype.interpolate=function(ab,aa,Z){var Y,X,W,V,U,T,S,R,Q,P,O,k,a;R=this,Z==null&&(Z="rgb"),C(aa)==="string"&&(aa=new c(aa));if(Z==="hsl"||Z==="hsv"||Z==="hcl"||Z==="hsi"){Z==="hsl"?(k=R.hsl(),a=aa.hsl()):Z==="hsv"?(k=R.hsv(),a=aa.hsv()):Z==="hcl"?(k=R.hcl(),a=aa.hcl()):Z==="hsi"&&(k=R.hsi(),a=aa.hsi()),W=k[0],P=k[1],T=k[2],V=a[0],O=a[1],S=a[2];if(!isNaN(W)&&!isNaN(V)){V>W&&V-W>180?Y=V-(W+360):V<W&&W-V>180?Y=V+360-W:Y=V-W,X=W+ab*Y}else{if(!isNaN(W)){X=W;if(S===1||S===0){Q=P}}else{if(!isNaN(V)){X=V;if(T===1||T===0){Q=O}}else{X=void 0}}}Q==null&&(Q=P+ab*(O-P)),U=T+ab*(S-T);return new c(X,Q,U,Z)}if(Z==="rgb"){k=R.rgb,a=aa.rgb;return new c(k[0]+ab*(a[0]-k[0]),k[1]+ab*(a[1]-k[1]),k[2]+ab*(a[2]-k[2]),Z)}if(Z==="lab"){k=R.lab(),a=aa.lab();return new c(k[0]+ab*(a[0]-k[0]),k[1]+ab*(a[1]-k[1]),k[2]+ab*(a[2]-k[2]),Z)}throw"color mode "+Z+" is not supported"};return c}(),L.hex2rgb=function(h){var f,k,j,i;if(!h.match(/^#?([A-Fa-f0-9]{6}|[A-Fa-f0-9]{3})$/)){if(F.colors!=null&&F.colors[h]){h=F.colors[h]}else{throw"unknown color format: "+h}}if(h.length===4||h.length===7){h=h.substr(1)}h.length===3&&(h=h[0]+h[0]+h[1]+h[1]+h[2]+h[2]),i=parseInt(h,16),j=i>>16,k=i>>8&255,f=i&255;return[j,k,f]},L.rgb2hex=function(i,h,n){var l,k,j;i!==void 0&&i.length===3&&(j=i,i=j[0],h=j[1],n=j[2]),k=i<<16|h<<8|n,l="000000"+k.toString(16).toUpperCase();return"#"+l.substr(l.length-6)},L.hsv2rgb=function(af,ae,ad){var ac,ab,aa,Z,Y,X,W,V,U,T,S,R,Q,P,O,k;C(af)==="array"&&af.length===3&&(T=af,af=T[0],ae=T[1],Y=T[2]),ad*=255;if(ae===0&&isNaN(af)){V=aa=ac=ad}else{af===360&&(af=0),af>360&&(af-=360),af<0&&(af+=360),af/=60,Z=Math.floor(af),ab=af-Z,X=ad*(1-ae),W=ad*(1-ae*ab),U=ad*(1-ae*(1-ab));switch(Z){case 0:S=[ad,U,X],V=S[0],aa=S[1],ac=S[2];break;case 1:R=[W,ad,X],V=R[0],aa=R[1],ac=R[2];break;case 2:Q=[X,ad,U],V=Q[0],aa=Q[1],ac=Q[2];break;case 3:P=[X,W,ad],V=P[0],aa=P[1],ac=P[2];break;case 4:O=[U,X,ad],V=O[0],aa=O[1],ac=O[2];break;case 5:k=[ad,X,W],V=k[0],aa=k[1],ac=k[2]}}V=Math.round(V),aa=Math.round(aa),ac=Math.round(ac);return[V,aa,ac]},L.rgb2hsv=function(R,Q,P){var O,q,p,o,n,l,k;R!==void 0&&R.length===3&&(k=R,R=k[0],Q=k[1],P=k[2]),o=Math.min(R,Q,P),p=Math.max(R,Q,P),O=p-o,l=p/255,n=O/p,n===0?(q=void 0,n=0):(R===p&&(q=(Q-P)/O),Q===p&&(q=2+(P-R)/O),P===p&&(q=4+(R-Q)/O),q*=60,q<0&&(q+=360));return[q,n,l]},L.hsl2rgb=function(W,V,U){var T,S,R,Q,P,O,q,p,o,n;W!==void 0&&W.length===3&&(o=W,W=o[0],V=o[1],U=o[2]);if(V===0){P=R=T=U*255}else{p=[0,0,0],S=[0,0,0],q=U<0.5?U*(1+V):U+V-U*V,O=2*U-q,W/=360,p[0]=W+1/3,p[1]=W,p[2]=W-1/3;for(Q=0;Q<=2;Q++){p[Q]<0&&(p[Q]+=1),p[Q]>1&&(p[Q]-=1),6*p[Q]<1?S[Q]=O+(q-O)*6*p[Q]:2*p[Q]<1?S[Q]=q:3*p[Q]<2?S[Q]=O+(q-O)*(2/3-p[Q])*6:S[Q]=O}n=[Math.round(S[0]*255),Math.round(S[1]*255),Math.round(S[2]*255)],P=n[0],R=n[1],T=n[2]}return[P,R,T]},L.rgb2hsl=function(P,O,q){var p,o,n,l,k,j;P!==void 0&&P.length===3&&(j=P,P=j[0],O=j[1],q=j[2]),P/=255,O/=255,q/=255,l=Math.min(P,O,q),n=Math.max(P,O,q),o=(n+l)/2,n===l?(k=0,p=void 0):k=o<0.5?(n-l)/(n+l):(n-l)/(2-n-l),P===n?p=(O-q)/(n-l):O===n?p=2+(q-P)/(n-l):q===n&&(p=4+(P-O)/(n-l)),p*=60,p<0&&(p+=360);return[p,k,o]},L.lab2xyz=function(R,Q,P){var O,q,p,o,n,l,k;C(R)==="array"&&R.length===3&&(k=R,R=k[0],Q=k[1],P=k[2]),O=function(c){return c>6/29?c*c*c:3*(6/29)*(6/29)*(c-4/29)},p=(R+0.16)/1.16,q=[0.96421,1,0.82519],n=q[1]*O(p),o=q[0]*O(p+Q/5),l=q[2]*O(p-P/2);return[o,n,l]},L.xyz2rgb=function(W,V,U){var T,S,R,Q,P,O,q,p,o,k;C(W)==="array"&&W.length===3&&(o=W,W=o[0],V=o[1],U=o[2]),p=3.2406*W-1.5372*V-0.4986*U,O=-0.9689*W+1.8758*V+0.0415*U,S=0.0557*W-0.204*V+1.057*U,R=Math.min(p,O,S)<-0.001||Math.max(p,O,S)>1.001,R&&(p=p<0?0:p>1?1:p,O=O<0?0:O>1?1:O,S=S<0?0:S>1?1:S),R&&(k=[void 0,void 0,void 0],p=k[0],O=k[1],S=k[2]),Q=function(d){var c;c=0.055;return d<=0.0031308?12.92*d:(1+c)*Math.pow(d,1/2.4)-c},q=Math.round(255*Q(p)),P=Math.round(255*Q(O)),T=Math.round(255*Q(S));return[q,P,T]},L.lab2rgb=function(P,O,q){var p,o,n,l,k,c;P!==void 0&&P.length===3&&(l=P,P=l[0],O=l[1],q=l[2]),P!==void 0&&P.length===3&&(k=P,P=k[0],O=k[1],q=k[2]),c=L.lab2xyz(P,O,q),p=c[0],o=c[1],n=c[2];return L.xyz2rgb(p,o,n)},L.hcl2lab=function(R,Q,P){var O,q,p,o,n,l,k;C(R)==="array"&&R.length===3&&(k=R,R=k[0],Q=k[1],P=k[2]),R/=360,q=6.283185307179586,O=P*0.61+0.09,o=q/6-R*q,l=(P*0.311+0.125)*Q,p=Math.sin(o)*l,n=Math.cos(o)*l;return[O,p,n]},L.hcl2rgb=function(i,c,o){var n,l,k,j;j=L.hcl2lab(i,c,o),n=j[0],l=j[1],k=j[2];return L.lab2rgb(n,l,k)},L.rgb2xyz=function(T,S,R){var Q,P,O,q,p,o,n,l;T!==void 0&&T.length===3&&(l=T,T=l[0],S=l[1],R=l[2]),P=function(d){var c;c=0.055;return d<=0.04045?d/12.92:Math.pow((d+c)/(1+c),2.4)},q=P(T/255),O=P(S/255),Q=P(R/255),p=0.4124*q+0.3576*O+0.1805*Q,o=0.2126*q+0.7152*O+0.0722*Q,n=0.0193*q+0.1192*O+0.9505*Q;return[p,o,n]},L.xyz2lab=function(P,O,q){var p,o,n,l,k,j;P!==void 0&&P.length===3&&(j=P,P=j[0],O=j[1],q=j[2]),l=[0.96421,1,0.82519],n=function(c){return c>Math.pow(6/29,3)?Math.pow(c,1/3):7.787037037037035*c+4/29},k=1.16*n(O/l[1])-0.16,p=5*(n(P/l[0])-n(O/l[1])),o=2*(n(O/l[1])-n(q/l[2]));return[k,p,o]},L.rgb2lab=function(j,c,q){var p,o,n,l,k;j!==void 0&&j.length===3&&(l=j,j=l[0],c=l[1],q=l[2]),k=L.rgb2xyz(j,c,q),p=k[0],o=k[1],n=k[2];return L.xyz2lab(p,o,n)},L.lab2hcl=function(R,Q,P){var O,q,p,o,n,l,k;C(R)==="array"&&R.length===3&&(k=R,R=k[0],Q=k[1],P=k[2]),O=R,R=(R-0.09)/0.61,n=Math.sqrt(Q*Q+P*P),l=n/(R*0.311+0.125),q=6.283185307179586,p=Math.atan2(Q,P),o=(q/6-p)/q,o*=360,o<0&&(o+=360);return[o,l,R]},L.rgb2hcl=function(i,c,o){var n,l,k,j;C(i)==="array"&&i.length===3&&(k=i,i=k[0],c=k[1],o=k[2]),j=L.rgb2lab(i,c,o),l=j[0],n=j[1],o=j[2];return L.lab2hcl(l,n,o)},L.rgb2hsi=function(P,O,q){var p,o,n,l,k,j;C(P)==="array"&&P.length===3&&(j=P,P=j[0],O=j[1],q=j[2]),p=Math.PI*2,P/=255,O/=255,q/=255,l=Math.min(P,O,q),n=(P+O+q)/3,k=1-l/n,k===0?o=0:(o=(P-O+(P-q))/2,o/=Math.sqrt((P-O)*(P-O)+(P-q)*(O-q)),o=Math.acos(o),q>O&&(o=p-o),o/=p);return[o*360,k,n]},L.hsi2rgb=function(R,Q,P){var O,q,p,o,n,l,k;C(R)==="array"&&R.length===3&&(k=R,R=k[0],Q=k[1],P=k[2]),q=Math.PI*2,O=Math.PI/3,o=Math.cos,R<0&&(R+=360),R>360&&(R-=360),R/=360,R<1/3?(p=(1-Q)/3,l=(1+Q*o(q*R)/o(O-q*R))/3,n=1-(p+l)):R<2/3?(R-=1/3,l=(1-Q)/3,n=(1+Q*o(q*R)/o(O-q*R))/3,p=1-(l+n)):(R-=2/3,n=(1-Q)/3,p=(1+Q*o(q*R)/o(O-q*R))/3,l=1-(n+p)),l=P*l*3,n=P*n*3,p=P*p*3;return[l*255,n*255,p*255]},F.Color=L,F.hsl=function(e,c,f){return new L(e,c,f,"hsl")},F.hsv=function(e,c,f){return new L(e,c,f,"hsv")},F.rgb=function(e,c,f){return new L(e,c,f,"rgb")},F.hex=function(c){return new L(c)},F.lab=function(e,c,f){return new L(e,c,f,"lab")},F.hcl=function(e,c,f){return new L(e,c,f,"hcl")},F.hsi=function(e,c,f){return new L(e,c,f,"hsi")},F.interpolate=function(f,c,i,h){C(f)==="string"&&(f=new L(f)),C(c)==="string"&&(c=new L(c));return f.interpolate(i,c,h)},J=function(){function c(T){var S,R,Q,P,O,q,p,o,n,k;P=this,P.colors=Q=(O=T.colors)!=null?O:["#ddd","#222"];for(S=0,q=Q.length-1;0<=q?S<=q:S>=q;0<=q?S++:S--){R=Q[S],C(R)==="string"&&(Q[S]=new L(R))}if(T.positions!=null){P.pos=T.positions}else{P.pos=[];for(S=0,p=Q.length-1;0<=p?S<=p:S>=p;0<=p?S++:S--){P.pos.push(S/(Q.length-1))}}P.mode=(o=T.mode)!=null?o:"hsv",P.nacol=(n=T.nacol)!=null?n:"#ccc",P.setClasses((k=T.limits)!=null?k:[0,1]),P}c.prototype.getColor=function(h){var f,k,j,i;i=this;if(isNaN(h)){return i.nacol}i.classLimits.length>2?(f=i.getClass(h),k=f/(i.numClasses-1)):(k=j=(h-i.min)/(i.max-i.min),k=Math.min(1,Math.max(0,k)));return i.fColor(k)},c.prototype.fColor=function(i){var h,o,n,l,k,j;l=this,o=l.colors;for(n=0,j=l.pos.length-1;0<=j?n<=j:n>=j;0<=j?n++:n--){k=l.pos[n];if(i<=k){h=o[n];break}if(i>=k&&n===l.pos.length-1){h=o[n];break}if(i>k&&i<l.pos[n+1]){i=(i-k)/(l.pos[n+1]-k),h=F.interpolate(o[n],o[n+1],i,l.mode);break}}return h},c.prototype.classifyValue=function(i){var h,o,n,l,k,j;j=this,o=j.classLimits,o.length>2&&(k=o.length-1,h=j.getClass(i),i=o[h]+(o[h+1]-o[h])*0.5,l=o[0],n=o[k-1],i=j.min+(i-l)/(n-l)*(j.max-j.min));return i},c.prototype.setClasses=function(e){var d;e==null&&(e=[]),d=this,d.classLimits=e,d.min=e[0],d.max=e[e.length-1];return e.length===2?d.numClasses=0:d.numClasses=e.length-1},c.prototype.getClass=function(h){var f,k,j,i;i=this,k=i.classLimits;if(k!=null){j=k.length-1,f=0;while(f<j&&h>=k[f]){f++}return f-1}},c.prototype.validValue=function(d){return !isNaN(d)};return c}(),F.ColorScale=J,H=function(){function c(a,f,e){a==null&&(a="#fe0000"),f==null&&(f="#feeeee"),e==null&&(e="hsl"),c.__super__.constructor.call(this,[a,f],[0,1],e)}t(c,J);return c}(),F.Ramp=H,I=function(){function c(a,l,k,j,i){var h;a==null&&(a="#d73027"),l==null&&(l="#ffffbf"),k==null&&(k="#1E6189"),j==null&&(j="mean"),i==null&&(i="hsl"),h=this,h.mode=i,h.center=j,c.__super__.constructor.call(this,[a,l,k],[0,0.5,1],i)}t(c,J),c.prototype.parseData=function(a,i){var h,f;c.__super__.parseData.call(this,a,i),f=this,h=f.center,h==="median"?h=f.median:h==="mean"&&(h=f.mean);return f.pos[1]=(h-f.min)/(f.max-f.min)};return c}(),F.Diverging=I,M=function(){function c(e){var d;d=this,d.colors=e}t(c,J),c.prototype.parseData=function(e,d){},c.prototype.getColor=function(e){var d;d=this;return d.colors.hasOwnProperty(e)?d.colors[e]:"#cccccc"},c.prototype.validValue=function(d){return this.colors.hasOwnProperty(d)};return c}(),F.Categories=M,N=function(){function c(e){var d;d=this,d.name=e,d.setClasses(7),d}t(c,J),c.prototype.getColor=function(e){var d,f;f=this,d=f.getClass(e);return f.name+" l"+f.numClasses+" c"+d};return c}(),F.CSSColors=N,(A=F.scales)==null&&(F.scales={}),F.scales.cool=function(){return new H(F.hsl(180,1,0.9),F.hsl(250,0.7,0.4))},F.scales.hot=function(){return new J({colors:["#000000","#ff0000","#ffff00","#ffffff"],positions:[0,0.25,0.75,1],mode:"rgb"})},F.scales.BlWhOr=function(){return new I(F.hsl(30,1,0.55),"#ffffff",new L(220,1,0.55))},F.scales.GrWhPu=function(){return new I(F.hsl(120,0.8,0.4),"#ffffff",new L(280,0.8,0.4))},F.limits=function(aY,aX,aW,aV){var aU,aT,aS,aR,aQ,aP,aO,aN,aM,aL,aK,aJ,aI,aH,aG,aF,aE,aD,aC,aB,aA,az,ay,ax,aw,av,au,at,ar,aq,ap,ao,an,am,al,ak,aj,ai,ah,ag,af,ae,ad,ac,ab,aa,k;aX==null&&(aX="equal"),aW==null&&(aW=7),aV==null&&(aV=null),aI=Number.MAX_VALUE,aJ=Number.MAX_VALUE*-1,ay=0,au=[];if(C(aY)==="array"){if(C(aY[0])!=="object"&&C(aY[0])!=="array"){for(at=0,ap=aY.length;at<ap;at++){aw=aY[at],isNaN(aw)||au.push(Number(aw))}}else{for(ar=0,ao=aY.length;ar<ao;ar++){az=aY[ar],au.push(Number(az[aV]))}}}else{if(C(aY)==="object"){for(aM in aY){aw=aY[aM],C(aw)==="object"&&C(aV)==="string"?isNaN(aw[aV])||au.push(Number(aw[aV])):C(aw)==="array"&&C(aV)==="number"?isNaN(aw[aV])||au.push(Number(aw[aV])):C(aw)==="number"&&(isNaN(aw)||au.push(Number(aw)))}}}for(aq=0,an=au.length;aq<an;aq++){aw=au[aq];if(!isNaN(aw)){aw<aI&&(aI=aw),aw>aJ&&(aJ=aw),ay+=aw}else{continue}}au=au.sort(function(d,c){return d-c}),aK=[],aX.substr(0,1)==="c"&&(aK.push(aI),aK.push(aJ));if(aX.substr(0,1)==="e"){aK.push(aI);for(aO=1,af=aW-1;1<=af?aO<=af:aO>=af;1<=af?aO++:aO--){aK.push(aI+aO/aW*(aJ-aI))}aK.push(aJ)}else{if(aX.substr(0,1)==="q"){aK.push(aI);for(aO=1,ae=aW-1;1<=ae?aO<=ae:aO>=ae;1<=ae?aO++:aO--){aD=au.length*aO/aW,aC=Math.floor(aD),aC===aD?aK.push(au[aC]):(aB=aD-aC,aK.push(au[aC]*aB+au[aC+1]*(1-aB)))}aK.push(aJ)}else{if(aX.substr(0,1)==="k"){aG=au.length,aU=Array(aG),aQ=Array(aW),aA=!0,aF=0,aS=null,aS=[],aS.push(aI);for(aO=1,ad=aW-1;1<=ad?aO<=ad:aO>=ad;1<=ad?aO++:aO--){aS.push(aI+aO/aW*(aJ-aI))}aS.push(aJ);while(aA){for(aN=0,ac=aW-1;0<=ac?aN<=ac:aN>=ac;0<=ac?aN++:aN--){aQ[aN]=0}for(aO=0,ab=aG-1;0<=ab?aO<=ab:aO>=ab;0<=ab?aO++:aO--){av=au[aO],aH=Number.MAX_VALUE;for(aN=0,aa=aW-1;0<=aa?aN<=aa:aN>=aa;0<=aa?aN++:aN--){aP=Math.abs(aS[aN]-av),aP<aH&&(aH=aP,aT=aN)}aQ[aT]++,aU[aO]=aT}aE=Array(aW);for(aN=0,k=aW-1;0<=k?aN<=k:aN>=k;0<=k?aN++:aN--){aE[aN]=null}for(aO=0,am=aG-1;0<=am?aO<=am:aO>=am;0<=am?aO++:aO--){aR=aU[aO],aE[aR]===null?aE[aR]=au[aO]:aE[aR]+=au[aO]}for(aN=0,al=aW-1;0<=al?aN<=al:aN>=al;0<=al?aN++:aN--){aE[aN]*=1/aQ[aN]}aA=!1;for(aN=0,ak=aW-1;0<=ak?aN<=ak:aN>=ak;0<=ak?aN++:aN--){if(aE[aN]!==aS[aO]){aA=!0;break}}aS=aE,aF++,aF>200&&(aA=!1)}aL={};for(aN=0,aj=aW-1;0<=aj?aN<=aj:aN>=aj;0<=aj?aN++:aN--){aL[aN]=[]}for(aO=0,ai=aG-1;0<=ai?aO<=ai:aO>=ai;0<=ai?aO++:aO--){aR=aU[aO],aL[aR].push(au[aO])}ax=[];for(aN=0,ah=aW-1;0<=ah?aN<=ah:aN>=ah;0<=ah?aN++:aN--){ax.push(aL[aN][0]),ax.push(aL[aN][aL[aN].length-1])}ax=ax.sort(function(d,c){return d-c}),aK.push(ax[0]);for(aO=1,ag=ax.length-1;aO<=ag;aO+=2){isNaN(ax[aO])||aK.push(ax[aO])}}}}return aK},D=typeof exports!="undefined"&&exports!==null?exports:this,C=function(){var h,f,k,j,i;h={},i="Boolean Number String Function Array Date RegExp Undefined Null".split(" ");for(k=0,j=i.length;k<j;k++){f=i[k],h["[object "+f+"]"]=f.toLowerCase()}return function(a){var d;d=Object.prototype.toString.call(a);return h[d]||"object"}}(),(z=D.type)==null&&(D.type=C),Array.max=function(c){return Math.max.apply(Math,c)},Array.min=function(c){return Math.min.apply(Math,c)},D=typeof exports!="undefined"&&exports!==null?exports:this,F=(w=D.chroma)!=null?w:D.chroma={},F.brewer=G={},G.OrRd=["#fff7ec","#fee8c8","#fdd49e","#fdbb84","#fc8d59","#ef6548","#d7301f","#b30000","#7f0000"],G.PuBu=["#fff7fb","#ece7f2","#d0d1e6","#a6bddb","#74a9cf","#3690c0","#0570b0","#045a8d","#023858"],G.BuPu=["#f7fcfd","#e0ecf4","#bfd3e6","#9ebcda","#8c96c6","#8c6bb1","#88419d","#810f7c","#4d004b"],G.Oranges=["#fff5eb","#fee6ce","#fdd0a2","#fdae6b","#fd8d3c","#f16913","#d94801","#a63603","#7f2704"],G.BuGn=["#f7fcfd","#e5f5f9","#ccece6","#99d8c9","#66c2a4","#41ae76","#238b45","#006d2c","#00441b"],G.YlOrBr=["#ffffe5","#fff7bc","#fee391","#fec44f","#fe9929","#ec7014","#cc4c02","#993404","#662506"],G.YlGn=["#ffffe5","#f7fcb9","#d9f0a3","#addd8e","#78c679","#41ab5d","#238443","#006837","#004529"],G.Reds=["#fff5f0","#fee0d2","#fcbba1","#fc9272","#fb6a4a","#ef3b2c","#cb181d","#a50f15","#67000d"],G.RdPu=["#fff7f3","#fde0dd","#fcc5c0","#fa9fb5","#f768a1","#dd3497","#ae017e","#7a0177","#49006a"],G.Greens=["#f7fcf5","#e5f5e0","#c7e9c0","#a1d99b","#74c476","#41ab5d","#238b45","#006d2c","#00441b"],G.YlGnBu=["#ffffd9","#edf8b1","#c7e9b4","#7fcdbb","#41b6c4","#1d91c0","#225ea8","#253494","#081d58"],G.Purples=["#fcfbfd","#efedf5","#dadaeb","#bcbddc","#9e9ac8","#807dba","#6a51a3","#54278f","#3f007d"],G.GnBu=["#f7fcf0","#e0f3db","#ccebc5","#a8ddb5","#7bccc4","#4eb3d3","#2b8cbe","#0868ac","#084081"],G.Greys=["#ffffff","#f0f0f0","#d9d9d9","#bdbdbd","#969696","#737373","#525252","#252525","#000000"],G.YlOrRd=["#ffffcc","#ffeda0","#fed976","#feb24c","#fd8d3c","#fc4e2a","#e31a1c","#bd0026","#800026"],G.PuRd=["#f7f4f9","#e7e1ef","#d4b9da","#c994c7","#df65b0","#e7298a","#ce1256","#980043","#67001f"],G.Blues=["#f7fbff","#deebf7","#c6dbef","#9ecae1","#6baed6","#4292c6","#2171b5","#08519c","#08306b"],G.PuBuGn=["#fff7fb","#ece2f0","#d0d1e6","#a6bddb","#67a9cf","#3690c0","#02818a","#016c59","#014636"],G.Spectral=["#9e0142","#d53e4f","#f46d43","#fdae61","#fee08b","#ffffbf","#e6f598","#abdda4","#66c2a5","#3288bd","#5e4fa2"],G.RdYlGn=["#a50026","#d73027","#f46d43","#fdae61","#fee08b","#ffffbf","#d9ef8b","#a6d96a","#66bd63","#1a9850","#006837"],G.RdBu=["#67001f","#b2182b","#d6604d","#f4a582","#fddbc7","#f7f7f7","#d1e5f0","#92c5de","#4393c3","#2166ac","#053061"],G.PiYG=["#8e0152","#c51b7d","#de77ae","#f1b6da","#fde0ef","#f7f7f7","#e6f5d0","#b8e186","#7fbc41","#4d9221","#276419"],G.PRGn=["#40004b","#762a83","#9970ab","#c2a5cf","#e7d4e8","#f7f7f7","#d9f0d3","#a6dba0","#5aae61","#1b7837","#00441b"],G.RdYlBu=["#a50026","#d73027","#f46d43","#fdae61","#fee090","#ffffbf","#e0f3f8","#abd9e9","#74add1","#4575b4","#313695"],G.BrBG=["#543005","#8c510a","#bf812d","#dfc27d","#f6e8c3","#f5f5f5","#c7eae5","#80cdc1","#35978f","#01665e","#003c30"],G.RdGy=["#67001f","#b2182b","#d6604d","#f4a582","#fddbc7","#ffffff","#e0e0e0","#bababa","#878787","#4d4d4d","#1a1a1a"],G.PuOr=["#7f3b08","#b35806","#e08214","#fdb863","#fee0b6","#f7f7f7","#d8daeb","#b2abd2","#8073ac","#542788","#2d004b"],G.Set2=["#66c2a5","#fc8d62","#8da0cb","#e78ac3","#a6d854","#ffd92f","#e5c494","#b3b3b3"],G.Accent=["#7fc97f","#beaed4","#fdc086","#ffff99","#386cb0","#f0027f","#bf5b17","#666666"],G.Set1=["#e41a1c","#377eb8","#4daf4a","#984ea3","#ff7f00","#ffff33","#a65628","#f781bf","#999999"],G.Set3=["#8dd3c7","#ffffb3","#bebada","#fb8072","#80b1d3","#fdb462","#b3de69","#fccde5","#d9d9d9","#bc80bd","#ccebc5","#ffed6f"],G.Dark2=["#1b9e77","#d95f02","#7570b3","#e7298a","#66a61e","#e6ab02","#a6761d","#666666"],G.Paired=["#a6cee3","#1f78b4","#b2df8a","#33a02c","#fb9a99","#e31a1c","#fdbf6f","#ff7f00","#cab2d6","#6a3d9a","#ffff99","#b15928"],G.Pastel2=["#b3e2cd","#fdcdac","#cbd5e8","#f4cae4","#e6f5c9","#fff2ae","#f1e2cc","#cccccc"],G.Pastel1=["#fbb4ae","#b3cde3","#ccebc5","#decbe4","#fed9a6","#ffffcc","#e5d8bd","#fddaec","#f2f2f2"],D=typeof exports!="undefined"&&exports!==null?exports:this,F=(v=D.chroma)!=null?v:D.chroma={},F.colors=E={},E.indigo="#4b0082",E.gold="#ffd700",E.hotpink="#ff69b4",E.firebrick="#b22222",E.indianred="#cd5c5c",E.yellow="#ffff00",E.mistyrose="#ffe4e1",E.darkolivegreen="#556b2f",E.olive="#808000",E.darkseagreen="#8fbc8f",E.pink="#ffc0cb",E.tomato="#ff6347",E.lightcoral="#f08080",E.orangered="#ff4500",E.navajowhite="#ffdead",E.lime="#00ff00",E.palegreen="#98fb98",E.darkslategrey="#2f4f4f",E.greenyellow="#adff2f",E.burlywood="#deb887",E.seashell="#fff5ee",E.mediumspringgreen="#00fa9a",E.fuchsia="#ff00ff",E.papayawhip="#ffefd5",E.blanchedalmond="#ffebcd",E.chartreuse="#7fff00",E.dimgray="#696969",E.black="#000000",E.peachpuff="#ffdab9",E.springgreen="#00ff7f",E.aquamarine="#7fffd4",E.white="#ffffff",E.orange="#ffa500",E.lightsalmon="#ffa07a",E.darkslategray="#2f4f4f",E.brown="#a52a2a",E.ivory="#fffff0",E.dodgerblue="#1e90ff",E.peru="#cd853f",E.lawngreen="#7cfc00",E.chocolate="#d2691e",E.crimson="#dc143c",E.forestgreen="#228b22",E.darkgrey="#a9a9a9",E.lightseagreen="#20b2aa",E.cyan="#00ffff",E.mintcream="#f5fffa",E.silver="#c0c0c0",E.antiquewhite="#faebd7",E.mediumorchid="#ba55d3",E.skyblue="#87ceeb",E.gray="#808080",E.darkturquoise="#00ced1",E.goldenrod="#daa520",E.darkgreen="#006400",E.floralwhite="#fffaf0",E.darkviolet="#9400d3",E.darkgray="#a9a9a9",E.moccasin="#ffe4b5",E.saddlebrown="#8b4513",E.grey="#808080",E.darkslateblue="#483d8b",E.lightskyblue="#87cefa",E.lightpink="#ffb6c1",E.mediumvioletred="#c71585",E.slategrey="#708090",E.red="#ff0000",E.deeppink="#ff1493",E.limegreen="#32cd32",E.darkmagenta="#8b008b",E.palegoldenrod="#eee8aa",E.plum="#dda0dd",E.turquoise="#40e0d0",E.lightgrey="#d3d3d3",E.lightgoldenrodyellow="#fafad2",E.darkgoldenrod="#b8860b",E.lavender="#e6e6fa",E.maroon="#800000",E.yellowgreen="#9acd32",E.sandybrown="#f4a460",E.thistle="#d8bfd8",E.violet="#ee82ee",E.navy="#000080",E.magenta="#ff00ff",E.dimgrey="#696969",E.tan="#d2b48c",E.rosybrown="#bc8f8f",E.olivedrab="#6b8e23",E.blue="#0000ff",E.lightblue="#add8e6",E.ghostwhite="#f8f8ff",E.honeydew="#f0fff0",E.cornflowerblue="#6495ed",E.slateblue="#6a5acd",E.linen="#faf0e6",E.darkblue="#00008b",E.powderblue="#b0e0e6",E.seagreen="#2e8b57",E.darkkhaki="#bdb76b",E.snow="#fffafa",E.sienna="#a0522d",E.mediumblue="#0000cd",E.royalblue="#4169e1",E.lightcyan="#e0ffff",E.green="#008000",E.mediumpurple="#9370db",E.midnightblue="#191970",E.cornsilk="#fff8dc",E.paleturquoise="#afeeee",E.bisque="#ffe4c4",E.slategray="#708090",E.darkcyan="#008b8b",E.khaki="#f0e68c",E.wheat="#f5deb3",E.teal="#008080",E.darkorchid="#9932cc",E.deepskyblue="#00bfff",E.salmon="#fa8072",E.darkred="#8b0000",E.steelblue="#4682b4",E.palevioletred="#db7093",E.lightslategray="#778899",E.aliceblue="#f0f8ff",E.lightslategrey="#778899",E.lightgreen="#90ee90",E.orchid="#da70d6",E.gainsboro="#dcdcdc",E.mediumseagreen="#3cb371",E.lightgray="#d3d3d3",E.mediumturquoise="#48d1cc",E.lemonchiffon="#fffacd",E.cadetblue="#5f9ea0",E.lightyellow="#ffffe0",E.lavenderblush="#fff0f5",E.coral="#ff7f50",E.purple="#800080",E.aqua="#00ffff",E.whitesmoke="#f5f5f5",E.mediumslateblue="#7b68ee",E.darkorange="#ff8c00",E.mediumaquamarine="#66cdaa",E.darksalmon="#e9967a",E.beige="#f5f5dc",E.blueviolet="#8a2be2",E.azure="#f0ffff",E.lightsteelblue="#b0c4de",E.oldlace="#fdf5e6"}).call(this);
/*!
 *
 *    kartograph - a svg mapping library 
 *    Copyright (C) 2011  Gregor Aisch
 *
 *    This program is free software: you can redistribute it and/or modify
 *    it under the terms of the GNU General Public License as published by
 *    the Free Software Foundation, either version 3 of the License, or
 *    (at your option) any later version.
 *
 *    This program is distributed in the hope that it will be useful,
 *    but WITHOUT ANY WARRANTY; without even the implied warranty of
 *    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
 *    GNU General Public License for more details.
 *
 *    You should have received a copy of the GNU General Public License
 *    along with this program.  If not, see <http://www.gnu.org/licenses/>.
 *
 * 
 */
(function(){var aD,aB,az,ax,av,au,ar,ap,an,am,al,ak,aj,ai,ah,ag,af,ae,ad,ac,ab,aa,bZ,bY,bX,bW,bV,bU,bT,bS,bR,bQ,bP,bO,bN,a9,a7,a5,a3,a1,aZ,aX,aV,aT,aR,aP,aN,aG,a8,a6,a4,a2,a0,aY,aW,aU,aS,aQ,aO,aM,aL,aK,aJ,aI,aH,aF,aE,aC,aA,ay,aw,at,aq,ao,cc,cb,ca,b9,b8,b7,b6,b5,b4,b3,b2=Object.prototype.hasOwnProperty,b1=function(f,e){function h(){this.constructor=f}for(var i in e){b2.call(e,i)&&(f[i]=e[i])}h.prototype=e.prototype,f.prototype=new h,f.__super__=e.prototype;return f},b0=function(d,c){return function(){return d.apply(c,arguments)}};aJ=typeof exports!="undefined"&&exports!==null?exports:this,aU=(aA=aJ.kartograph)!=null?aA:aJ.kartograph={},az=function(){function c(h,f,k,j){var i;h==null&&(h=0),f==null&&(f=0),k==null&&(k=null),j==null&&(j=null),i=this,k===null?(i.xmin=Number.MAX_VALUE,i.xmax=Number.MAX_VALUE*-1):(i.xmin=i.left=h,i.xmax=i.right=h+k,i.width=k),j===null?(i.ymin=Number.MAX_VALUE,i.ymax=Number.MAX_VALUE*-1):(i.ymin=i.top=f,i.ymax=i.bottom=j+f,i.height=j);return}c.prototype.update=function(e,d){var f;d==null&&(d=e[1],e=e[0]),f=this,f.xmin=Math.min(f.xmin,e),f.ymin=Math.min(f.ymin,d),f.xmax=Math.max(f.xmax,e),f.ymax=Math.max(f.ymax,d),f.left=f.xmin,f.top=f.ymin,f.right=f.xmax,f.bottom=f.ymax,f.width=f.xmax-f.xmin,f.height=f.ymax-f.ymin;return this},c.prototype.intersects=function(d){return d.left<s.right&&d.right>s.left&&d.top<s.bottom&&d.bottom>s.top},c.prototype.inside=function(e,d){var f;f=this;return e>=f.left&&e<=f.right&&d>=f.top&&d<=f.bottom},c.prototype.join=function(e){var d;d=this,d.update(e.left,e.top),d.update(e.right,e.bottom);return this};return c}(),az.fromXML=function(h){var f,k,j,i;j=Number(h.getAttribute("x")),i=Number(h.getAttribute("y")),k=Number(h.getAttribute("w")),f=Number(h.getAttribute("h"));return new aU.BBox(j,i,k,f)},aU.BBox=az,"kartograph - a svg mapping library \nCopyright (C) 2011  Gregor Aisch\n\nThis program is free software: you can redistribute it and/or modify\nit under the terms of the GNU General Public License as published by\nthe Free Software Foundation, either version 3 of the License, or\n(at your option) any later version.\n\nThis program is distributed in the hope that it will be useful,\nbut WITHOUT ANY WARRANTY; without even the implied warranty of\nMERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\nGNU General Public License for more details.\n\nYou should have received a copy of the GNU General Public License\nalong with this program.  If not, see <http://www.gnu.org/licenses/>.",aJ=typeof exports!="undefined"&&exports!==null?exports:this,aU=(ca=aJ.kartograph)!=null?ca:aJ.kartograph={},(b9=aU.geom)==null&&(aU.geom={}),(b8=(aE=aU.geom).clipping)==null&&(aE.clipping={}),al=function(){function j(){}var i,h,n,l,k;h=0,n=1,l=2,i=4,k=8,j.prototype.compute_out_code=function(o,f,t){var q,p;p=this,q=p.INSIDE,f<o.left?q|=p.LEFT:f>o.right&&(q|=p.RIGHT),t<o.top?q|=p.TOP:t>o.bottom&&(q|=p.BOTTOM);return q},j.prototype.clip=function(D,C,B,A,z){var w,v,u,t,q,p,o;q=this,v=q.compute_out_code(D,C,B),u=q.compute_out_code(D,A,z),w=False;while(True){if(!(v|u)){w=True;break}if(v&u){break}t=code===0?u:v,t&q.TOP?(p=C+(A-C)*(D.top-B)/(z-B),o=D.top):t&q.BOTTOM?(p=C+(A-C)*(D.bottom-B)/(z-B),o=D.bottom):t&q.RIGHT?(o=B+(z-B)*(D.right-C)/(A-C),p=D.right):t&q.LEFT&&(o=B+(z-B)*(D.left-C)/(A-C),p=D.left),t===v?(C=p,B=o,v=q.compute_out_code(D,C,B)):(A=p,z=o,u=q.compute_out_code(D,A,z))}return w?[C,B,A,z]:null};return j}(),aU.geom.clipping.CohenSutherland=al,aJ=typeof exports!="undefined"&&exports!==null?exports:this,aU=(b7=aJ.kartograph)!=null?b7:aJ.kartograph={},aW=(b6=aU.filter)!=null?b6:aU.filter={},af=function(){function c(d){this.params=d!=null?d:{}}c.prototype.getFilter=function(e){var d,f;f=this,d=f.SVG("filter",{id:e}),f.buildFilter(d);return d},c.prototype._getFilter=function(){throw"not implemented"},c.prototype.SVG=function(f,e){var i,h;typeof f=="string"&&(f=window.document.createElementNS("http://www.w3.org/2000/svg",f));if(e){for(i in e){h=e[i],f.setAttribute(i,h)}}return f};return c}(),au=function(){function c(){c.__super__.constructor.apply(this,arguments)}b1(c,af),c.prototype.buildFilter=function(f){var e,i,h;h=this,e=h.SVG,i=e("feGaussianBlur",{stdDeviation:h.params.size||4,result:"blur"});return f.appendChild(i)};return c}(),aW.blur=au,ad=function(){function c(){c.__super__.constructor.apply(this,arguments)}b1(c,af),c.prototype.buildFilter=function(H){var G,F,E,D,C,B,A,z,w,v,u,t,q,p;B=this,F=(t=B.params.blur)!=null?t:4,z=(q=B.params.strength)!=null?q:1,E=(p=B.params.color)!=null?p:"#D1BEB0",typeof E=="string"&&(E=chroma.hex(E)),A=E.rgb,D=(w=B.params.inner)!=null?w:!1,C=(v=B.params.knockout)!=null?v:!1,G=(u=B.params.alpha)!=null?u:1,D?B.innerGlow(H,F,z,A,G,C):B.outerGlow(H,F,z,A,G,C)},c.prototype.outerGlow=function(D,C,B,A,z,w){var v,u,t,q,p,o,n;p=this,v=p.SVG,q=v("feColorMatrix",{"in":"SourceGraphic",type:"matrix",values:"0 0 0 0 0   0 0 0 0 0   0 0 0 0 0   0 0 0 1 0",result:"mask"}),D.appendChild(q),B>0&&(n=v("feMorphology",{"in":"mask",radius:B,operator:"dilate",result:"mask"}),D.appendChild(n)),q=v("feColorMatrix",{"in":"mask",type:"matrix",values:"0 0 0 0 "+A[0]/255+" 0 0 0 0 "+A[1]/255+" 0 0 0 0 "+A[2]/255+"  0 0 0 1 0",result:"r0"}),D.appendChild(q),u=v("feGaussianBlur",{"in":"r0",stdDeviation:C,result:"r1"}),D.appendChild(u),t=v("feComposite",{operator:"out","in":"r1",in2:"mask",result:"comp"}),D.appendChild(t),o=v("feMerge"),w||o.appendChild(v("feMergeNode",{"in":"SourceGraphic"})),o.appendChild(v("feMergeNode",{"in":"r1"}));return D.appendChild(o)},c.prototype.innerGlow=function(D,C,B,A,z,w){var v,u,t,q,p,o,n;p=this,v=p.SVG,console.log("innerglow"),q=v("feColorMatrix",{"in":"SourceGraphic",type:"matrix",values:"0 0 0 0 0   0 0 0 0 0   0 0 0 0 0   0 0 0 500 0",result:"mask"}),D.appendChild(q),n=v("feMorphology",{"in":"mask",radius:B,operator:"erode",result:"r1"}),D.appendChild(n),u=v("feGaussianBlur",{"in":"r1",stdDeviation:C,result:"r2"}),D.appendChild(u),q=v("feColorMatrix",{type:"matrix","in":"r2",values:"1 0 0 0 "+A[0]/255+" 0 1 0 0 "+A[1]/255+" 0 0 1 0 "+A[2]/255+" 0 0 0 -1 "+z,result:"r3"}),D.appendChild(q),t=v("feComposite",{operator:"in","in":"r3",in2:"mask",result:"comp"}),D.appendChild(t),o=v("feMerge"),w||o.appendChild(v("feMergeNode",{"in":"SourceGraphic"})),o.appendChild(v("feMergeNode",{"in":"comp"}));return D.appendChild(o)};return c}(),aW.glow=ad,aJ=typeof exports!="undefined"&&exports!==null?exports:this,aU=aJ.$K=(b5=aJ.kartograph)!=null?b5:aJ.kartograph={},aU.version="0.4.4",aH=function(c){return console.warn("kartograph ("+aU.version+"): "+c)},aS=function(c){return console.log("kartograph ("+aU.version+"): "+c)},(b4=(aC=String.prototype).trim)==null&&(aC.trim=function(){return this.replace(/^\s+|\s+$/g,"")}),Array.prototype.indexOf||(Array.prototype.indexOf=function(h){if(this==null){throw new TypeError}var f=Object(this),k=f.length>>>0;if(k===0){return -1}var j=0;arguments.length>0&&(j=Number(arguments[1]),j!=j?j=0:j!=0&&j!=Infinity&&j!=-Infinity&&(j=(j>0||-1)*Math.floor(Math.abs(j))));if(j>=k){return -1}var i=j>=0?j:Math.max(k-Math.abs(j),0);for(;i<k;i++){if(i in f&&f[i]===h){return i}}return -1}),bZ=function(){function c(h,f,k){var j,i;i=this,i.container=j=$(h),f==null&&(f=j.width()),k==null&&(k=j.height()),k===0&&(k=f*0.5),i.viewport=new aU.BBox(0,0,f,k),i.paper=i.createSVGLayer(),i.markers=[],i.pathById={},i.container.addClass("kartograph")}c.prototype.createSVGLayer=function(u){var t,q,p,o,n,l,k,j;o=this,(j=o._layerCnt)==null&&(o._layerCnt=0),p=o._layerCnt++,k=o.viewport,q=o.container,n=Raphael(q[0],k.width,k.height),l=$(n.canvas),l.css({position:"absolute",top:"0px",left:"0px","z-index":p+5}),q.css("position")==="static"&&q.css("position","relative"),l.addClass(u),t=$("desc",n.canvas).text(),$("desc",n.canvas).text(t.replace("with ","with kartograph "+aU.version+" and "));return n},c.prototype.createHTMLLayer=function(i){var h,o,n,l,k,j;l=this,k=l.viewport,h=l.container,(j=l._layerCnt)==null&&(l._layerCnt=0),n=l._layerCnt++,o=$('<div class="layer '+i+'" />'),o.css({position:"absolute",top:"0px",left:"0px",width:k.width+"px",height:k.height+"px","z-index":n+5}),h.append(o);return o},c.prototype.loadMap=function(i,h,n){var l,k,j;l=this,l.clear(),l.opts=n!=null?n:{},(j=(k=l.opts).zoom)==null&&(k.zoom=1),l.mapLoadCallback=h,$.ajax({url:i,dataType:$.browser.msie?"text":"xml",success:l.mapLoaded,context:l,error:function(e,d,f){return aH(e,d,f)}})},c.prototype.addLayer=function(D,C,B){var A,z,w,v,u,t,q,p,o,n;w=this,(n=w.layerIds)==null&&(w.layerIds=[]),(o=w.layers)==null&&(w.layers={}),type(D)==="object"?(v=D,D=v.id,C=v.className,B=v.key):v={},C==null&&(C=D),u=$("#"+D,w.svgSrc);if(u.length!==0){z=new bS(C,B,w,v.filter),A=$("*",u[0]);for(q=0,p=A.length;q<p;q++){t=A[q],z.addPath(t)}z.paths.length>0&&(w.layers[C]=z,w.layerIds.push(C))}},c.prototype.getLayerPath=function(e,d){var f;f=this;return f.layers[e]!=null&&f.layers[e].hasPath(d)?f.layers[e].getPath(d):null},c.prototype.onLayerEvent=function(A,z,w){var v,u,t,q,p,o,n,l;t=this,t,w==null&&(w=t.layerIds[t.layerIds.length-1]),v=function(){function d(f,e,h){this.type=f,this.cb=e,this.map=h,this.handle=b0(this.handle,this)}d.prototype.handle=function(f){var e;t=this,e=t.map.pathById[f.target.getAttribute("id")];return t.cb(e.data)};return d}(),u=new v(A,z,t);if(t.layers[w]!=null){p=t.layers[w].paths,l=[];for(o=0,n=p.length;o<n;o++){q=p[o],l.push($(q.svgPath.node).bind(A,u.handle))}return l}},c.prototype.addMarker=function(e){var d,f;d=this,d.markers.push(e),f=d.viewBC.project(d.viewAB.project(d.proj.project(e.lonlat.lon,e.lonlat.lat)));return e.render(f[0],f[1],d.container,d.paper)},c.prototype.clearMarkers=function(){var h,f,k,j,i;f=this,i=f.markers;for(k=0,j=i.length;k<j;k++){h=i[k],h.clear()}return f.markers=[]},c.prototype.choropleth=function(Y){var X,W,V,U,T,S,R,Q,P,O,N,M,L,J,I,H,G,F,E,D,C,B,A,z;N=this,O=(z=Y.layer)!=null?z:N.layerIds[N.layerIds.length-1];if(!N.layers.hasOwnProperty(O)){aH('choropleth error: layer "'+layer_ihad+'" not found')}else{U=Y.data,T=Y.value,S=Y.key,V=Y.colors,J={};if(S!=null&&type(U)==="array"){for(F=0,D=U.length;F<D;F++){G=U[F],P=G[S],J[P]=G}}else{for(P in U){G=U[P],J[P]=G}}B=N.layers[O].pathsById;for(P in B){I=B[P];for(E=0,C=I.length;E<C;E++){L=I[E],H=(A=J[P])!=null?A:null,W=V(H),Y.duration!=null?(type(Y.duration)==="function"?Q=Y.duration(H):Q=Y.duration,Y.delay!=null?type(Y.delay)==="function"?R=Y.delay(H):R=Y.delay:R=0,M=V(null),L.svgPath.attr("fill",M),X=Raphael.animation({fill:W},Q),L.svgPath.animate(X.delay(R))):L.svgPath.attr("fill",W)}}}},c.prototype.tooltips=function(C){var B,A,z,w,v,u,t,q,p,o,n;w=this,t=C.content,z=(o=C.layer)!=null?o:w.layerIds[w.layerIds.length-1];if(!w.layers.hasOwnProperty(z)){aH('tooltips error: layer "'+z+'" not found')}else{p=w.layers[z].pathsById,n=[];for(A in p){u=p[A],n.push(function(){var f,i,h;h=[];for(f=0,i=u.length;f<i;f++){v=u[f],$.isFunction(t)?q=t(A,v):q=t[A],q!=null?(B={position:{target:"mouse",viewport:$(window),adjust:{x:7,y:7}},show:{delay:20},content:{}},typeof q=="string"?B.content.text=q:$.isArray(q)&&(B.content.title=q[0],B.content.text=q[1]),h.push($(v.svgPath.node).qtip(B))):h.push(void 0)}return h}())}return n}},c.prototype.fadeIn=function(C){var B,A,z,w,v,u,t,q,p,o,n;C==null&&(C={}),v=this,w=(o=C.layer)!=null?o:v.layerIds[v.layerIds.length-1],A=(q=C.duration)!=null?q:500,p=v.layers[w].pathsById,n=[];for(z in p){t=p[z],n.push(function(){var f,i,h;h=[];for(f=0,i=t.length;f<i;f++){u=t[f],type(A)==="function"?B=A(u.data):B=A,u.svgPath.attr("opacity",0),h.push(u.svgPath.animate({opacity:1},B))}return h}())}return n},c.prototype.mapLoaded=function(A){var z,w,v,u,t,q,p,o,n,l;u=this,$.browser.msie&&(A=$(A)),u.svgSrc=A,p=u.viewport,z=$("view",A)[0],u.viewAB=w=aU.View.fromXML(z),t=(l=u.opts.padding)!=null?l:0,v=(o=u.opts.halign)!=null?o:"center",q=(n=u.opts.valign)!=null?n:"center",u.viewBC=new aU.View(w.asBBox(),p.width,p.height,t,v,q),u.proj=aU.Proj.fromXML($("proj",z)[0]);return u.mapLoadCallback(u)},c.prototype.loadCoastline=function(){var d;d=this;return $.ajax({url:"coastline.json",success:d.renderCoastline,context:d})},c.prototype.resize=function(){var F,E,D,C,B,A,z,w,v,u,t,q,p,o;B=this,F=B.container,B.viewport=w=new aU.BBox(0,0,F.width(),F.height()),B.paper.setSize(w.width,w.height),w=B.viewport,A=(p=B.opts.padding)!=null?p:0,E=(u=B.opts.halign)!=null?u:"center",z=(t=B.opts.valign)!=null?t:"center",v=B.opts.zoom,B.viewBC=new aU.View(B.viewAB.asBBox(),w.width*v,w.height*v,A,E,z),q=B.layers,o=[];for(D in q){C=q[D],o.push(C.setView(B.viewBC))}return o},c.prototype.addFilter=function(i,h,n){var l,k,j;n==null&&(n={}),j=this,l=window.document;if(aU.filter[h]!=null){k=(new aU.filter[h](n)).getFilter(i)}else{throw"unknown filter type "+h}return j.paper.defs.appendChild(k)},c.prototype.applyFilter=function(e,d){var f;f=this;return $(".polygon."+e,f.paper.canvas).attr({filter:"url(#"+d+")"})},c.prototype.lonlat2xy=function(e){var d,f;f=this,e.length===2&&(e=new aU.LonLat(e[0],e[1])),e.length===3&&(e=new aU.LonLat(e[0],e[1],e[2])),d=f.proj.project(e.lon,e.lat,e.alt);return f.viewBC.project(f.viewAB.project(d))},c.prototype.addGeoPath=function(A,z,w){var v,u,t,q,p,o,n,l;z==null&&(z=[]),w==null&&(w=""),t=this,z.length===0&&z.push("M"),p="";for(u in A){o=A[u],v=(l=z[u])!=null?l:"L",n=t.lonlat2xy(o),p+=v+n[0]+","+n[1]}q=t.paper.path(p),q.node.setAttribute("class",w)},c.prototype.showZoomControls=function(){var d;d=this,d.zc=new a9(d);return d},c.prototype.addSymbolGroup=function(e){var d,f;d=this,(f=d.symbolGroups)==null&&(d.symbolGroups=[]);return d.symbolGroups.push(e)},c.prototype.clear=function(){var i,h,n,l,k,j;h=this;if(h.layers!=null){for(i in h.layers){h.layers[i].remove()}h.layers={},h.layerIds=[]}if(h.symbolGroups!=null){j=h.symbolGroups;for(l=0,k=j.length;l<k;l++){n=j[l],n.remove()}return h.symbolGroups=[]}},c.prototype.loadStyles=function(e,d){var f;f=this;if($.browser.msie){return $.ajax({url:e,dataType:"text",success:function(h){f.styles=aU.parsecss(h);return d()},error:function(a,i,h){return aH("error while loading "+e,a,i,h)}})}$("body").append('<link rel="stylesheet" href="'+e+'" />');return d()},c.prototype.applyStyles=function(M){var L,J,I,H,G,F,E,D,C,B,A,z,w,v,u,t;H=this;if(H.styles==null){return M}(t=H._pathTypes)==null&&(H._pathTypes=["path","circle","rectangle","ellipse"]),(w=H._regardStyles)==null&&(H._regardStyles=["fill","stroke","fill-opacity","stroke-width","stroke-opacity"]),L=M.node.getAttribute("class");for(E in H.styles){G=E,v=G.split(",");for(C=0,A=v.length;C<A;C++){D=v[C],G=D.split(" "),G=G[G.length-1],G=G.split(":");if(G.length>1){continue}G=G[0].split("."),J=G.slice(1);if(J.length>0&&J.indexOf(L)<0){continue}G=G[0];if(H._pathTypes.indexOf(G)>=0&&G!==M.type){continue}F=H.styles[E],u=H._regardStyles;for(B=0,z=u.length;B<z;B++){I=u[B],F[I]!=null&&M.attr(I,F[I])}}}return M};return c}(),aU.Kartograph=bZ,aU.map=function(e,d,f){return new bZ(e,d,f)},bS=function(){function c(h,f,k,j){var i;i=this,i.id=h,i.path_id=f,i.paper=k.paper,i.view=k.viewBC,i.map=k,i.filter=j}c.prototype.addPath=function(j){var i,q,p,o,n,l,k;q=this,(k=q.paths)==null&&(q.paths=[]),i=new bR(j,q.id,q.map);if(type(q.filter)==="function"&&q.filter(i.data)===!1){i.remove()}else{q.paths.push(i);if(q.path_id!=null){(n=q.pathsById)==null&&(q.pathsById={}),(l=(p=q.pathsById)[o=i.data[q.path_id]])==null&&(p[o]=[]);return q.pathsById[i.data[q.path_id]].push(i)}}},c.prototype.hasPath=function(e){var d;d=this;return d.pathsById!=null&&d.pathsById[e]!=null},c.prototype.getPath=function(e){var d;d=this;if(d.hasPath(e)){return d.pathsById[e][0]}throw"path "+e+" not found"},c.prototype.setView=function(i){var h,o,n,l,k,j;h=this,k=h.paths,j=[];for(n=0,l=k.length;n<l;n++){o=k[n],j.push(o.setView(i))}return j},c.prototype.remove=function(){var i,h,n,l,k,j;i=this,k=i.paths,j=[];for(n=0,l=k.length;n<l;n++){h=k[n],j.push(h.remove())}return j};return c}(),aQ=0,bR=function(){function c(C,B,A){var z,w,v,u,t,q,p,o,n;u=this,t=A.paper,o=A.viewBC,u.path=q=aU.geom.Path.fromSVG(C),u.svgPath=o.projectPath(q).toSVG(t),u.svgPath.node.setAttribute("class",B),A.applyStyles(u.svgPath),p="path_"+aQ++,u.svgPath.node.setAttribute("id",p),A.pathById[p]=u,w={};for(v=0,n=C.attributes.length-1;0<=n?v<=n:v>=n;0<=n?v++:v--){z=C.attributes[v],z.name.substr(0,5)==="data-"&&(w[z.name.substr(5)]=z.value)}u.data=w}c.prototype.setView=function(f){var e,i,h;e=this,i=f.projectPath(e.path);if(e.path.type==="path"){h=i.svgString();return e.svgPath.attr({path:h})}if(e.path.type==="circle"){return e.svgPath.attr({cx:i.x,cy:i.y,r:i.r})}},c.prototype.remove=function(){var d;d=this;return d.svgPath.remove()};return c}(),an=function(){function c(h,f,k,j){var i;i=this,i.layer_id=h,i.canvas=f,i.view=k,i.renderCallback=j}c.prototype.addPath=function(f){var e,i,h;e=this,(h=e.paths)==null&&(e.paths=[]),i=aU.geom.Path.fromSVG(f);return e.paths.push(i)},c.prototype.render=function(){var i,h,n,l,k,j;i=this,n=[],j=i.paths;for(l=0,k=j.length;l<k;l++){h=j[l],n.push(i.view.projectPath(h))}return i.renderCallback(i,n)},c.prototype.drawPaths=function(){var u,t,q,p,o,n,l,k,j;q=this,u=q.canvas.getContext("2d"),k=q.paths,j=[];for(n=0,l=k.length;n<l;n++){p=k[n],p=q.view.projectPath(p),j.push(function(){var i,e,d,a;d=p.contours,a=[];for(i=0,e=d.length;i<e;i++){t=d[i],t.reverse(),a.push(function(){var w,v,h;h=[];for(w=0,v=t.length;w<v;w++){o=t[w],o===t[0]?h.push(u.moveTo(o[0],o[1])):h.push(u.lineTo(o[0],o[1]))}return h}())}return a}())}return j};return c}(),a9=function(){function c(u){this.zoomOut=b0(this.zoomOut,this),this.zoomIn=b0(this.zoomIn,this);var t,q,p,o,n,l,k,j;o=this,o.map=u,t=u.container,q=function(i,h){var A,z,w,v;h==null&&(h=[]),z=$('<div class="'+i+'" />');for(w=0,v=h.length;w<v;w++){A=h[w],z.append(A)}return z},p=function(d){return $(d.target).addClass("md")},n=function(d){return $(d.target).removeClass("md")},j=q("plus"),j.mousedown(p),j.mouseup(n),j.click(o.zoomIn),k=q("minus"),k.mousedown(p),k.mouseup(n),k.click(o.zoomOut),l=q("zoom-control",[j,k]),t.append(l)}c.prototype.zoomIn=function(e){var d;d=this,d.map.opts.zoom+=1;return d.map.resize()},c.prototype.zoomOut=function(e){var d;d=this,d.map.opts.zoom-=1,d.map.opts.zoom<1&&(d.map.opts.zoom=1);return d.map.resize()};return c}(),aJ=typeof exports!="undefined"&&exports!==null?exports:this,aU=(b3=aJ.kartograph)!=null?b3:aJ.kartograph={},bU=function(){function c(e,d,f){f==null&&(f=0),this.lon=Number(e),this.lat=Number(d),this.alt=Number(f)}c.prototype.distance=function(w){var v,u,t,q,p,o,n,l,k;k=this,v=6371,o=Math.PI/180,q=(w.lat-k.lat)*o,p=(w.lon-k.lon)*o,n=k.lat*o,l=w.lat*o,u=Math.sin(q/2)*Math.sin(q/2)+Math.sin(p/2)*Math.sin(p/2)*Math.cos(n)*Math.cos(l),t=2*Math.atan2(Math.sqrt(u),Math.sqrt(1-u));return v*t};return c}(),bW=function(){function c(a,f,e){e==null&&(e=0),c.__super__.constructor.call(this,f,a,e)}b1(c,bU);return c}(),aU.LonLat=bU,aU.LatLon=bW,aJ=typeof exports!="undefined"&&exports!==null?exports:this,aU=(ay=aJ.kartograph)!=null?ay:aJ.kartograph={},(aw=aU.marker)==null&&(aU.marker={}),a4=function(){function c(bq){var bp,bo,bn,bm,bl,bk,bj,bi,bh,bg,bf,be,bd,bc,ba,Y,W,U,S,Q,O,M,J,a,bb,Z,X,V,T,R,P,N,L=this;bj=this,be=["data","location","type","map"],bg=["filter","tooltip","layout","group","click"];for(bc=0,U=be.length;bc<U;bc++){bf=be[bc];if(bq[bf]!=null){bj[bf]=bq[bf]}else{throw"SymbolGroup: missing argument "+bf}}for(ba=0,S=bg.length;ba<S;ba++){bf=bg[ba],bq[bf]!=null&&(bj[bf]=bq[bf])}type(bj.type)==="string"?bp=K[bj.type]:bp=bj.type,V=bp.props;for(Y=0,Q=V.length;Y<Q;Y++){bf=V[Y],bq[bf]!=null&&(bj[bf]=bq[bf])}bj.layers={mapcanvas:bj.map.paper},T=bp.layers;for(W=0,O=T.length;W<O;W++){bl=T[W],bi=c._layerid++,bm="sl_"+bi,bl.type==="svg"?bk=bj.map.createSVGLayer(bm):bl.type==="html"&&(bk=bj.map.createHTMLLayer(bm)),bj.layers[bl.id]=bk}bj.symbols=[];for(bn in bj.data){bo=bj.data[bn],type(bj.filter)==="function"?bj.filter(bo)&&bj.addSymbol(bo):bj.addSymbol(bo)}bj.layoutSymbols(),R=bj.symbols;for(bb=0,M=R.length;bb<M;bb++){bd=R[bb],bd.render()}type(bj.tooltip)==="function"&&bj.initTooltips();if(type(bj.click)==="function"){P=bj.symbols;for(Z=0,J=P.length;Z<J;Z++){bd=P[Z],N=bd.nodes();for(X=0,a=N.length;X<a;X++){bh=N[X],bh.symbol=bd,$(bh).click(function(d){d.stopPropagation();return bj.click(d.target.symbol.data)})}}}bj.map.addSymbolGroup(bj)}c.prototype.addSymbol=function(w){var v,u,t,q,p,o,n,l,k;t=this,v=t.type,u=t.evaluate(t.location,w),type(u)==="array"&&(u=new aU.LonLat(u[0],u[1])),p={layers:t.layers,location:u,data:w,map:t.map},k=v.props;for(n=0,l=k.length;n<l;n++){q=k[n],t[q]!=null&&(p[q]=t.evaluate(t[q],w))}o=new v(p),t.symbols.push(o);return o},c.prototype.evaluate=function(e,d){var f;return type(e)==="function"?f=e(d):f=e},c.prototype.layoutSymbols=function(){var A,z,w,v,u,t,q,p,o,n,l;w=this,n=w.symbols;for(p=0,o=n.length;p<o;p++){t=n[p],z=t.location;if(type(z)==="string"){l=z.split("."),A=l[0],u=l[1],v=w.map.getLayerPath(A,u);if(v!=null){q=w.map.viewBC.project(v.path.centroid())}else{continue}}else{q=w.map.lonlat2xy(z)}t.x=q[0],t.y=q[1]}if(w.layout==="group"){return w.groupLayout()}},c.prototype.groupLayout=function(){var e,d,f;e=this,(f=e.gsymbols)==null&&(e.gsymbols=[]);return d=!0},c.prototype.initTooltips=function(){var C,B,A,z,w,v,u,t,q,p,o,n;B=this,w=B.tooltip,o=B.symbols;for(u=0,q=o.length;u<q;u++){z=o[u],C={position:{target:"mouse",viewport:$(window),adjust:{x:7,y:7}},show:{delay:20},content:{}},v=w(z.data),type(v)==="string"?C.content.text=v:type(v)==="array"&&(C.content.title=v[0],C.content.text=v[1]),n=z.nodes();for(t=0,p=n.length;t<p;t++){A=n[t],$(A).qtip(C)}}},c.prototype.remove=function(){var u,t,q,p,o,n,l,k,j;q=this,l=q.symbols;for(o=0,n=l.length;o<n;o++){p=l[o],p.clear()}k=q.layers,j=[];for(u in k){t=k[u],u!=="mapcanvas"?j.push(t.remove()):j.push(void 0)}return j};return c}(),a4._layerid=0,aU.SymbolGroup=a4,a6=function(){function c(e){var d;d=this,d.location=e.location,d.data=e.data,d.map=e.map,d.layers=e.layers,d.x=e.x,d.y=e.y}c.prototype.init=function(){},c.prototype.overlaps=function(d){return !1},c.prototype.nodes=function(){return[]},c.prototype.clear=function(){};return c}(),ar=function(){function c(a){var k,j,i,h;k=this,c.__super__.constructor.call(this,a),k.radius=(j=a.radius)!=null?j:4,k.style=(i=a.style)!=null?i:"",k["class"]=(h=a["class"])!=null?h:""}b1(c,a6),c.prototype.overlaps=function(C){var B,A,z,w,v,u,t,q,p,o,n;z=this,o=[z.x,z.y,z.radius],u=o[0],q=o[1],w=o[2],n=[C.x,C.y,C.radius],t=n[0],p=n[1],v=n[2];if(u-w>t+v||u+w<t-v||q-w>p+v||q+w<p-v){return !1}B=u-t,A=q-p;return B*B+A*A>(w+v)*(w+v)?!1:!0},c.prototype.render=function(e){var d;d=this,d.path=d.layers.a.circle(d.x,d.y,d.radius),d.update(),d.map.applyStyles(d.path);return d},c.prototype.update=function(){var e,d;e=this,e.path.attr({x:e.x,y:e.y,r:e.radius}),d=e.path,d.node.setAttribute("style",e.style),d.node.setAttribute("class",e["class"]);return e},c.prototype.clear=function(){var d;d=this,d.path.remove();return d},c.prototype.nodes=function(){var d;d=this;return[d.path.node]};return c}(),ar.props=["radius","style","class"],ar.layers=[{id:"a",type:"svg"}],aU.Bubble=ar,ab=function(){function c(a){var k,j,i,h;k=this,c.__super__.constructor.call(this,a),k.text=(j=a.text)!=null?j:"",k.style=(i=a.style)!=null?i:"",k["class"]=(h=a["class"])!=null?h:""}b1(c,a6),c.prototype.render=function(f){var e,i,h;h=this,e=$("<div>"+h.text+"</div>"),e.css({width:"50px",position:"absolute",left:"-25px","text-align":"center"}),h.lbl=i=$('<div class="label" />'),i.append(e),h.layers.lbl.append(i),e.css({height:e.height()+"px",top:e.height()*-0.4+"px"}),h.update();return h},c.prototype.update=function(){var d;d=this;return d.lbl.css({position:"absolute",left:d.x+"px",top:d.y+"px"})},c.prototype.clear=function(){var d;d=this,d.lbl.remove();return d},c.prototype.nodes=function(){var d;d=this;return[d.lbl[0]]};return c}(),ab.props=["text","style","class"],ab.layers=[{id:"lbl",type:"html"}],aU.HtmlLabel=ab,a8=function(){function c(a){var k,j,i,h;k=this,c.__super__.constructor.call(this,a),k.text=(j=a.text)!=null?j:"",k.style=(i=a.style)!=null?i:"",k["class"]=(h=a["class"])!=null?h:""}b1(c,a6),c.prototype.render=function(e){var d,f;f=this,f.lbl=d=f.layers.mapcanvas.text(f.x,f.y,f.text),f.update();return f},c.prototype.update=function(){var d;d=this,d.lbl.attr({x:d.x,y:d.y}),d.lbl.node.setAttribute("style",d.style);return d.lbl.node.setAttribute("class",d["class"])},c.prototype.clear=function(){var d;d=this,d.lbl.remove();return d},c.prototype.nodes=function(){var d;d=this;return[d.lbl.node]};return c}(),a8.props=["text","style","class"],a8.layers=[],aU.Label=a8,aa=function(){function c(a){var l,k,j,i,h;l=this,c.__super__.constructor.call(this,a),l.icon=(k=a.icon)!=null?k:"",l.offset=(j=a.offset)!=null?j:[0,0],l["class"]=(i=a["class"])!=null?i:"",l.title=(h=a.title)!=null?h:""}b1(c,a6),c.prototype.render=function(e){var d,f;f=this,d=f.map.container,f.img=$('<img src="'+f.icon+'" title="'+f.title+'" alt="'+f.title+'" class="'+f["class"]+'" />'),f.img.css({position:"absolute","z-index":1000,cursor:"pointer"}),f.img[0].symbol=f,d.append(f.img);return f.update()},c.prototype.update=function(){var d;d=this;return d.img.css({left:d.x+d.offset[0]+"px",top:d.y+d.offset[1]+"px"})},c.prototype.clear=function(){var d;d=this,d.img.remove();return d},c.prototype.nodes=function(){var d;d=this;return[d.img]};return c}(),aa.props=["icon","offset","class","title"],aa.layers=[],aU.Icon=aa,aJ=typeof exports!="undefined"&&exports!==null?exports:this,aU=(at=aJ.kartograph)!=null?at:aJ.kartograph={},aU.parsecss=function(w,v){var u,t,q,p,o,n,l,k;p={},w=aO(w),k=w.split("`b%");for(n=0,l=k.length;n<l;n++){u=k[n],u=u.split("%b`");if(u.length<2){continue}u[0]=aK(u[0]),q=aL(u[1]);if(p[u[0]]!=null){for(t in q){o=q[t],p[u[0]][t]=o}}else{p[u[0]]=q}}if(type(v)==="function"){v(p)}else{return p}},aM={},aL=function(i){var h,o,n,l,k,j;n=aM[i].replace(/^{|}$/g,""),n=aO(n),o={},j=n.split(";");for(l=0,k=j.length;l<k;l++){h=j[l],h=h.split(":");if(h.length<2){continue}o[aK(h[0])]=aK(h.slice(1).join(":"))}return o},aZ=/{[^{}]*}/,aV=/\[[^\[\]]*\]|{[^{}]*}|\([^()]*\)|function(\s+\w+)?(\s*%b`\d+`b%){2}/,aX=/(?:\/\*(?:[^\*]|\*[^\/])*\*\/)|(\\.|"(?:[^\\\"]|\\.|\\\n)*"|'(?:[^\\\']|\\.|\\\n)*')/g,aT=/%\w`(\d+)`\w%/,aI=0,aO=function(h,f){var k,j,i;h=h.replace(aX,function(e,d){var l;if(!d){return""}l="%s`"+ ++aI+"`s%",aM[aI]=d.replace(/^\\/,"");return l}),k=f?aV:aZ;while(j=k.exec(h)){i="%b`"+ ++aI+"`b%",aM[aI]=j[0],h=h.replace(k,i)}return h},aK=function(d){var c;if(d==null){return d}while(c=aT.exec(d)){d=d.replace(aT,aM[c[1]])}return d.trim()},aJ=typeof exports!="undefined"&&exports!==null?exports:this,aU=(aq=aJ.kartograph)!=null?aq:aJ.kartograph={},(ao=aU.geom)==null&&(aU.geom={}),a7=function(){function c(f,e,i){var h;i==null&&(i=!0),h=this,h.type=f,h.contours=e,h.closed=i}c.prototype.clipToBBox=function(d){throw"path clipping is not implemented yet"},c.prototype.toSVG=function(e){var d;d=this.svgString();return e.path(d)},c.prototype.svgString=function(){var D,C,B,A,z,w,v,u,t,q,p,o,n;A=this,z="",B=A.closed?"Z M":"M",o=A.contours;for(u=0,q=o.length;u<q;u++){D=o[u],C=!0,z+=z===""?"M":B;for(t=0,p=D.length;t<p;t++){n=D[t],w=n[0],v=n[1],C||(z+="L"),z+=w+","+v,C=!1}}A.closed&&(z+="Z");return z},c.prototype.area=function(){var j,i,q,p,o,n,l,k;p=this;if(p.areas!=null){return p._area}p.areas=[],p._area=0,l=p.contours;for(o=0,n=l.length;o<n;o++){i=l[o],j=0;for(q=0,k=i.length-2;0<=k?q<=k:q>=k;0<=k?q++:q--){j+=i[q][0]*i[q+1][1]-i[q+1][0]*i[q][1]}j*=0.5,j=j,p.areas.push(j),p._area+=j}return p._area},c.prototype.centroid=function(){var D,C,B,A,z,w,v,u,t,q,p,o,n;t=this;if(t._centroid!=null){return t._centroid}C=t.area(),A=z=0;for(w=0,o=t.contours.length-1;0<=o?w<=o:w>=o;0<=o?w++:w--){B=t.contours[w],D=t.areas[w],q=p=0;for(v=0,n=B.length-2;0<=n?v<=n:v>=n;0<=n?v++:v--){u=B[v][0]*B[v+1][1]-B[v+1][0]*B[v][1],q+=(B[v][0]+B[v+1][0])*u,p+=(B[v][1]+B[v+1][1])*u}u=1/(6*D),q*=u,p*=u,u=D/C,A+=q*u,z+=p*u}t._centroid=[A,z];return t._centroid};return c}(),aU.geom.Path=a7,am=function(){function c(a,f,e){this.x=a,this.y=f,this.r=e,c.__super__.constructor.call(this,"circle",null,!0)}b1(c,a7),c.prototype.toSVG=function(e){var d;d=this;return e.circle(d.x,d.y,d.r)},c.prototype.centroid=function(){var d;d=this;return[d.x,d.y]},c.prototype.area=function(){var d;d=this;return Math.PI*d.r*m.r};return c}(),aU.geom.Circle=am,a7.fromSVG=function(U){var T,S,R,Q,P,O,N,M,L,J,I,H,G,F,E,D,C,B,A,z,w;Q=[],H=U.nodeName,J=null;if(H==="path"){N=U.getAttribute("d").trim(),T=N[N.length-1]==="Z",I=T?"Z M":"M",N=N.substring(1,N.length-(T?1:0)),A=N.split(I);for(E=0,C=A.length;E<C;E++){R=A[E],S=[];if(R!==""){z=R.split("L");for(D=0,B=z.length;D<B;D++){M=z[D],w=M.split(","),G=w[0],F=w[1],S.push([Number(G),Number(F)])}Q.push(S)}}J=new aU.geom.Path(H,Q,T)}else{H==="circle"&&(P=U.getAttribute("cx"),O=U.getAttribute("cy"),L=U.getAttribute("r"),J=new aU.geom.Circle(P,O,L))}return J},bV=function(){function c(d){this.points=d}c.prototype.clipToBBox=function(Q){var P,O,N,M,L,J,I,H,G,F,E,D,C,B,A,z,w,v;F=this,P=(new aU.geom.clipping.CohenSutherland).clip,G=[],M=[],N=!1;for(O=0,A=F.points.length-2;0<=A?O<=A:O>=A;0<=A?O++:O--){z=F.points[O],L=z[0],J=z[1],w=F.points[O+1],I=w[0],H=w[1];try{v=P(Q,L,J,I,H),E=v[0],C=v[1],D=v[2],B=v[3],N=!0,G.push([E,C]),(I!==D||H!==C||O===len(F.points)-2)&&G.push([D,B])}catch(a){N&&G.length>1&&(M.push(new c(G)),G=[]),N=!1}}G.length>1&&M.push(new c(G));return M},c.prototype.toSVG=function(){var j,i,q,p,o,n,l,k;i=this,j=[],l=i.points;for(o=0,n=l.length;o<n;o++){k=l[o],q=k[0],p=k[1],j.push(q+","+p)}return"M"+j.join("L")};return c}(),aU.geom.Line=bV,aJ=typeof exports!="undefined"&&exports!==null?exports:this,aU=(cc=aJ.kartograph)!=null?cc:aJ.kartograph={},aF=aU.proj={},Function.prototype.bind=function(d){var c;c=this;return function(){return c.apply(d,arguments)}},a5=function(){function c(f){var e,i,h;e=this,e.lon0=(i=f.lon0)!=null?i:0,e.lat0=(h=f.lat0)!=null?h:0,e.PI=Math.PI,e.HALFPI=e.PI*0.5,e.QUARTERPI=e.PI*0.25,e.RAD=e.PI/180,e.DEG=180/e.PI,e.lam0=e.rad(this.lon0),e.phi0=e.rad(this.lat0),e.minLat=-90,e.maxLat=90}c.prototype.rad=function(d){return d*this.RAD},c.prototype.deg=function(d){return d*this.DEG},c.prototype.plot=function(D,C){var B,A,z,w,v,u,t,q,p,o,n;C==null&&(C=!0),w=[],B=!0;for(q=0,p=D.length;q<p;q++){o=D[q],z=o[0],A=o[1],v=this._visible(z,A),v&&(B=!1),n=this.project(z,A),u=n[0],t=n[1],!v&&C?w.push(this._truncate(u,t)):w.push([u,t])}return B?null:[w]},c.prototype.sea=function(){var w,v,u,t,q,p,o,n,l,k;p=this,q=p.project.bind(this),t=[],w=p.lon0,p.lon0=0;for(u=-180;u<=180;u++){t.push(q(u,p.maxLat))}for(v=o=p.maxLat,n=p.minLat;o<=n?v<=n:v>=n;o<=n?v++:v--){t.push(q(180,v))}for(u=180;u>=-180;u--){t.push(q(u,p.minLat))}for(v=l=p.minLat,k=p.maxLat;l<=k?v<=k:v>=k;l<=k?v++:v--){t.push(q(-180,v))}p.lon0=w;return t},c.prototype.world_bbox=function(){var i,h,n,l,k,j;h=this.project.bind(this),l=this.sea(),i=new aU.BBox;for(k=0,j=l.length;k<j;k++){n=l[k],i.update(n[0],n[1])}return i},c.prototype.toString=function(){var d;d=this;return"[Proj: "+d.name+"]"};return c}(),a5.fromXML=function(i){var h,o,n,l,k,j;n=i.getAttribute("id"),l={};for(o=0,j=i.attributes.length-1;0<=j?o<=j:o>=j;0<=j?o++:o--){h=i.attributes[o],h.name!=="id"&&(l[h.name]=h.value)}k=new aU.proj[n](l),k.name=n;return k},aU.Proj=a5,aj=function(){function c(a){var f,e;f=this,f.flip=Number(a.flip)||0,f.flip===1&&(a.lon0=(e=-a.lon0)!=null?e:0),c.__super__.constructor.call(this,a)}b1(c,a5),c.prototype._visible=function(e,d){return !0},c.prototype.clon=function(d){d-=this.lon0,d<-180?d+=360:d>180&&(d-=360);return d},c.prototype.ll=function(e,d){return this.flip===1?[-e,-d]:[e,d]};return c}(),ag=function(){function c(){c.__super__.constructor.apply(this,arguments)}b1(c,aj),c.prototype.project=function(e,d){var f;f=this.ll(e,d),e=f[0],d=f[1],e=this.clon(e);return[e*Math.cos(this.phi0)*1000,d*-1*1000]};return c}(),aF.lonlat=ag,ap=function(){function c(a){var d;c.__super__.constructor.call(this,a),this.lat1=(d=a.lat1)!=null?d:0,this.phi1=this.rad(this.lat1)}b1(c,aj),c.prototype.project=function(i,h){var o,n,l,k,j;j=this.ll(i,h),i=j[0],h=j[1],o=this.rad(this.clon(i)),n=this.rad(h*-1),l=o*Math.cos(this.phi1),k=Math.sin(n)/Math.cos(this.phi1);return[l*1000,k*1000]};return c}(),aF.cea=ap,ae=function(){function c(a,d){c.__super__.constructor.call(this,a,45)}b1(c,ap);return c}(),aF.gallpeters=ae,ac=function(){function c(a){a.lat0=37.7,c.__super__.constructor.call(this,a)}b1(c,ap);return c}(),aF.hobodyer=ac,av=function(){function c(a){a.lat0=30,c.__super__.constructor.call(this,a)}b1(c,ap);return c}(),aF.behrmann=av,ax=function(){function c(a){a.lat0=50,c.__super__.constructor.call(this,a)}b1(c,ap);return c}(),aF.balthasart=ax,bQ=function(){function c(a){c.__super__.constructor.call(this,a),this.minLat=-85,this.maxLat=85}b1(c,aj),c.prototype.project=function(u,t){var q,p,o,n,l,k,j;n=this,j=n.ll(u,t),u=j[0],t=j[1],p=Math,q=n.rad(n.clon(u)),o=n.rad(t*-1),l=q*1000,k=p.log((1+p.sin(o))/p.cos(o))*1000;return[l,k]};return c}(),aF.mercator=bQ,a1=function(){function c(){c.__super__.constructor.apply(this,arguments)}b1(c,aj);return c}(),bO=function(){function c(a){var d;c.__super__.constructor.call(this,a),d=this,d.A0=0.8707,d.A1=-0.131979,d.A2=-0.013791,d.A3=0.003971,d.A4=-0.001529,d.B0=1.007226,d.B1=0.015085,d.B2=-0.044475,d.B3=0.028874,d.B4=-0.005916,d.C0=d.B0,d.C1=3*d.B1,d.C2=7*d.B2,d.C3=9*d.B3,d.C4=11*d.B4,d.EPS=1e-11,d.MAX_Y=0.8707*0.52*Math.PI;return}b1(c,a1),c.prototype.project=function(w,v){var u,t,q,p,o,n,l,k;o=this,k=o.ll(w,v),w=k[0],v=k[1],u=o.rad(o.clon(w)),t=o.rad(v*-1),q=t*t,p=q*q,n=u*(o.A0+q*(o.A1+q*(o.A2+p*q*(o.A3+q*o.A4))))*180+500,l=t*(o.B0+q*(o.B1+p*(o.B2+o.B3*q+o.B4*p)))*180+270;return[n,l]};return c}(),aF.naturalearth=bO,aR=function(){function c(a){var d;c.__super__.constructor.call(this,a),d=this,d.X=[1,-5.67239e-12,-0.0000715511,0.00000311028,0.9986,-0.000482241,-0.000024897,-0.00000133094,0.9954,-0.000831031,-0.000044861,-9.86588e-7,0.99,-0.00135363,-0.0000596598,0.00000367749,0.9822,-0.00167442,-0.0000044975,-0.00000572394,0.973,-0.00214869,-0.0000903565,1.88767e-8,0.96,-0.00305084,-0.0000900732,0.00000164869,0.9427,-0.00382792,-0.0000653428,-0.00000261493,0.9216,-0.00467747,-0.000104566,0.0000048122,0.8962,-0.00536222,-0.0000323834,-0.00000543445,0.8679,-0.00609364,-0.0001139,0.00000332521,0.835,-0.00698325,-0.0000640219,9.34582e-7,0.7986,-0.00755337,-0.0000500038,9.35532e-7,0.7597,-0.00798325,-0.0000359716,-0.00000227604,0.7186,-0.00851366,-0.000070112,-0.00000863072,0.6732,-0.00986209,-0.000199572,0.0000191978,0.6213,-0.010418,0.0000883948,0.00000624031,0.5722,-0.00906601,0.000181999,0.00000624033,0.5322,0,0,0],d.Y=[0,0.0124,3.72529e-10,1.15484e-9,0.062,0.0124001,1.76951e-8,-5.92321e-9,0.124,0.0123998,-7.09668e-8,2.25753e-8,0.186,0.0124008,2.66917e-7,-8.44523e-8,0.248,0.0123971,-9.99682e-7,3.15569e-7,0.31,0.0124108,0.00000373349,-0.0000011779,0.372,0.0123598,-0.000013935,0.00000439588,0.434,0.0125501,0.0000520034,-0.0000100051,0.4968,0.0123198,-0.0000980735,0.00000922397,0.5571,0.0120308,0.0000402857,-0.0000052901,0.6176,0.0120369,-0.0000390662,7.36117e-7,0.6769,0.0117015,-0.0000280246,-8.54283e-7,0.7346,0.0113572,-0.0000408389,-5.18524e-7,0.7903,0.0109099,-0.0000486169,-0.0000010718,0.8435,0.0103433,-0.0000646934,5.36384e-9,0.8936,0.00969679,-0.0000646129,-0.00000854894,0.9394,0.00840949,-0.000192847,-0.00000421023,0.9761,0.00616525,-0.000256001,-0.00000421021,1,0,0,0],d.NODES=18,d.FXC=0.8487,d.FYC=1.3523,d.C1=11.459155902616464,d.RC1=0.08726646259971647,d.ONEEPS=1.000001,d.EPS=1e-8;return}b1(c,a1),c.prototype._poly=function(e,d,f){return e[d]+f*(e[d+1]+f*(e[d+2]+f*e[d+3]))},c.prototype.project=function(w,v){var u,t,q,p,o,n,l,k;o=this,k=o.ll(w,v),w=k[0],v=k[1],w=o.clon(w),t=o.rad(w),q=o.rad(v*-1),p=Math.abs(q),u=Math.floor(p*o.C1),u>=o.NODES&&(u=o.NODES-1),p=o.deg(p-o.RC1*u),u*=4,n=o._poly(o.X,u,p)*o.FXC*t,l=o._poly(o.Y,u,p)*o.FYC,q<0&&(l=-l);return[n,l]};return c}(),aF.robinson=aR,ai=function(){function c(a){var d;c.__super__.constructor.call(this,a),d=this,d.C_x=0.4222382003157712,d.C_y=1.3265004281770023,d.RC_y=0.7538633073600218,d.C_p=3.5707963267948966,d.RC_p=0.2800495767557787,d.EPS=1e-7,d.NITER=6}b1(c,a1),c.prototype.project=function(D,C){var B,A,z,w,v,u,t,q,p,o,n;u=this,n=u.ll(D,C),D=n[0],C=n[1],w=u.rad(u.clon(D)),v=u.rad(C*-1),t=u.C_p*Math.sin(v),B=v*v,v*=0.895168+B*(0.0218849+B*0.00826809),z=u.NITER;while(z>0){A=Math.cos(v),q=Math.sin(v),B=(v+q*(A+2)-t)/(1+A*(A+2)-q*q),v-=B;if(Math.abs(B)<u.EPS){break}z-=1}z===0?(p=u.C_x*w,o=v<0?-u.C_y:u.C_y):(p=u.C_x*w*(1+Math.cos(v)),o=u.C_y*Math.sin(v));return[p,o]};return c}(),aF.eckert4=ai,aN=function(){function c(){c.__super__.constructor.apply(this,arguments)}b1(c,a1),c.prototype.project=function(j,i){var q,p,o,n,l,k;p=this,k=p.ll(j,i),j=k[0],i=k[1],q=p.rad(p.clon(j)),o=p.rad(i*-1),n=q*Math.cos(o),l=o;return[n,l]};return c}(),aF.sinusoidal=aN,bP=function(){function c(u,t,q,p,o){var n,l,k,a;t==null&&(t=1.5707963267948966),q==null&&(q=null),p==null&&(p=null),o==null&&(o=null),c.__super__.constructor.call(this,u),n=this,n.MAX_ITER=10,n.TOLERANCE=1e-7,t!=null?(l=t+t,a=Math.sin(t),k=Math.sqrt(Math.PI*2*a/(l+Math.sin(l))),n.cx=2*k/Math.PI,n.cy=k/a,n.cp=l+Math.sin(l)):q!=null&&p!=null&&typeof cz!="undefined"&&cz!==null?(n.cx=q,n.cy=p,n.cp=o):console.error("kartograph.proj.Mollweide: either p or cx,cy,cp must be defined")}b1(c,a1),c.prototype.project=function(D,C){var B,A,z,w,v,u,t,q,p,o,n;u=this,n=u.ll(D,C),D=n[0],C=n[1],v=Math,B=v.abs,w=u.rad(u.clon(D)),t=u.rad(C),z=u.cp*v.sin(t),A=u.MAX_ITER;while(A!==0){q=(t+v.sin(t)-z)/(1+v.cos(t)),t-=q;if(B(q)<u.TOLERANCE){break}A-=1}A===0?t=t>=0?u.HALFPI:-u.HALFPI:t*=0.5,p=1000*u.cx*w*v.cos(t),o=1000*u.cy*v.sin(t);return[p,o*-1]};return c}(),aF.mollweide=bP,a0=function(){function c(a){c.__super__.constructor.call(this,a,1.0471975511965976)}b1(c,bP);return c}(),aF.wagner4=a0,aY=function(){function c(a){c.__super__.constructor.call(this,a,null,0.90977,1.65014,3.00896)}b1(c,bP);return c}(),aF.wagner5=aY,bT=function(){function f(){f.__super__.constructor.apply(this,arguments)}var e,d;b1(f,a1),d=-89,e=89,f.prototype.project=function(u,t){var q,p,o,n,l,k,j;o=this,j=o.ll(u,t),u=j[0],t=j[1],p=Math,q=o.rad(o.clon(u)),n=o.rad(t),n===o.phi0?l=q*p.cos(o.phi0):l=q*(n-o.phi0)/(p.log(p.tan(o.QUARTERPI+n*0.5))-p.log(p.tan(o.QUARTERPI+o.phi0*0.5))),l*=1000,k=1000*(n-o.phi0);return[l,k*-1]};return f}(),aF.loximuthal=bT,aB=function(){function c(a,f){var e;f==null&&(f=1000),c.__super__.constructor.call(this,a),e=this,e.r=f,e.elevation0=e.to_elevation(e.lat0),e.azimuth0=e.to_azimuth(e.lon0)}b1(c,a5),c.prototype.to_elevation=function(e){var d;d=this;return(e+90)/180*d.PI-d.HALFPI},c.prototype.to_azimuth=function(e){var d;d=this;return(e+180)/360*d.PI*2-d.PI},c.prototype._visible=function(i,h){var o,n,l,k,j;j=this,k=Math,l=j.to_elevation(h),o=j.to_azimuth(i),n=k.sin(l)*k.sin(j.elevation0)+k.cos(j.elevation0)*k.cos(l)*k.cos(o-j.azimuth0);return n>=0},c.prototype._truncate=function(i,h){var o,n,l,k,j;o=Math,n=this.r,l=o.atan2(h-n,i-n),k=n+n*o.cos(l),j=n+n*o.sin(l);return[k,j]},c.prototype.sea=function(){var f,e,i,h;e=[],h=this.r,f=Math;for(i=0;i<=360;i++){e.push([h+f.cos(this.rad(i))*h,h+f.sin(this.rad(i))*h])}return e},c.prototype.world_bbox=function(){var d;d=this.r;return new aU.BBox(0,0,d*2,d*2)};return c}(),bN=function(){function c(){c.__super__.constructor.apply(this,arguments)}b1(c,aB),c.prototype.project=function(w,v){var u,t,q,p,o,n,l,k;p=this,q=Math,t=p.to_elevation(v),u=p.to_azimuth(w),n=p.r*q.cos(t)*q.sin(u-p.azimuth0),k=-p.r*(q.cos(p.elevation0)*q.sin(t)-q.sin(p.elevation0)*q.cos(t)*q.cos(u-p.azimuth0)),o=p.r+n,l=p.r+k;return[o,l]};return c}(),aF.ortho=bN,bY=function(){function c(a){c.__super__.constructor.call(this,a),this.scale=Math.sqrt(2)*0.5}b1(c,aB),c.prototype.project=function(C,B){var A,z,w,v,u,t,q,p,o,n;u=this.rad(B),w=this.rad(C),v=Math,t=v.sin,A=v.cos,z=v.pow(2/(1+t(this.phi0)*t(u)+A(this.phi0)*A(u)*A(w-this.lam0)),0.5),z*=this.scale,p=this.r*z*A(u)*t(w-this.lam0),n=-this.r*z*(A(this.phi0)*t(u)-t(this.phi0)*A(u)*A(w-this.lam0)),q=this.r+p,o=this.r+n;return[q,o]};return c}(),aF.laea=bY,aG=function(){function c(){c.__super__.constructor.apply(this,arguments)}b1(c,aB),c.prototype.project=function(D,C){var B,A,z,w,v,u,t,q,p,o,n;u=this.rad(C),w=this.rad(D),v=Math,t=v.sin,B=v.cos,z=0.5,A=2*z/(1+t(this.phi0)*t(u)+B(this.phi0)*B(u)*B(w-this.lam0)),p=this.r*A*B(u)*t(w-this.lam0),n=-this.r*A*(B(this.phi0)*t(u)-t(this.phi0)*B(u)*B(w-this.lam0)),q=this.r+p,o=this.r+n;return[q,o]};return c}(),aF.stereo=aG,aP=function(){function c(u){var t,q,p,o,n,l,k,a;c.__super__.constructor.call(this,{lon0:0,lat0:0}),this.dist=(l=u.dist)!=null?l:3,this.up=this.rad((k=u.up)!=null?k:0),this.tilt=this.rad((a=u.tilt)!=null?a:0),this.scale=1,o=Number.MAX_VALUE,p=Number.MAX_VALUE*-1;for(t=0;t<=179;t++){for(q=0;q<=360;q++){n=this.project(q-180,t-90),o=Math.min(n[0],o),p=Math.max(n[0],p)}}this.scale=this.r*2/(p-o),c.__super__.constructor.call(this,u);return}b1(c,aB),c.prototype.project=function(X,W,V){var U,T,S,R,Q,P,O,N,M,L,J,I,H,G,F,E,D,C,B,A,z;V==null&&(V=0),L=this.rad(W),N=this.rad(X),M=Math,H=M.sin,S=M.cos,J=this.r,I=J*(V+6371)/3671,R=H(this.phi0)*H(L)+S(this.phi0)*S(L)*S(N-this.lam0),O=(this.dist-1)/(this.dist-R),O=(this.dist-1)/(this.dist-R),O*=this.scale,D=I*O*S(L)*H(N-this.lam0),A=-I*O*(S(this.phi0)*H(L)-H(this.phi0)*S(L)*S(N-this.lam0)),P=S(this.up),F=H(this.up),Q=S(this.tilt),G=H(this.tilt),T=I*(this.dist-1),U=(A*P+D*F)*H(this.tilt/T)+Q,C=(D*P-A*F)*S(this.tilt/U),z=(A*P+D*F)/U,E=J+C,B=J+z;return[E,B]},c.prototype._visible=function(i,h){var n,l,k,j;k=this.to_elevation(h),n=this.to_azimuth(i),j=Math,l=j.sin(k)*j.sin(this.elevation0)+j.cos(this.elevation0)*j.cos(k)*j.cos(n-this.azimuth0);return l>=1/this.dist},c.prototype.sea=function(){var f,e,i,h;e=[],h=this.r,f=Math;for(i=0;i<=360;i++){e.push([h+f.cos(this.rad(i))*h,h+f.sin(this.rad(i))*h])}return e};return c}(),aF.satellite=aP,ah=function(){function c(){c.__super__.constructor.apply(this,arguments)}b1(c,aB),c.prototype.project=function(F,E){var D,C,B,A,z,w,v,u,t,q,p,o;v=this.rad(E),z=this.rad(F),w=Math,u=w.sin,C=w.cos,B=u(this.phi0)*u(v)+C(this.phi0)*C(v)*C(z-this.lam0),D=w.acos(B),A=0.325*D/u(D),q=this.r*A*C(v)*u(z-this.lam0),o=-this.r*A*(C(this.phi0)*u(v)-u(this.phi0)*C(v)*C(z-this.lam0)),t=this.r+q,p=this.r+o;return[t,p]},c.prototype._visible=function(e,d){return !0};return c}(),aF.equi=ah,aD=function(){function c(){c.__super__.constructor.apply(this,arguments)}b1(c,ah),c.prototype.project=function(e,d){return[x,y]},c.prototype._visible=function(e,d){return !0};return c}(),aF.aitoff=aD,ak=function(){function c(a){var i,h,f;i=this,c.__super__.constructor.call(this,a),i.lat1=(h=a.lat1)!=null?h:30,i.phi1=i.rad(i.lat1),i.lat2=(f=a.lat2)!=null?f:50,i.phi2=i.rad(i.lat2)}b1(c,a5),c.prototype._visible=function(e,d){return !0},c.prototype._truncate=function(e,d){return[e,d]},c.prototype.clon=function(d){d-=this.lon0,d<-180?d+=360:d>180&&(d-=360);return d};return c}(),bX=function(){function c(F){var E,D,C,B,A,z,w,v,u,t,q,p,a;u=this,c.__super__.constructor.call(this,F),A=Math,a=[A.sin,A.cos,A.abs,A.log,A.tan,A.pow],t=a[0],C=a[1],E=a[2],aS=a[3],p=a[4],w=a[5],u.n=z=q=t(u.phi1),B=C(u.phi1),v=E(u.phi1-u.phi2)>=1e-10,v&&(z=aS(B/C(u.phi2))/aS(p(u.QUARTERPI+0.5*u.phi2)/p(u.QUARTERPI+0.5*u.phi1))),u.c=D=B*w(p(u.QUARTERPI+0.5*u.phi1),z)/z,E(E(u.phi0)-u.HALFPI)<1e-10?u.rho0=0:u.rho0=D*w(p(u.QUARTERPI+0.5*u.phi0),-z),u.minLat=-60,u.maxLat=85}b1(c,ak),"Lambert Conformal Conic Projection (spherical)",c.prototype.project=function(M,L){var J,I,H,G,F,E,D,C,B,A,z,w,v,u,t;A=this,D=A.rad(L),H=A.rad(A.clon(M)),F=Math,t=[F.sin,F.cos,F.abs,F.log,F.tan,F.pow],z=t[0],I=t[1],J=t[2],aS=t[3],w=t[4],C=t[5],E=A.n,J(J(D)-A.HALFPI)<1e-10?B=0:B=A.c*C(w(A.QUARTERPI+0.5*D),-E),G=H*E,v=1000*B*z(G),u=1000*A.rho0-B*I(G);return[v,u*-1]};return c}(),aF.lcc=bX,a3=function(){function c(){c.__super__.constructor.apply(this,arguments)}b1(c,ak);return c}(),a2=function(){function c(i,h,o,n,l,k){var j;j=this,j.bbox=i,j.width=h,j.padding=n!=null?n:0,j.halign=l!=null?l:"center",j.valign=k!=null?k:"center",j.height=o,j.scale=Math.min((h-n*2)/i.width,(o-n*2)/i.height)}c.prototype.project=function(u,t){var q,p,o,n,l,k,j;t==null&&(t=u[1],u=u[0]),o=this,n=o.scale,q=o.bbox,p=o.height,l=o.width,k=o.halign==="center"?(l-q.width*n)*0.5:o.halign==="left"?o.padding*n:l-(q.width-o.padding)*n,j=o.valign==="center"?(p-q.height*n)*0.5:o.valign==="top"?o.padding*n:0,u=(u-q.left)*n+k,t=(t-q.top)*n+j;return[u,t]},c.prototype.projectPath=function(J){var I,H,G,F,E,D,C,B,A,z,w,v,u,t,q;G=this;if(J.type==="path"){H=[],v=J.contours;for(B=0,z=v.length;B<z;B++){F=v[B],I=[];for(A=0,w=F.length;A<w;A++){u=F[A],D=u[0],C=u[1],t=G.project(D,C),D=t[0],C=t[1],I.push([D,C])}H.push(I)}return new aU.geom.Path(J.type,H,J.closed)}if(J.type==="circle"){q=G.project(J.x,J.y),D=q[0],C=q[1],E=J.r*G.scale;return new aU.geom.Circle(D,C,E)}},c.prototype.asBBox=function(){var d;d=this;return new aU.BBox(0,0,d.width,d.height)};return c}(),a2.fromXML=function(h){var c,l,k,j,i;i=Number(h.getAttribute("w")),k=Number(h.getAttribute("h")),j=Number(h.getAttribute("padding")),l=h.getElementsByTagName("bbox")[0],c=az.fromXML(l);return new aU.View(c,i,k,j)},aJ=typeof exports!="undefined"&&exports!==null?exports:this,(cb=aJ.kartograph)==null&&(aJ.kartograph={}),aJ.kartograph.View=a2}).call(this);(function(){var B=this;var w=B._;var c={};var k=Array.prototype,I=Object.prototype,M=Function.prototype;var z=k.slice,D=k.unshift,C=I.toString,t=I.hasOwnProperty;var p=k.forEach,j=k.map,G=k.reduce,f=k.reduceRight,o=k.filter,a=k.every,F=k.some,A=k.indexOf,h=k.lastIndexOf,d=Array.isArray,H=Object.keys,l=M.bind;var L=function(N){return new i(N)};if(typeof module!=="undefined"&&module.exports){module.exports=L;L._=L}else{B._=L}L.VERSION="1.2.0";var e=L.each=L.forEach=function(S,R,Q){if(S==null){return}if(p&&S.forEach===p){S.forEach(R,Q)}else{if(S.length===+S.length){for(var P=0,N=S.length;P<N;P++){if(P in S&&R.call(Q,S[P],P,S)===c){return}}}else{for(var O in S){if(t.call(S,O)){if(R.call(Q,S[O],O,S)===c){return}}}}}};L.map=function(Q,P,O){var N=[];if(Q==null){return N}if(j&&Q.map===j){return Q.map(P,O)}e(Q,function(T,R,S){N[N.length]=P.call(O,T,R,S)});return N};L.reduce=L.foldl=L.inject=function(R,Q,N,P){var O=N!==void 0;if(R==null){R=[]}if(G&&R.reduce===G){if(P){Q=L.bind(Q,P)}return O?R.reduce(Q,N):R.reduce(Q)}e(R,function(U,S,T){if(!O){N=U;O=true}else{N=Q.call(P,N,U,S,T)}});if(!O){throw new TypeError("Reduce of empty array with no initial value")}return N};L.reduceRight=L.foldr=function(Q,P,N,O){if(Q==null){Q=[]}if(f&&Q.reduceRight===f){if(O){P=L.bind(P,O)}return N!==void 0?Q.reduceRight(P,N):Q.reduceRight(P)}var R=(L.isArray(Q)?Q.slice():L.toArray(Q)).reverse();return L.reduce(R,P,N,O)};L.find=L.detect=function(Q,P,O){var N;u(Q,function(T,R,S){if(P.call(O,T,R,S)){N=T;return true}});return N};L.filter=L.select=function(Q,P,O){var N=[];if(Q==null){return N}if(o&&Q.filter===o){return Q.filter(P,O)}e(Q,function(T,R,S){if(P.call(O,T,R,S)){N[N.length]=T}});return N};L.reject=function(Q,P,O){var N=[];if(Q==null){return N}e(Q,function(T,R,S){if(!P.call(O,T,R,S)){N[N.length]=T}});return N};L.every=L.all=function(Q,P,O){var N=true;if(Q==null){return N}if(a&&Q.every===a){return Q.every(P,O)}e(Q,function(T,R,S){if(!(N=N&&P.call(O,T,R,S))){return c}});return N};var u=L.some=L.any=function(Q,P,O){P=P||L.identity;var N=false;if(Q==null){return N}if(F&&Q.some===F){return Q.some(P,O)}e(Q,function(T,R,S){if(N|=P.call(O,T,R,S)){return c}});return !!N};L.include=L.contains=function(P,O){var N=false;if(P==null){return N}if(A&&P.indexOf===A){return P.indexOf(O)!=-1}u(P,function(Q){if(N=Q===O){return true}});return N};L.invoke=function(O,P){var N=z.call(arguments,2);return L.map(O,function(Q){return(P.call?P||Q:Q[P]).apply(Q,N)})};L.pluck=function(O,N){return L.map(O,function(P){return P[N]})};L.max=function(Q,P,O){if(!P&&L.isArray(Q)){return Math.max.apply(Math,Q)}if(!P&&L.isEmpty(Q)){return -Infinity}var N={computed:-Infinity};e(Q,function(U,R,T){var S=P?P.call(O,U,R,T):U;S>=N.computed&&(N={value:U,computed:S})});return N.value};L.min=function(Q,P,O){if(!P&&L.isArray(Q)){return Math.min.apply(Math,Q)}if(!P&&L.isEmpty(Q)){return Infinity}var N={computed:Infinity};e(Q,function(U,R,T){var S=P?P.call(O,U,R,T):U;S<N.computed&&(N={value:U,computed:S})});return N.value};L.shuffle=function(P){var N=[],O;e(P,function(S,Q,R){if(Q==0){N[0]=S}else{O=Math.floor(Math.random()*(Q+1));N[Q]=N[O];N[O]=S}});return N};L.sortBy=function(P,O,N){return L.pluck(L.map(P,function(S,Q,R){return{value:S,criteria:O.call(N,S,Q,R)}}).sort(function(T,S){var R=T.criteria,Q=S.criteria;return R<Q?-1:R>Q?1:0}),"value")};L.groupBy=function(P,O){var N={};e(P,function(S,Q){var R=O(S,Q);(N[R]||(N[R]=[])).push(S)});return N};L.sortedIndex=function(S,R,P){P||(P=L.identity);var N=0,Q=S.length;while(N<Q){var O=(N+Q)>>1;P(S[O])<P(R)?N=O+1:Q=O}return N};L.toArray=function(N){if(!N){return[]}if(N.toArray){return N.toArray()}if(L.isArray(N)){return z.call(N)}if(L.isArguments(N)){return z.call(N)}return L.values(N)};L.size=function(N){return L.toArray(N).length};L.first=L.head=function(P,O,N){return(O!=null)&&!N?z.call(P,0,O):P[0]};L.initial=function(P,O,N){return z.call(P,0,P.length-((O==null)||N?1:O))};L.last=function(P,O,N){return(O!=null)&&!N?z.call(P,P.length-O):P[P.length-1]};L.rest=L.tail=function(P,N,O){return z.call(P,(N==null)||O?1:N)};L.compact=function(N){return L.filter(N,function(O){return !!O})};L.flatten=function(N){return L.reduce(N,function(O,P){if(L.isArray(P)){return O.concat(L.flatten(P))}O[O.length]=P;return O},[])};L.without=function(N){return L.difference(N,z.call(arguments,1))};L.uniq=L.unique=function(R,Q,P){var O=P?L.map(R,P):R;var N=[];L.reduce(O,function(S,U,T){if(0==T||(Q===true?L.last(S)!=U:!L.include(S,U))){S[S.length]=U;N[N.length]=R[T]}return S},[]);return N};L.union=function(){return L.uniq(L.flatten(arguments))};L.intersection=L.intersect=function(O){var N=z.call(arguments,1);return L.filter(L.uniq(O),function(P){return L.every(N,function(Q){return L.indexOf(Q,P)>=0})})};L.difference=function(O,N){return L.filter(O,function(P){return !L.include(N,P)})};L.zip=function(){var N=z.call(arguments);var Q=L.max(L.pluck(N,"length"));var P=new Array(Q);for(var O=0;O<Q;O++){P[O]=L.pluck(N,""+O)}return P};L.indexOf=function(R,P,Q){if(R==null){return -1}var O,N;if(Q){O=L.sortedIndex(R,P);return R[O]===P?O:-1}if(A&&R.indexOf===A){return R.indexOf(P)}for(O=0,N=R.length;O<N;O++){if(R[O]===P){return O}}return -1};L.lastIndexOf=function(P,O){if(P==null){return -1}if(h&&P.lastIndexOf===h){return P.lastIndexOf(O)}var N=P.length;while(N--){if(P[N]===O){return N}}return -1};L.range=function(S,Q,R){if(arguments.length<=1){Q=S||0;S=0}R=arguments[2]||1;var O=Math.max(Math.ceil((Q-S)/R),0);var N=0;var P=new Array(O);while(N<O){P[N++]=S;S+=R}return P};L.bind=function(O,P){if(O.bind===l&&l){return l.apply(O,z.call(arguments,1))}var N=z.call(arguments,2);return function(){return O.apply(P,N.concat(z.call(arguments)))}};L.bindAll=function(O){var N=z.call(arguments,1);if(N.length==0){N=L.functions(O)}e(N,function(P){O[P]=L.bind(O[P],O)});return O};L.memoize=function(P,O){var N={};O||(O=L.identity);return function(){var Q=O.apply(this,arguments);return t.call(N,Q)?N[Q]:(N[Q]=P.apply(this,arguments))}};L.delay=function(O,P){var N=z.call(arguments,2);return setTimeout(function(){return O.apply(O,N)},P)};L.defer=function(N){return L.delay.apply(L,[N,1].concat(z.call(arguments,1)))};var E=function(O,Q,N){var P;return function(){var S=this,R=arguments;var T=function(){P=null;O.apply(S,R)};if(N){clearTimeout(P)}if(N||!P){P=setTimeout(T,Q)}}};L.throttle=function(N,O){return E(N,O,false)};L.debounce=function(N,O){return E(N,O,true)};L.once=function(P){var N=false,O;return function(){if(N){return O}N=true;return O=P.apply(this,arguments)}};L.wrap=function(N,O){return function(){var P=[N].concat(z.call(arguments));return O.apply(this,P)}};L.compose=function(){var N=z.call(arguments);return function(){var O=z.call(arguments);for(var P=N.length-1;P>=0;P--){O=[N[P].apply(this,O)]}return O[0]}};L.after=function(O,N){return function(){if(--O<1){return N.apply(this,arguments)}}};L.keys=H||function(P){if(P!==Object(P)){throw new TypeError("Invalid object")}var O=[];for(var N in P){if(t.call(P,N)){O[O.length]=N}}return O};L.values=function(N){return L.map(N,L.identity)};L.functions=L.methods=function(P){var O=[];for(var N in P){if(L.isFunction(P[N])){O.push(N)}}return O.sort()};L.extend=function(N){e(z.call(arguments,1),function(O){for(var P in O){if(O[P]!==void 0){N[P]=O[P]}}});return N};L.defaults=function(N){e(z.call(arguments,1),function(O){for(var P in O){if(N[P]==null){N[P]=O[P]}}});return N};L.clone=function(N){return L.isArray(N)?N.slice():L.extend({},N)};L.tap=function(O,N){N(O);return O};function J(ac,aa,Q){if(ac===aa){return ac!==0||1/ac==1/aa}if(ac==null){return ac===aa}var W=typeof ac;if(W!=typeof aa){return false}if(!ac!=!aa){return false}if(L.isNaN(ac)){return L.isNaN(aa)}var Z=L.isString(ac),Y=L.isString(aa);if(Z||Y){return Z&&Y&&String(ac)==String(aa)}var ad=L.isNumber(ac),ab=L.isNumber(aa);if(ad||ab){return ad&&ab&&+ac==+aa}var O=L.isBoolean(ac),N=L.isBoolean(aa);if(O||N){return O&&N&&+ac==+aa}var U=L.isDate(ac),T=L.isDate(aa);if(U||T){return U&&T&&ac.getTime()==aa.getTime()}var S=L.isRegExp(ac),R=L.isRegExp(aa);if(S||R){return S&&R&&ac.source==aa.source&&ac.global==aa.global&&ac.multiline==aa.multiline&&ac.ignoreCase==aa.ignoreCase}if(W!="object"){return false}if(ac._chain){ac=ac._wrapped}if(aa._chain){aa=aa._wrapped}if(L.isFunction(ac.isEqual)){return ac.isEqual(aa)}var P=Q.length;while(P--){if(Q[P]==ac){return true}}Q.push(ac);var X=0,V=true;if(ac.length===+ac.length||aa.length===+aa.length){X=ac.length;V=X==aa.length;if(V){while(X--){if(!(V=X in ac==X in aa&&J(ac[X],aa[X],Q))){break}}}}else{for(var ae in ac){if(t.call(ac,ae)){X++;if(!(V=t.call(aa,ae)&&J(ac[ae],aa[ae],Q))){break}}}if(V){for(ae in aa){if(t.call(aa,ae)&&!X--){break}}V=!X}}Q.pop();return V}L.isEqual=function(O,N){return J(O,N,[])};L.isEmpty=function(O){if(L.isArray(O)||L.isString(O)){return O.length===0}for(var N in O){if(t.call(O,N)){return false}}return true};L.isElement=function(N){return !!(N&&N.nodeType==1)};L.isArray=d||function(N){return C.call(N)==="[object Array]"};L.isObject=function(N){return N===Object(N)};L.isArguments=function(N){return !!(N&&t.call(N,"callee"))};L.isFunction=function(N){return !!(N&&N.constructor&&N.call&&N.apply)};L.isString=function(N){return !!(N===""||(N&&N.charCodeAt&&N.substr))};L.isNumber=function(N){return !!(N===0||(N&&N.toExponential&&N.toFixed))};L.isNaN=function(N){return N!==N};L.isBoolean=function(N){return N===true||N===false||C.call(N)=="[object Boolean]"};L.isDate=function(N){return !!(N&&N.getTimezoneOffset&&N.setUTCFullYear)};L.isRegExp=function(N){return !!(N&&N.test&&N.exec&&(N.ignoreCase||N.ignoreCase===false))};L.isNull=function(N){return N===null};L.isUndefined=function(N){return N===void 0};L.noConflict=function(){B._=w;return this};L.identity=function(N){return N};L.times=function(Q,P,O){for(var N=0;N<Q;N++){P.call(O,N)}};L.escape=function(N){return(""+N).replace(/&(?!\w+;|#\d+;|#x[\da-f]+;)/gi,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#x27;").replace(/\//g,"&#x2F;")};L.mixin=function(N){e(L.functions(N),function(O){v(O,L[O]=N[O])})};var n=0;L.uniqueId=function(N){var O=n++;return N?N+O:O};L.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};L.template=function(Q,P){var R=L.templateSettings;var N="var __p=[],print=function(){__p.push.apply(__p,arguments);};with(obj||{}){__p.push('"+Q.replace(/\\/g,"\\\\").replace(/'/g,"\\'").replace(R.escape,function(S,T){return"',_.escape("+T.replace(/\\'/g,"'")+"),'"}).replace(R.interpolate,function(S,T){return"',"+T.replace(/\\'/g,"'")+",'"}).replace(R.evaluate||null,function(S,T){return"');"+T.replace(/\\'/g,"'").replace(/[\r\n\t]/g," ")+"__p.push('"}).replace(/\r/g,"\\r").replace(/\n/g,"\\n").replace(/\t/g,"\\t")+"');}return __p.join('');";var O=new Function("obj",N);return P?O(P):O};var i=function(N){this._wrapped=N};L.prototype=i.prototype;var q=function(O,N){return N?L(O).chain():O};var v=function(N,O){i.prototype[N]=function(){var P=z.call(arguments);D.call(P,this._wrapped);return q(O.apply(L,P),this._chain)}};L.mixin(L);e(["pop","push","reverse","shift","sort","splice","unshift"],function(N){var O=k[N];i.prototype[N]=function(){O.apply(this._wrapped,arguments);return q(this._wrapped,this._chain)}});e(["concat","join","slice"],function(N){var O=k[N];i.prototype[N]=function(){return q(O.apply(this._wrapped,arguments),this._chain)}});i.prototype.chain=function(){this._chain=true;return this};i.prototype.value=function(){return this._wrapped}})();
/*!
 * accounting.js v0.3.2
 * Copyright 2011, Joss Crowcroft
 *
 * Freely distributable under the MIT license.
 * Portions of accounting.js are inspired or borrowed from underscore.js
 *
 * Full details and documentation:
 * http://josscrowcroft.github.com/accounting.js/
 */
(function(t,i){var q={};q.version="0.3.2";q.settings={currency:{symbol:"$",format:"%s%v",decimal:".",thousand:",",precision:2,grouping:3},number:{precision:0,grouping:3,thousand:",",decimal:"."}};var u=Array.prototype.map,l=Array.isArray,h=Object.prototype.toString;function d(w){return !!(w===""||(w&&w.charCodeAt&&w.substr))}function n(w){return l?l(w):h.call(w)==="[object Array]"}function v(w){return h.call(w)==="[object Object]"}function j(z,w){var A;z=z||{};w=w||{};for(A in w){if(w.hasOwnProperty(A)){if(z[A]==null){z[A]=w[A]}}}return z}function a(D,C,B){var A=[],z,w;if(!D){return A}if(u&&D.map===u){return D.map(C,B)}for(z=0,w=D.length;z<w;z++){A[z]=C.call(B,D[z],z,D)}return A}function o(z,w){z=Math.round(Math.abs(z));return isNaN(z)?w:z}function f(z){var w=q.settings.currency.format;if(typeof z==="function"){z=z()}if(d(z)&&z.match("%v")){return{pos:z,neg:z.replace("-","").replace("%v","-%v"),zero:z}}else{if(!z||!z.pos||!z.pos.match("%v")){return(!d(w))?w:q.settings.currency.format={pos:w,neg:w.replace("%v","-%v"),zero:w}}}return z}var k=q.unformat=q.parse=function(B,w){if(n(B)){return a(B,function(C){return k(C,w)})}B=B||0;if(typeof B==="number"){return B}w=w||".";var A=new RegExp("[^0-9-"+w+"]",["g"]),z=parseFloat((""+B).replace(/\((.*)\)/,"-$1").replace(A,"").replace(w,"."));return !isNaN(z)?z:0};var c=q.toFixed=function(A,w){w=o(w,q.settings.number.precision);var z=Math.pow(10,w);return(Math.round(q.unformat(A)*z)/z).toFixed(w)};var e=q.formatNumber=function(A,D,G,C){if(n(A)){return a(A,function(H){return e(H,D,G,C)})}A=k(A);var w=j((v(D)?D:{precision:D,thousand:G,decimal:C}),q.settings.number),E=o(w.precision),B=A<0?"-":"",z=parseInt(c(Math.abs(A||0),E),10)+"",F=z.length>3?z.length%3:0;return B+(F?z.substr(0,F)+w.thousand:"")+z.substr(F).replace(/(\d{3})(?=\d)/g,"$1"+w.thousand)+(E?w.decimal+c(Math.abs(A),E).split(".")[1]:"")};var p=q.formatMoney=function(A,z,C,G,B,F){if(n(A)){return a(A,function(H){return p(H,z,C,G,B,F)})}A=k(A);var w=j((v(z)?z:{symbol:z,precision:C,thousand:G,decimal:B,format:F}),q.settings.currency),E=f(w.format),D=A>0?E.pos:A<0?E.neg:E.zero;return D.replace("%s",w.symbol).replace("%v",e(Math.abs(A),o(w.precision),w.thousand,w.decimal))};q.formatColumn=function(F,A,D,I,C,H){if(!F){return[]}var w=j((v(A)?A:{symbol:A,precision:D,thousand:I,decimal:C,format:H}),q.settings.currency),G=f(w.format),E=G.pos.indexOf("%s")<G.pos.indexOf("%v")?true:false,z=0,B=a(F,function(N,L){if(n(N)){return q.formatColumn(N,w)}else{N=k(N);var J=N>0?G.pos:N<0?G.neg:G.zero,M=J.replace("%s",w.symbol).replace("%v",e(Math.abs(N),o(w.precision),w.thousand,w.decimal));if(M.length>z){z=M.length}return M}});return a(B,function(L,J){if(d(L)&&L.length<z){return E?L.replace(w.symbol,w.symbol+(new Array(z-L.length+1).join(" "))):(new Array(z-L.length+1).join(" "))+L}return L})};if(typeof exports!=="undefined"){if(typeof module!=="undefined"&&module.exports){exports=module.exports=q}exports.accounting=q}else{if(typeof define==="function"&&define.amd){define([],function(){return q})}else{q.noConflict=(function(w){return function(){t.accounting=w;q.noConflict=i;return q}})(t.accounting);t.accounting=q}}}(this));(function(){window.$jit=function(D){D=D||window;for(var E in $jit){if($jit[E].$extend){D[E]=$jit[E]}}};$jit.version="2.0.0a";var d=function(D){return document.getElementById(D)};d.empty=function(){};d.extend=function(F,D){for(var E in (D||{})){F[E]=D[E]}return F};d.lambda=function(D){return(typeof D=="function")?D:function(){return D}};d.time=Date.now||function(){return +new Date};d.splat=function(E){var D=d.type(E);return D?((D!="array")?[E]:E):[]};d.type=function(E){var D=d.type.s.call(E).match(/^\[object\s(.*)\]$/)[1].toLowerCase();if(D!="object"){return D}if(E&&E.$$family){return E.$$family}return(E&&E.nodeName&&E.nodeType==1)?"element":D};d.type.s=Object.prototype.toString;d.each=function(I,H){var G=d.type(I);if(G=="object"){for(var F in I){H(I[F],F)}}else{for(var E=0,D=I.length;E<D;E++){H(I[E],E)}}};d.indexOf=function(G,F){if(Array.indexOf){return G.indexOf(F)}for(var E=0,D=G.length;E<D;E++){if(G[E]===F){return E}}return -1};d.map=function(F,E){var D=[];d.each(F,function(H,G){D.push(E(H,G))});return D};d.reduce=function(H,F,E){var D=H.length;if(D==0){return E}var G=arguments.length==3?E:H[--D];while(D--){G=F(G,H[D])}return G};d.merge=function(){var H={};for(var G=0,D=arguments.length;G<D;G++){var E=arguments[G];if(d.type(E)!="object"){continue}for(var F in E){var J=E[F],I=H[F];H[F]=(I&&d.type(J)=="object"&&d.type(I)=="object")?d.merge(I,J):d.unlink(J)}}return H};d.unlink=function(F){var E;switch(d.type(F)){case"object":E={};for(var H in F){E[H]=d.unlink(F[H])}break;case"array":E=[];for(var G=0,D=F.length;G<D;G++){E[G]=d.unlink(F[G])}break;default:return F}return E};d.zip=function(){if(arguments.length===0){return[]}for(var F=0,E=[],D=arguments.length,I=arguments[0].length;F<I;F++){for(var G=0,H=[];G<D;G++){H.push(arguments[G][F])}E.push(H)}return E};d.rgbToHex=function(H,G){if(H.length<3){return null}if(H.length==4&&H[3]==0&&!G){return"transparent"}var E=[];for(var D=0;D<3;D++){var F=(H[D]-0).toString(16);E.push(F.length==1?"0"+F:F)}return G?E:"#"+E.join("")};d.hexToRgb=function(F){if(F.length!=7){F=F.match(/^#?(\w{1,2})(\w{1,2})(\w{1,2})$/);F.shift();if(F.length!=3){return null}var D=[];for(var E=0;E<3;E++){var G=F[E];if(G.length==1){G+=G}D.push(parseInt(G,16))}return D}else{F=parseInt(F.slice(1),16);return[F>>16,F>>8&255,F&255]}};d.rgbToHsl=function(F){r=F[0]/255,g=F[1]/255,b=F[2]/255;var D=Math.max(r,g,b),G=Math.min(r,g,b);var I,H,E=(D+G)/2;if(D==G){I=H=0}else{var J=D-G;H=E>0.5?J/(2-D-G):J/(D+G);switch(D){case r:I=(g-b)/J+(g<b?6:0);break;case g:I=(b-r)/J+2;break;case b:I=(r-g)/J+4;break}I/=6}return[Math.round(I*360),Math.round(H*100),Math.round(E*100)]};d.hslToRgb=function(H){var J=H[0]/360,N=H[1]/100,I=H[2]/100;var D,L,M;if(N==0){D=L=M=I}else{function G(Q,P,O){if(O<0){O+=1}if(O>1){O-=1}if(O<1/6){return Q+(P-Q)*6*O}if(O<1/2){return P}if(O<2/3){return Q+(P-Q)*(2/3-O)*6}return Q}var E=I<0.5?I*(1+N):I+N-I*N;var F=2*I-E;D=G(F,E,J+1/3);L=G(F,E,J);M=G(F,E,J-1/3)}return[Math.round(D*255),Math.round(L*255),Math.round(M*255)]};d.hslToHex=function(D){return d.rgbToHex(d.hslToRgb(D))};d.rgbToHsv=function(F){r=F[0]/255,g=F[1]/255,b=F[2]/255;var D=Math.max(r,g,b),G=Math.min(r,g,b);var I,H,E=D;var J=D-G;H=D==0?0:J/D;if(D==G){I=0}else{switch(D){case r:I=(g-b)/J+(g<b?6:0);break;case g:I=(b-r)/J+2;break;case b:I=(r-g)/J+4;break}I/=6}return[Math.round(I*360),Math.round(H*100),Math.round(E*100)]};d.hsvToRgb=function(G){var I=G[0]/360,P=G[1]/100,N=G[2]/100;var D,J,M;var H=Math.floor(I*6);var L=I*6-H;var F=N*(1-P);var E=N*(1-L*P);var O=N*(1-(1-L)*P);switch(H%6){case 0:D=N,J=O,M=F;break;case 1:D=E,J=N,M=F;break;case 2:D=F,J=N,M=O;break;case 3:D=F,J=E,M=N;break;case 4:D=O,J=F,M=N;break;case 5:D=N,J=F,M=E;break}return[Math.round(D*255),Math.round(J*255),Math.round(M*255)]};d.hsvToHex=function(D){return d.rgbToHex(d.hsvToRgb(D))};d.destroy=function(D){d.clean(D);if(D.parentNode){D.parentNode.removeChild(D)}if(D.clearAttributes){D.clearAttributes()}};d.clean=function(G){for(var F=G.childNodes,E=0,D=F.length;E<D;E++){d.destroy(F[E])}};d.addEvent=function(F,E,D){if(F.addEventListener){F.addEventListener(E,D,false)}else{F.attachEvent("on"+E,D)}};d.addEvents=function(E,F){for(var D in F){d.addEvent(E,D,F[D])}};d.hasClass=function(E,D){return(" "+E.className+" ").indexOf(" "+D+" ")>-1};d.addClass=function(E,D){if(!d.hasClass(E,D)){E.className=(E.className+" "+D)}};d.removeClass=function(E,D){E.className=E.className.replace(new RegExp("(^|\\s)"+D+"(?:\\s|$)"),"$1")};d.getPos=function(F){var I=H(F);var D=G(F);return{x:I.x-D.x,y:I.y-D.y};function H(L){var J={x:0,y:0};while(L&&!E(L)){J.x+=L.offsetLeft;J.y+=L.offsetTop;L=L.offsetParent}return J}function G(L){var J={x:0,y:0};while(L&&!E(L)){J.x+=L.scrollLeft;J.y+=L.scrollTop;L=L.parentNode}return J}function E(J){return(/^(?:body|html)$/i).test(J.tagName)}};d.event={get:function(E,D){D=D||window;return E||D.event},getWheel:function(D){return D.wheelDelta?D.wheelDelta/120:-(D.detail||0)/3},isRightClick:function(D){return(D.which==3||D.button==2)},getPos:function(G,F){F=F||window;G=G||F.event;var E=F.document;E=E.documentElement||E.body;if(G.touches&&G.touches.length){G=G.touches[0]}var D={x:G.pageX||(G.clientX+E.scrollLeft),y:G.pageY||(G.clientY+E.scrollTop)};return D},stop:function(D){if(D.stopPropagation){D.stopPropagation()}D.cancelBubble=true;if(D.preventDefault){D.preventDefault()}else{D.returnValue=false}}};$jit.util=$jit.id=d;var v=function(E){E=E||{};var D=function(){for(var H in this){if(typeof this[H]!="function"){this[H]=d.unlink(this[H])}}this.constructor=D;if(v.prototyping){return this}var G=this.initialize?this.initialize.apply(this,arguments):this;this.$$family="class";return G};for(var F in v.Mutators){if(!E[F]){continue}E=v.Mutators[F](E,E[F]);delete E[F]}d.extend(D,this);D.constructor=v;D.prototype=E;return D};v.Mutators={Implements:function(D,E){d.each(d.splat(E),function(G){v.prototyping=G;var F=(typeof G=="function")?new G:G;for(var H in F){if(!(H in D)){D[H]=F[H]}}delete v.prototyping});return D}};d.extend(v,{inherit:function(D,G){for(var F in G){var E=G[F];var I=D[F];var H=d.type(E);if(I&&H=="function"){if(E!=I){v.override(D,F,E)}}else{if(H=="object"){D[F]=d.merge(I,E)}else{D[F]=E}}}return D},override:function(E,D,H){var G=v.prototyping;if(G&&E[D]!=G[D]){G=null}var F=function(){var I=this.parent;this.parent=G?G[D]:E[D];var J=H.apply(this,arguments);this.parent=I;return J};E[D]=F}});v.prototype.implement=function(){var D=this.prototype;d.each(Array.prototype.slice.call(arguments||[]),function(E){v.inherit(D,E)});return this};$jit.Class=v;$jit.json={prune:function(E,D){this.each(E,function(G,F){if(F==D&&G.children){delete G.children;G.children=[]}})},getParent:function(D,H){if(D.id==H){return false}var G=D.children;if(G&&G.length>0){for(var F=0;F<G.length;F++){if(G[F].id==H){return D}else{var E=this.getParent(G[F],H);if(E){return E}}}}return false},getSubtree:function(D,H){if(D.id==H){return D}for(var F=0,G=D.children;F<G.length;F++){var E=this.getSubtree(G[F],H);if(E!=null){return E}}return null},eachLevel:function(D,I,F,H){if(I<=F){H(D,I);if(!D.children){return}for(var E=0,G=D.children;E<G.length;E++){this.eachLevel(G[E],I+1,F,H)}}},each:function(D,E){this.eachLevel(D,0,Number.MAX_VALUE,E)}};$jit.Trans={$extend:true,linear:function(D){return D}};var k=$jit.Trans;(function(){var D=function(G,F){F=d.splat(F);return d.extend(G,{easeIn:function(H){return G(H,F)},easeOut:function(H){return 1-G(1-H,F)},easeInOut:function(H){return(H<=0.5)?G(2*H,F)/2:(2-G(2*(1-H),F))/2}})};var E={Pow:function(G,F){return Math.pow(G,F[0]||6)},Expo:function(F){return Math.pow(2,8*(F-1))},Circ:function(F){return 1-Math.sin(Math.acos(F))},Sine:function(F){return 1-Math.sin((1-F)*Math.PI/2)},Back:function(G,F){F=F[0]||1.618;return Math.pow(G,2)*((F+1)*G-F)},Bounce:function(I){var H;for(var G=0,F=1;1;G+=F,F/=2){if(I>=(7-4*G)/11){H=F*F-Math.pow((11-6*G-11*I)/4,2);break}}return H},Elastic:function(G,F){return Math.pow(2,10*--G)*Math.cos(20*G*Math.PI*(F[0]||1)/3)}};d.each(E,function(G,F){k[F]=D(G)});d.each(["Quad","Cubic","Quart","Quint"],function(G,F){k[G]=D(function(H){return Math.pow(H,[F+2])})})})();var B=new v({initialize:function(D){this.setOptions(D)},setOptions:function(D){var E={duration:2500,fps:40,transition:k.Quart.easeInOut,compute:d.empty,complete:d.empty,link:"ignore"};this.opt=d.merge(E,D||{});return this},step:function(){var E=d.time(),D=this.opt;if(E<this.time+D.duration){var F=D.transition((E-this.time)/D.duration);D.compute(F)}else{this.timer=clearInterval(this.timer);D.compute(1);D.complete()}},start:function(){if(!this.check()){return this}this.time=0;this.startTimer();return this},startTimer:function(){var D=this,E=this.opt.fps;if(this.timer){return false}this.time=d.time()-this.time;this.timer=setInterval((function(){D.step()}),Math.round(1000/E));return true},pause:function(){this.stopTimer();return this},resume:function(){this.startTimer();return this},stopTimer:function(){if(!this.timer){return false}this.time=d.time()-this.time;this.timer=clearInterval(this.timer);return true},check:function(){if(!this.timer){return true}if(this.opt.link=="cancel"){this.stopTimer();return true}return false}});var q=function(){var F=arguments;for(var H=0,D=F.length,E={};H<D;H++){var G=q[F[H]];if(G.$extend){d.extend(E,G)}else{E[F[H]]=G}}return E};q.AreaChart={$extend:true,animate:true,offset:25,labelOffset:3,type:"stacked",Tips:{enable:false,onShow:d.empty,onHide:d.empty},Events:{enable:false,onClick:d.empty},selectOnHover:true,showAggregates:true,showLabels:true,filterOnClick:false,restoreOnRightClick:false};q.Canvas={$extend:true,injectInto:"id",width:false,height:false,useCanvas:false,withLabels:true,background:false};q.Tree={$extend:true,orientation:"left",subtreeOffset:8,siblingOffset:5,indent:10,multitree:false,align:"center"};q.Node={$extend:false,overridable:false,type:"circle",color:"#ccb",alpha:1,dim:3,height:20,width:90,autoHeight:false,autoWidth:false,lineWidth:1,transform:true,align:"center",angularWidth:1,span:1,CanvasStyles:{}};q.Edge={$extend:false,overridable:false,type:"line",color:"#ccb",lineWidth:1,dim:15,alpha:1,CanvasStyles:{}};q.Fx={$extend:true,fps:40,duration:2500,transition:$jit.Trans.Quart.easeInOut,clearCanvas:true};q.Label={$extend:false,overridable:false,type:"HTML",style:" ",size:10,family:"sans-serif",textAlign:"center",textBaseline:"alphabetic",color:"#fff"};q.Tips={$extend:false,enable:false,type:"auto",offsetX:20,offsetY:20,force:false,onShow:d.empty,onHide:d.empty};q.NodeStyles={$extend:false,enable:false,type:"auto",stylesHover:false,stylesClick:false};q.Events={$extend:false,enable:false,type:"auto",onClick:d.empty,onRightClick:d.empty,onMouseMove:d.empty,onMouseEnter:d.empty,onMouseLeave:d.empty,onDragStart:d.empty,onDragMove:d.empty,onDragCancel:d.empty,onDragEnd:d.empty,onTouchStart:d.empty,onTouchMove:d.empty,onTouchEnd:d.empty,onMouseWheel:d.empty};q.Navigation={$extend:false,enable:false,type:"auto",panning:false,zooming:false};q.Controller={$extend:true,onBeforeCompute:d.empty,onAfterCompute:d.empty,onCreateLabel:d.empty,onPlaceLabel:d.empty,onComplete:d.empty,onBeforePlotLine:d.empty,onAfterPlotLine:d.empty,onBeforePlotNode:d.empty,onAfterPlotNode:d.empty,request:false};var A={initialize:function(F,D){this.viz=D;this.canvas=D.canvas;this.config=D.config[F];this.nodeTypes=D.fx.nodeTypes;var E=this.config.type;this.dom=E=="auto"?(D.config.Label.type!="Native"):(E!="Native");this.labelContainer=this.dom&&D.labels.getLabelContainer();this.isEnabled()&&this.initializePost()},initializePost:d.empty,setAsProperty:d.lambda(false),isEnabled:function(){return this.config.enable},isLabel:function(G,F){G=d.event.get(G,F);var D=this.labelContainer,E=G.target||G.srcElement;if(E&&E.parentNode==D){return E}return false}};var j={onMouseUp:d.empty,onMouseDown:d.empty,onMouseMove:d.empty,onMouseOver:d.empty,onMouseOut:d.empty,onMouseWheel:d.empty,onTouchStart:d.empty,onTouchMove:d.empty,onTouchEnd:d.empty,onTouchCancel:d.empty};var z=new v({initialize:function(D){this.viz=D;this.canvas=D.canvas;this.node=false;this.registeredObjects=[];this.attachEvents()},attachEvents:function(){var F=this.canvas.getElement(),E=this;F.oncontextmenu=d.lambda(false);d.addEvents(F,{mouseup:function(I,H){var G=d.event.get(I,H);E.handleEvent("MouseUp",I,H,E.makeEventObject(I,H),d.event.isRightClick(G))},mousedown:function(I,H){var G=d.event.get(I,H);E.handleEvent("MouseDown",I,H,E.makeEventObject(I,H),d.event.isRightClick(G))},mousemove:function(H,G){E.handleEvent("MouseMove",H,G,E.makeEventObject(H,G))},mouseover:function(H,G){E.handleEvent("MouseOver",H,G,E.makeEventObject(H,G))},mouseout:function(H,G){E.handleEvent("MouseOut",H,G,E.makeEventObject(H,G))},touchstart:function(H,G){E.handleEvent("TouchStart",H,G,E.makeEventObject(H,G))},touchmove:function(H,G){E.handleEvent("TouchMove",H,G,E.makeEventObject(H,G))},touchend:function(H,G){E.handleEvent("TouchEnd",H,G,E.makeEventObject(H,G))}});var D=function(J,I){var H=d.event.get(J,I);var G=d.event.getWheel(H);E.handleEvent("MouseWheel",J,I,G)};if(!document.getBoxObjectFor&&window.mozInnerScreenX==null){d.addEvent(F,"mousewheel",D)}else{F.addEventListener("DOMMouseScroll",D,false)}},register:function(D){this.registeredObjects.push(D)},handleEvent:function(){var E=Array.prototype.slice.call(arguments),H=E.shift();for(var G=0,F=this.registeredObjects,D=F.length;G<D;G++){F[G]["on"+H].apply(F[G],E)}},makeEventObject:function(I,H){var F=this,G=this.viz.graph,E=this.viz.fx,D=E.nodeTypes;return{pos:false,node:false,contains:false,getNodeCalled:false,getPos:function(){if(this.pos){return this.pos}var M=F.viz.canvas,N=M.getSize(),O=M.getPos(),L=M.translateOffsetX,J=M.translateOffsetY,R=M.scaleOffsetX,P=M.scaleOffsetY,Q=d.event.getPos(I,H);this.pos={x:(Q.x-O.x-N.width/2-L)*1/R,y:(Q.y-O.y-N.height/2-J)*1/P};return this.pos},getNode:function(){if(this.getNodeCalled){return this.node}this.getNodeCalled=true;if(F.node){var N=G.getNode(F.node),L=N&&D[N.getData("type")],J=L&&L.contains&&L.contains.call(E,N,this.getPos());if(J){this.contains=J;return this.node=N}}for(var M in G.nodes){var N=G.nodes[M],L=N&&D[N.getData("type")],J=L&&L.contains&&L.contains.call(E,N,this.getPos());if(J){this.contains=J;return F.node=this.node=N}}return F.node=this.node=false},getContains:function(){if(this.getNodeCalled){return this.contains}this.getNode();return this.contains}}}});var t={initializeExtras:function(){var E=new z(this),D=this;d.each(["NodeStyles","Tips","Navigation","Events"],function(F){var G=new t.Classes[F](F,D);if(G.isEnabled()){E.register(G)}if(G.setAsProperty()){D[F.toLowerCase()]=G}})}};t.Classes={};t.Classes.Events=new v({Implements:[A,j],initializePost:function(){this.fx=this.viz.fx;this.types=this.viz.fx.nodeTypes;this.hoveredNode=false;this.pressedNode=false;this.touchedNode=false;this.touchMoved=false;this.moved=false},setAsProperty:d.lambda(true),onMouseUp:function(H,G,E,F){var D=d.event.get(H,G);if(F){this.config.onRightClick(this.hoveredNode,E,D)}else{this.config.onClick(this.pressedNode,E,D)}if(this.pressedNode){if(this.moved){this.config.onDragEnd(this.pressedNode,E,D)}else{this.config.onDragCancel(this.pressedNode,E,D)}this.pressedNode=this.moved=false}},onMouseOut:function(I,H,G){var E=d.event.get(I,H),F;if(this.dom&&(F=this.isLabel(I,H))){this.config.onMouseLeave(this.viz.graph.getNode(F.id),G,E);this.hoveredNode=false;return}var D=E.relatedTarget,J=this.canvas.getElement();while(D&&D.parentNode){if(J==D.parentNode){return}D=D.parentNode}if(this.hoveredNode){this.config.onMouseLeave(this.hoveredNode,G,E);this.hoveredNode=false}},onMouseOver:function(H,G,F){var D=d.event.get(H,G),E;if(this.dom&&(E=this.isLabel(H,G))){this.hoveredNode=this.viz.graph.getNode(E.id);this.config.onMouseEnter(this.hoveredNode,F,D)}},onMouseMove:function(J,I,H){var E,D=d.event.get(J,I);if(this.pressedNode){this.moved=true;this.config.onDragMove(this.pressedNode,H,D);return}if(this.dom){this.config.onMouseMove(this.hoveredNode,H,D)}else{if(this.hoveredNode){var L=this.hoveredNode;var G=this.types[L.getData("type")];var F=G&&G.contains&&G.contains.call(this.fx,L,H.getPos());if(F){this.config.onMouseMove(L,H,D);return}else{this.config.onMouseLeave(L,H,D);this.hoveredNode=false}}if(this.hoveredNode=H.getNode()){this.config.onMouseEnter(this.hoveredNode,H,D)}else{this.config.onMouseMove(false,H,D)}}},onMouseWheel:function(E,D,F){this.config.onMouseWheel(F,d.event.get(E,D))},onMouseDown:function(G,F,E){var D=d.event.get(G,F);this.pressedNode=E.getNode();this.config.onDragStart(this.pressedNode,E,D)},onTouchStart:function(G,F,E){var D=d.event.get(G,F);this.touchedNode=E.getNode();this.config.onTouchStart(this.touchedNode,E,D)},onTouchMove:function(G,F,E){var D=d.event.get(G,F);if(this.touchedNode){this.touchMoved=true;this.config.onTouchMove(this.touchedNode,E,D)}},onTouchEnd:function(G,F,E){var D=d.event.get(G,F);if(this.touchedNode){if(this.touchMoved){this.config.onTouchEnd(this.touchedNode,E,D)}else{this.config.onTouchCancel(this.touchedNode,E,D)}this.touchedNode=this.touchMoved=false}}});t.Classes.Tips=new v({Implements:[A,j],initializePost:function(){if(document.body){var D=d("_tooltip")||document.createElement("div");D.id="_tooltip";D.className="tip";d.extend(D.style,{position:"absolute",display:"none",zIndex:13000});document.body.appendChild(D);this.tip=D;this.node=false}},setAsProperty:d.lambda(true),onMouseOut:function(F,E){if(this.dom&&this.isLabel(F,E)){this.hide(true);return}var D=F.relatedTarget,G=this.canvas.getElement();while(D&&D.parentNode){if(G==D.parentNode){return}D=D.parentNode}this.hide(false)},onMouseOver:function(F,E){var D;if(this.dom&&(D=this.isLabel(F,E))){this.node=this.viz.graph.getNode(D.id);this.config.onShow(this.tip,this.node,D)}},onMouseMove:function(G,F,D){if(this.dom&&this.isLabel(G,F)){this.setTooltipPosition(d.event.getPos(G,F))}if(!this.dom){var E=D.getNode();if(!E){this.hide(true);return}if(this.config.force||!this.node||this.node.id!=E.id){this.node=E;this.config.onShow(this.tip,E,D.getContains())}this.setTooltipPosition(d.event.getPos(G,F))}},setTooltipPosition:function(L){var G=this.tip,F=G.style,E=this.config;F.display="";var I={height:document.body.clientHeight,width:document.body.clientWidth};var H={width:G.offsetWidth,height:G.offsetHeight};var D=E.offsetX,J=E.offsetY;F.top=((L.y+J+H.height>I.height)?(L.y-H.height-J):L.y+J)+"px";F.left=((L.x+H.width+D>I.width)?(L.x-H.width-D):L.x+D)+"px"},hide:function(D){this.tip.style.display="none";D&&this.config.onHide()}});t.Classes.NodeStyles=new v({Implements:[A,j],initializePost:function(){this.fx=this.viz.fx;this.types=this.viz.fx.nodeTypes;this.nStyles=this.config;this.nodeStylesOnHover=this.nStyles.stylesHover;this.nodeStylesOnClick=this.nStyles.stylesClick;this.hoveredNode=false;this.fx.nodeFxAnimation=new B();this.down=false;this.move=false},onMouseOut:function(F,E){this.down=this.move=false;if(!this.hoveredNode){return}if(this.dom&&this.isLabel(F,E)){this.toggleStylesOnHover(this.hoveredNode,false)}var D=F.relatedTarget,G=this.canvas.getElement();while(D&&D.parentNode){if(G==D.parentNode){return}D=D.parentNode}this.toggleStylesOnHover(this.hoveredNode,false);this.hoveredNode=false},onMouseOver:function(G,F){var D;if(this.dom&&(D=this.isLabel(G,F))){var E=this.viz.graph.getNode(D.id);if(E.selected){return}this.hoveredNode=E;this.toggleStylesOnHover(this.hoveredNode,true)}},onMouseDown:function(H,G,E,F){if(F){return}var D;if(this.dom&&(D=this.isLabel(H,G))){this.down=this.viz.graph.getNode(D.id)}else{if(!this.dom){this.down=E.getNode()}}this.move=false},onMouseUp:function(G,F,D,E){if(E){return}if(!this.move){this.onClick(D.getNode())}this.down=this.move=false},getRestoredStyles:function(E,D){var G={},F=this["nodeStylesOn"+D];for(var H in F){G[H]=E.styles["$"+H]}return G},toggleStylesOnHover:function(D,E){if(this.nodeStylesOnHover){this.toggleStylesOn("Hover",D,E)}},toggleStylesOnClick:function(D,E){if(this.nodeStylesOnClick){this.toggleStylesOn("Click",D,E)}},toggleStylesOn:function(H,D,J){var L=this.viz;var I=this.nStyles;if(J){var G=this;if(!D.styles){D.styles=d.merge(D.data,{})}for(var M in this["nodeStylesOn"+H]){var E="$"+M;if(!(E in D.styles)){D.styles[E]=D.getData(M)}}L.fx.nodeFx(d.extend({elements:{id:D.id,properties:G["nodeStylesOn"+H]},transition:k.Quart.easeOut,duration:300,fps:40},this.config))}else{var F=this.getRestoredStyles(D,H);L.fx.nodeFx(d.extend({elements:{id:D.id,properties:F},transition:k.Quart.easeOut,duration:300,fps:40},this.config))}},onClick:function(D){if(!D){return}var E=this.nodeStylesOnClick;if(!E){return}if(D.selected){this.toggleStylesOnClick(D,false);delete D.selected}else{this.viz.graph.eachNode(function(G){if(G.selected){for(var F in E){G.setData(F,G.styles["$"+F],"end")}delete G.selected}});this.toggleStylesOnClick(D,true);D.selected=true;delete D.hovered;this.hoveredNode=false}},onMouseMove:function(J,I,G){if(this.down){this.move=true}if(this.dom&&this.isLabel(J,I)){return}var H=this.nodeStylesOnHover;if(!H){return}if(!this.dom){if(this.hoveredNode){var E=this.types[this.hoveredNode.getData("type")];var D=E&&E.contains&&E.contains.call(this.fx,this.hoveredNode,G.getPos());if(D){return}}var F=G.getNode();if(!this.hoveredNode&&!F){return}if(F.hovered){return}if(F&&!F.selected){this.fx.nodeFxAnimation.stopTimer();this.viz.graph.eachNode(function(M){if(M.hovered&&!M.selected){for(var L in H){M.setData(L,M.styles["$"+L],"end")}delete M.hovered}});F.hovered=true;this.hoveredNode=F;this.toggleStylesOnHover(F,true)}else{if(this.hoveredNode&&!this.hoveredNode.selected){this.fx.nodeFxAnimation.stopTimer();this.toggleStylesOnHover(this.hoveredNode,false);delete this.hoveredNode.hovered;this.hoveredNode=false}}}}});t.Classes.Navigation=new v({Implements:[A,j],initializePost:function(){this.pos=false;this.pressed=false},onMouseWheel:function(G,F,D){if(!this.config.zooming){return}d.event.stop(d.event.get(G,F));var H=this.config.zooming/1000,E=1+D*H;this.canvas.scale(E,E)},onMouseDown:function(I,H,G){if(!this.config.panning){return}if(this.config.panning=="avoid nodes"&&G.getNode()){return}this.pressed=true;this.pos=G.getPos();var F=this.canvas,E=F.translateOffsetX,D=F.translateOffsetY,L=F.scaleOffsetX,J=F.scaleOffsetY;this.pos.x*=L;this.pos.x+=E;this.pos.y*=J;this.pos.y+=D},onMouseMove:function(I,H,L){if(!this.config.panning){return}if(!this.pressed){return}if(this.config.panning=="avoid nodes"&&L.getNode()){return}var G=this.pos,J=L.getPos(),E=this.canvas,F=E.translateOffsetX,D=E.translateOffsetY,P=E.scaleOffsetX,N=E.scaleOffsetY;J.x*=P;J.y*=N;J.x+=F;J.y+=D;var O=J.x-G.x,M=J.y-G.y;this.pos=J;this.canvas.translate(O*1/P,M*1/N)},onMouseUp:function(G,F,E,D){if(!this.config.panning){return}this.pressed=false}});var o;(function(){var D=typeof HTMLCanvasElement,F=(D=="object"||D=="function");function E(G,H){var I=document.createElement(G);for(var J in H){if(typeof H[J]=="object"){d.extend(I[J],H[J])}else{I[J]=H[J]}}if(G=="canvas"&&!F&&G_vmlCanvasManager){I=G_vmlCanvasManager.initElement(document.body.appendChild(I))}return I}$jit.Canvas=o=new v({canvases:[],pos:false,element:false,labelContainer:false,translateOffsetX:0,translateOffsetY:0,scaleOffsetX:1,scaleOffsetY:1,initialize:function(S,M){this.viz=S;this.opt=M;var I=d.type(M.injectInto)=="string"?M.injectInto:M.injectInto.id,J=I+"-label",G=d(I),L=M.width||G.offsetWidth,T=M.height||G.offsetHeight;this.id=I;var N={injectInto:I,width:L,height:T};this.element=E("div",{id:I+"-canvaswidget",style:{position:"relative",width:L+"px",height:T+"px"}});this.labelContainer=this.createLabelContainer(M.Label.type,J,N);this.canvases.push(new o.Base({config:d.extend({idSuffix:"-canvas"},N),plot:function(U){S.fx.plot()},resize:function(){S.refresh()}}));var O=M.background;if(O){var R=new o.Background[O.type](S,d.extend(O,N));this.canvases.push(new o.Base(R))}var Q=this.canvases.length;while(Q--){this.element.appendChild(this.canvases[Q].canvas);if(Q>0){this.canvases[Q].plot()}}this.element.appendChild(this.labelContainer);G.appendChild(this.element);var H=null,P=this;d.addEvent(window,"scroll",function(){clearTimeout(H);H=setTimeout(function(){P.getPos(true)},500)})},getCtx:function(G){return this.canvases[G||0].getCtx()},getConfig:function(){return this.opt},getElement:function(){return this.element},getSize:function(G){return this.canvases[G||0].getSize()},resize:function(L,G){this.getPos(true);this.translateOffsetX=this.translateOffsetY=0;this.scaleOffsetX=this.scaleOffsetY=1;for(var I=0,H=this.canvases.length;I<H;I++){this.canvases[I].resize(L,G)}var J=this.element.style;J.width=L+"px";J.height=G+"px";if(this.labelContainer){this.labelContainer.style.width=L+"px"}},translate:function(G,L,J){this.translateOffsetX+=G*this.scaleOffsetX;this.translateOffsetY+=L*this.scaleOffsetY;for(var I=0,H=this.canvases.length;I<H;I++){this.canvases[I].translate(G,L,J)}},scale:function(M,I,J){var N=this.scaleOffsetX*M,L=this.scaleOffsetY*I;var P=this.translateOffsetX*(M-1)/N,O=this.translateOffsetY*(I-1)/L;this.scaleOffsetX=N;this.scaleOffsetY=L;for(var H=0,G=this.canvases.length;H<G;H++){this.canvases[H].scale(M,I,true)}this.translate(P,O,false)},getPos:function(G){if(G||!this.pos){return this.pos=d.getPos(this.getElement())}return this.pos},clear:function(G){this.canvases[G||0].clear()},path:function(H,I){var G=this.canvases[0].getCtx();G.beginPath();I(G);G[H]();G.closePath()},createLabelContainer:function(I,N,M){var L="http://www.w3.org/2000/svg";if(I=="HTML"||I=="Native"){return E("div",{id:N,style:{overflow:"visible",position:"absolute",top:0,left:0,width:M.width+"px",height:0}})}else{if(I=="SVG"){var J=document.createElementNS(L,"svg:svg");J.setAttribute("width",M.width);J.setAttribute("height",M.height);var H=J.style;H.position="absolute";H.left=H.top="0px";var G=document.createElementNS(L,"svg:g");G.setAttribute("width",M.width);G.setAttribute("height",M.height);G.setAttribute("x",0);G.setAttribute("y",0);G.setAttribute("id",N);J.appendChild(G);return J}}}});o.Base=new v({translateOffsetX:0,translateOffsetY:0,scaleOffsetX:1,scaleOffsetY:1,initialize:function(G){this.viz=G;this.opt=G.config;this.size=false;this.createCanvas();this.translateToCenter()},createCanvas:function(){var H=this.opt,I=H.width,G=H.height;this.canvas=E("canvas",{id:H.injectInto+H.idSuffix,width:I,height:G,style:{position:"absolute",top:0,left:0,width:I+"px",height:G+"px"}})},getCtx:function(){if(!this.ctx){return this.ctx=this.canvas.getContext("2d")}return this.ctx},getSize:function(){if(this.size){return this.size}var G=this.canvas;return this.size={width:G.width,height:G.height}},translateToCenter:function(J){var H=this.getSize(),I=J?(H.width-J.width-this.translateOffsetX*2):H.width;height=J?(H.height-J.height-this.translateOffsetY*2):H.height;var G=this.getCtx();J&&G.scale(1/this.scaleOffsetX,1/this.scaleOffsetY);G.translate(I/2,height/2)},resize:function(J,G){var I=this.getSize(),H=this.canvas,L=H.style;this.size=false;H.width=J;H.height=G;L.width=J+"px";L.height=G+"px";if(!F){this.translateToCenter(I)}else{this.translateToCenter()}this.translateOffsetX=this.translateOffsetY=0;this.scaleOffsetX=this.scaleOffsetY=1;this.clear();this.viz.resize(J,G,this)},translate:function(G,L,H){var J=this.scaleOffsetX,I=this.scaleOffsetY;this.translateOffsetX+=G*J;this.translateOffsetY+=L*I;this.getCtx().translate(G,L);!H&&this.plot()},scale:function(G,I,H){this.scaleOffsetX*=G;this.scaleOffsetY*=I;this.getCtx().scale(G,I);!H&&this.plot()},clear:function(){var I=this.getSize(),H=this.translateOffsetX,G=this.translateOffsetY,L=this.scaleOffsetX,J=this.scaleOffsetY;this.getCtx().clearRect((-I.width/2-H)*1/L,(-I.height/2-G)*1/J,I.width*1/L,I.height*1/J)},plot:function(){this.clear();this.viz.plot(this)}});o.Background={};o.Background.Circles=new v({initialize:function(G,H){this.viz=G;this.config=d.merge({idSuffix:"-bkcanvas",levelDistance:100,numberOfCircles:6,CanvasStyles:{},offset:0},H)},resize:function(H,G,I){this.plot(I)},plot:function(G){var H=G.canvas,O=G.getCtx(),L=this.config,N=L.CanvasStyles;for(var P in N){O[P]=N[P]}var I=L.numberOfCircles,M=L.levelDistance;for(var J=1;J<=I;J++){O.beginPath();O.arc(0,0,M*J,0,2*Math.PI,false);O.stroke();O.closePath()}}})})();var c=function(E,D){this.theta=E;this.rho=D};$jit.Polar=c;c.prototype={getc:function(D){return this.toComplex(D)},getp:function(){return this},set:function(D){D=D.getp();this.theta=D.theta;this.rho=D.rho},setc:function(D,E){this.rho=Math.sqrt(D*D+E*E);this.theta=Math.atan2(E,D);if(this.theta<0){this.theta+=Math.PI*2}},setp:function(E,D){this.theta=E;this.rho=D},clone:function(){return new c(this.theta,this.rho)},toComplex:function(F){var D=Math.cos(this.theta)*this.rho;var E=Math.sin(this.theta)*this.rho;if(F){return{x:D,y:E}}return new u(D,E)},add:function(D){return new c(this.theta+D.theta,this.rho+D.rho)},scale:function(D){return new c(this.theta,this.rho*D)},equals:function(D){return this.theta==D.theta&&this.rho==D.rho},$add:function(D){this.theta=this.theta+D.theta;this.rho+=D.rho;return this},$madd:function(D){this.theta=(this.theta+D.theta)%(Math.PI*2);this.rho+=D.rho;return this},$scale:function(D){this.rho*=D;return this},interpolate:function(F,N){var G=Math.PI,J=G*2;var E=function(P){var O=(P<0)?(P%J)+J:P%J;return O};var I=this.theta,M=F.theta;var H,L=Math.abs(I-M);if(L==G){if(I>M){H=E((M+((I-J)-M)*N))}else{H=E((M-J+(I-(M))*N))}}else{if(L>=G){if(I>M){H=E((M+((I-J)-M)*N))}else{H=E((M-J+(I-(M-J))*N))}}else{H=E((M+(I-M)*N))}}var D=(this.rho-F.rho)*N+F.rho;return{theta:H,rho:D}}};var n=function(E,D){return new c(E,D)};c.KER=n(0,0);var u=function(D,E){this.x=D;this.y=E};$jit.Complex=u;u.prototype={getc:function(){return this},getp:function(D){return this.toPolar(D)},set:function(D){D=D.getc(true);this.x=D.x;this.y=D.y},setc:function(D,E){this.x=D;this.y=E},setp:function(E,D){this.x=Math.cos(E)*D;this.y=Math.sin(E)*D},clone:function(){return new u(this.x,this.y)},toPolar:function(F){var D=this.norm();var E=Math.atan2(this.y,this.x);if(E<0){E+=Math.PI*2}if(F){return{theta:E,rho:D}}return new c(E,D)},norm:function(){return Math.sqrt(this.squaredNorm())},squaredNorm:function(){return this.x*this.x+this.y*this.y},add:function(D){return new u(this.x+D.x,this.y+D.y)},prod:function(D){return new u(this.x*D.x-this.y*D.y,this.y*D.x+this.x*D.y)},conjugate:function(){return new u(this.x,-this.y)},scale:function(D){return new u(this.x*D,this.y*D)},equals:function(D){return this.x==D.x&&this.y==D.y},$add:function(D){this.x+=D.x;this.y+=D.y;return this},$prod:function(F){var D=this.x,E=this.y;this.x=D*F.x-E*F.y;this.y=E*F.x+D*F.y;return this},$conjugate:function(){this.y=-this.y;return this},$scale:function(D){this.x*=D;this.y*=D;return this},$div:function(G){var D=this.x,F=this.y;var E=G.squaredNorm();this.x=D*G.x+F*G.y;this.y=F*G.x-D*G.y;return this.$scale(1/E)}};var w=function(E,D){return new u(E,D)};u.KER=w(0,0);$jit.Graph=new v({initialize:function(F,E,D,J){var H={complex:false,Node:{}};this.Node=E;this.Edge=D;this.Label=J;this.opt=d.merge(H,F||{});this.nodes={};this.edges={};var G=this;this.nodeList={};for(var I in l){G.nodeList[I]=(function(L){return function(){var M=Array.prototype.slice.call(arguments);G.eachNode(function(N){N[L].apply(N,M)})}})(I)}},getNode:function(D){if(this.hasNode(D)){return this.nodes[D]}return false},getByName:function(D){for(var F in this.nodes){var E=this.nodes[F];if(E.name==D){return E}}return false},getAdjacence:function(E,D){if(E in this.edges){return this.edges[E][D]}return false},addNode:function(E){if(!this.nodes[E.id]){var D=this.edges[E.id]={};this.nodes[E.id]=new f.Node(d.extend({id:E.id,name:E.name,data:E.data||{},adjacencies:D},this.opt.Node),this.opt.complex,this.Node,this.Edge,this.Label)}return this.nodes[E.id]},addAdjacence:function(G,F,E){if(!this.hasNode(G.id)){this.addNode(G)}if(!this.hasNode(F.id)){this.addNode(F)}G=this.nodes[G.id];F=this.nodes[F.id];var H=this.edges[G.id]=this.edges[G.id]||{};var D=this.edges[F.id]=this.edges[F.id]||{};H[F.id]=D[G.id]=new f.Adjacence(G,F,E,this.Edge,this.Label);return H[F.id]},removeNode:function(F){if(this.hasNode(F)){delete this.nodes[F];var E=this.edges[F];for(var D in E){delete this.edges[D][F]}delete this.edges[F]}},removeAdjacence:function(E,D){delete this.edges[E][D];delete this.edges[D][E]},hasNode:function(D){return D in this.nodes},empty:function(){this.nodes={};this.edges={}}});var f=$jit.Graph;var l;(function(){var D=function(L,N,H,J,M){var I;H=H||"current";L="$"+(L?L+"-":"");if(H=="current"){I=this.data}else{if(H=="start"){I=this.startData}else{if(H=="end"){I=this.endData}}}var G=L+N;if(J){return I[G]}if(!this.Config.overridable){return M[N]||0}return(G in I)?I[G]:((G in this.data)?this.data[G]:(M[N]||0))};var F=function(J,L,I,G){G=G||"current";J="$"+(J?J+"-":"");var H;if(G=="current"){H=this.data}else{if(G=="start"){H=this.startData}else{if(G=="end"){H=this.endData}}}H[J+L]=I};var E=function(I,G){I="$"+(I?I+"-":"");var H=this;d.each(G,function(L){var J=I+L;delete H.data[J];delete H.endData[J];delete H.startData[J]})};l={getData:function(I,G,H){return D.call(this,"",I,G,H,this.Config)},setData:function(I,H,G){F.call(this,"",I,H,G)},setDataset:function(J,L){J=d.splat(J);for(var G in L){for(var I=0,M=d.splat(L[G]),H=J.length;I<H;I++){this.setData(G,M[I],J[I])}}},removeData:function(){E.call(this,"",Array.prototype.slice.call(arguments))},getCanvasStyle:function(I,G,H){return D.call(this,"canvas",I,G,H,this.Config.CanvasStyles)},setCanvasStyle:function(I,H,G){F.call(this,"canvas",I,H,G)},setCanvasStyles:function(J,L){J=d.splat(J);for(var G in L){for(var I=0,M=d.splat(L[G]),H=J.length;I<H;I++){this.setCanvasStyle(G,M[I],J[I])}}},removeCanvasStyle:function(){E.call(this,"canvas",Array.prototype.slice.call(arguments))},getLabelData:function(I,G,H){return D.call(this,"label",I,G,H,this.Label)},setLabelData:function(I,H,G){F.call(this,"label",I,H,G)},setLabelDataset:function(J,L){J=d.splat(J);for(var G in L){for(var I=0,M=d.splat(L[G]),H=J.length;I<H;I++){this.setLabelData(G,M[I],J[I])}}},removeLabelData:function(){E.call(this,"label",Array.prototype.slice.call(arguments))}}})();f.Node=new v({initialize:function(F,H,E,D,I){var G={id:"",name:"",data:{},startData:{},endData:{},adjacencies:{},selected:false,drawn:false,exist:false,angleSpan:{begin:0,end:0},pos:(H&&w(0,0))||n(0,0),startPos:(H&&w(0,0))||n(0,0),endPos:(H&&w(0,0))||n(0,0)};d.extend(this,d.extend(G,F));this.Config=this.Node=E;this.Edge=D;this.Label=I},adjacentTo:function(D){return D.id in this.adjacencies},getAdjacency:function(D){return this.adjacencies[D]},getPos:function(D){D=D||"current";if(D=="current"){return this.pos}else{if(D=="end"){return this.endPos}else{if(D=="start"){return this.startPos}}}},setPos:function(E,D){D=D||"current";var F;if(D=="current"){F=this.pos}else{if(D=="end"){F=this.endPos}else{if(D=="start"){F=this.startPos}}}F.set(E)}});f.Node.implement(l);f.Adjacence=new v({initialize:function(E,H,F,D,G){this.nodeFrom=E;this.nodeTo=H;this.data=F||{};this.startData={};this.endData={};this.Config=this.Edge=D;this.Label=G}});f.Adjacence.implement(l);f.Util={filter:function(E){if(!E||!(d.type(E)=="string")){return function(){return true}}var D=E.split(" ");return function(G){for(var F=0;F<D.length;F++){if(G[D[F]]){return false}}return true}},getNode:function(D,E){return D.nodes[E]},eachNode:function(H,G,D){var F=this.filter(D);for(var E in H.nodes){if(F(H.nodes[E])){G(H.nodes[E])}}},eachAdjacency:function(I,J,E){var F=I.adjacencies,H=this.filter(E);for(var L in F){var D=F[L];if(H(D)){if(D.nodeFrom!=I){var G=D.nodeFrom;D.nodeFrom=D.nodeTo;D.nodeTo=G}J(D,L)}}},computeLevels:function(J,L,G,F){G=G||0;var H=this.filter(F);this.eachNode(J,function(M){M._flag=false;M._depth=-1},F);var E=J.getNode(L);E._depth=G;var D=[E];while(D.length!=0){var I=D.pop();I._flag=true;this.eachAdjacency(I,function(M){var N=M.nodeTo;if(N._flag==false&&H(N)){if(N._depth<0){N._depth=I._depth+1+G}D.unshift(N)}},F)}},eachBFS:function(I,J,H,E){var F=this.filter(E);this.clean(I);var D=[I.getNode(J)];while(D.length!=0){var G=D.pop();G._flag=true;H(G,G._depth);this.eachAdjacency(G,function(L){var M=L.nodeTo;if(M._flag==false&&F(M)){M._flag=true;D.unshift(M)}},E)}},eachLevel:function(H,M,E,I,G){var L=H._depth,D=this.filter(G),J=this;E=E===false?Number.MAX_VALUE-L:E;(function F(P,N,O){var Q=P._depth;if(Q>=N&&Q<=O&&D(P)){I(P,Q)}if(Q<O){J.eachAdjacency(P,function(R){var S=R.nodeTo;if(S._depth>Q){F(S,N,O)}})}})(H,M+L,E+L)},eachSubgraph:function(E,F,D){this.eachLevel(E,0,false,F,D)},eachSubnode:function(E,F,D){this.eachLevel(E,1,1,F,D)},anySubnode:function(G,F,E){var D=false;F=F||d.lambda(true);var H=d.type(F)=="string"?function(I){return I[F]}:F;this.eachSubnode(G,function(I){if(H(I)){D=true}},E);return D},getSubnodes:function(I,J,D){var F=[],H=this;J=J||0;var G,E;if(d.type(J)=="array"){G=J[0];E=J[1]}else{G=J;E=Number.MAX_VALUE-I._depth}this.eachLevel(I,G,E,function(L){F.push(L)},D);return F},getParents:function(E){var D=[];this.eachAdjacency(E,function(F){var G=F.nodeTo;if(G._depth<E._depth){D.push(G)}});return D},isDescendantOf:function(G,H){if(G.id==H){return true}var F=this.getParents(G),D=false;for(var E=0;!D&&E<F.length;E++){D=D||this.isDescendantOf(F[E],H)}return D},clean:function(D){this.eachNode(D,function(E){E._flag=false})},getClosestNodeToOrigin:function(E,F,D){return this.getClosestNodeToPos(E,c.KER,F,D)},getClosestNodeToPos:function(F,I,H,D){var E=null;H=H||"current";I=I&&I.getc(true)||u.KER;var G=function(L,J){var N=L.x-J.x,M=L.y-J.y;return N*N+M*M};this.eachNode(F,function(J){E=(E==null||G(J.getPos(H).getc(true),I)<G(E.getPos(H).getc(true),I))?J:E},D);return E}};d.each(["getNode","eachNode","computeLevels","eachBFS","clean","getClosestNodeToPos","getClosestNodeToOrigin"],function(D){f.prototype[D]=function(){return f.Util[D].apply(f.Util,[this].concat(Array.prototype.slice.call(arguments)))}});d.each(["eachAdjacency","eachLevel","eachSubgraph","eachSubnode","anySubnode","getSubnodes","getParents","isDescendantOf"],function(D){f.Node.prototype[D]=function(){return f.Util[D].apply(f.Util,[this].concat(Array.prototype.slice.call(arguments)))}});f.Op={options:{type:"nothing",duration:2000,hideLabels:true,fps:30},removeNode:function(I,G){var D=this.viz;var E=d.merge(this.options,D.controller,G);var L=d.splat(I);var F,H,J;switch(E.type){case"nothing":for(F=0;F<L.length;F++){D.graph.removeNode(L[F])}break;case"replot":this.removeNode(L,{type:"nothing"});D.labels.clearLabels();D.refresh(true);break;case"fade:seq":case"fade":H=this;for(F=0;F<L.length;F++){J=D.graph.getNode(L[F]);J.setData("alpha",0,"end")}D.fx.animate(d.merge(E,{modes:["node-property:alpha"],onComplete:function(){H.removeNode(L,{type:"nothing"});D.labels.clearLabels();D.reposition();D.fx.animate(d.merge(E,{modes:["linear"]}))}}));break;case"fade:con":H=this;for(F=0;F<L.length;F++){J=D.graph.getNode(L[F]);J.setData("alpha",0,"end");J.ignore=true}D.reposition();D.fx.animate(d.merge(E,{modes:["node-property:alpha","linear"],onComplete:function(){H.removeNode(L,{type:"nothing"})}}));break;case"iter":H=this;D.fx.sequence({condition:function(){return L.length!=0},step:function(){H.removeNode(L.shift(),{type:"nothing"});D.labels.clearLabels()},onComplete:function(){E.onComplete()},duration:Math.ceil(E.duration/L.length)});break;default:this.doError()}},removeEdge:function(L,I){var D=this.viz;var G=d.merge(this.options,D.controller,I);var F=(d.type(L[0])=="string")?[L]:L;var H,J,E;switch(G.type){case"nothing":for(H=0;H<F.length;H++){D.graph.removeAdjacence(F[H][0],F[H][1])}break;case"replot":this.removeEdge(F,{type:"nothing"});D.refresh(true);break;case"fade:seq":case"fade":J=this;for(H=0;H<F.length;H++){E=D.graph.getAdjacence(F[H][0],F[H][1]);if(E){E.setData("alpha",0,"end")}}D.fx.animate(d.merge(G,{modes:["edge-property:alpha"],onComplete:function(){J.removeEdge(F,{type:"nothing"});D.reposition();D.fx.animate(d.merge(G,{modes:["linear"]}))}}));break;case"fade:con":J=this;for(H=0;H<F.length;H++){E=D.graph.getAdjacence(F[H][0],F[H][1]);if(E){E.setData("alpha",0,"end");E.ignore=true}}D.reposition();D.fx.animate(d.merge(G,{modes:["edge-property:alpha","linear"],onComplete:function(){J.removeEdge(F,{type:"nothing"})}}));break;case"iter":J=this;D.fx.sequence({condition:function(){return F.length!=0},step:function(){J.removeEdge(F.shift(),{type:"nothing"});D.labels.clearLabels()},onComplete:function(){G.onComplete()},duration:Math.ceil(G.duration/F.length)});break;default:this.doError()}},sum:function(H,G){var D=this.viz;var F=d.merge(this.options,D.controller,G),E=D.root;var J;D.root=G.id||D.root;switch(F.type){case"nothing":J=D.construct(H);J.eachNode(function(M){M.eachAdjacency(function(N){D.graph.addAdjacence(N.nodeFrom,N.nodeTo,N.data)})});break;case"replot":D.refresh(true);this.sum(H,{type:"nothing"});D.refresh(true);break;case"fade:seq":case"fade":case"fade:con":that=this;J=D.construct(H);var L=this.preprocessSum(J);var I=!L?["node-property:alpha"]:["node-property:alpha","edge-property:alpha"];D.reposition();if(F.type!="fade:con"){D.fx.animate(d.merge(F,{modes:["linear"],onComplete:function(){D.fx.animate(d.merge(F,{modes:I,onComplete:function(){F.onComplete()}}))}}))}else{D.graph.eachNode(function(M){if(M.id!=E&&M.pos.getp().equals(c.KER)){M.pos.set(M.endPos);M.startPos.set(M.endPos)}});D.fx.animate(d.merge(F,{modes:["linear"].concat(I)}))}break;default:this.doError()}},morph:function(L,E,G){var I=this.viz;var M=d.merge(this.options,I.controller,E),H=I.root;var J;I.root=E.id||I.root;switch(M.type){case"nothing":J=I.construct(L);J.eachNode(function(P){var O=I.graph.hasNode(P.id);P.eachAdjacency(function(T){var S=!!I.graph.getAdjacence(T.nodeFrom.id,T.nodeTo.id);I.graph.addAdjacence(T.nodeFrom,T.nodeTo,T.data);if(S){var R=I.graph.getAdjacence(T.nodeFrom.id,T.nodeTo.id);for(var U in (T.data||{})){R.data[U]=T.data[U]}}});if(O){var N=I.graph.getNode(P.id);for(var Q in (P.data||{})){N.data[Q]=P.data[Q]}}});I.graph.eachNode(function(N){N.eachAdjacency(function(O){if(!J.getAdjacence(O.nodeFrom.id,O.nodeTo.id)){I.graph.removeAdjacence(O.nodeFrom.id,O.nodeTo.id)}});if(!J.hasNode(N.id)){I.graph.removeNode(N.id)}});break;case"replot":I.labels.clearLabels(true);this.morph(L,{type:"nothing"});I.refresh(true);I.refresh(true);break;case"fade:seq":case"fade":case"fade:con":that=this;J=I.construct(L);I.graph.eachNode(function(O){var P=J.getNode(O.id);if(!P){O.setData("alpha",1);O.setData("alpha",1,"start");O.setData("alpha",0,"end");O.ignore=true}else{var N=P.data;for(var Q in N){if(Q[0]=="$"&&Q!="$type"){O.endData[Q]=N[Q]}else{O.data[Q]=N[Q]}}}});I.graph.eachNode(function(N){if(N.ignore){return}N.eachAdjacency(function(O){if(O.nodeFrom.ignore||O.nodeTo.ignore){return}var P=J.getNode(O.nodeFrom.id);var Q=J.getNode(O.nodeTo.id);if(!P.adjacentTo(Q)){var O=I.graph.getAdjacence(P.id,Q.id);D=true;O.setData("alpha",1);O.setData("alpha",1,"start");O.setData("alpha",0,"end")}})});var D=this.preprocessSum(J);var F=!D?["node-property:alpha"]:["node-property:alpha","edge-property:alpha"];F[0]=F[0]+((G&&("node-property" in G))?d.splat(G["node-property"]).join(":"):"");F[1]=(F[1]||"edge-property:alpha")+((G&&("edge-property" in G))?d.splat(G["edge-property"]).join(":"):"");if(G&&("label-property" in G)){F.push("label-property"+d.splat(G["label-property"]).join(":"))}I.reposition();I.graph.eachNode(function(N){if(N.id!=H&&N.pos.getp().equals(c.KER)){N.pos.set(N.endPos);N.startPos.set(N.endPos)}});I.fx.animate(d.merge(M,{modes:["polar"].concat(F),onComplete:function(){I.graph.eachNode(function(N){if(N.ignore){I.graph.removeNode(N.id)}});I.graph.eachNode(function(N){N.eachAdjacency(function(O){if(O.ignore){I.graph.removeAdjacence(O.nodeFrom.id,O.nodeTo.id)}})});M.onComplete()}}));break;default:}},contract:function(F,E){var D=this.viz;if(F.collapsed||!F.anySubnode(d.lambda(true))){return}E=d.merge(this.options,D.config,E||{},{modes:["node-property:alpha:span","linear"]});F.collapsed=true;(function G(H){H.eachSubnode(function(I){I.ignore=true;I.setData("alpha",0,E.type=="animate"?"end":"current");G(I)})})(F);if(E.type=="animate"){D.compute("end");if(D.rotated){D.rotate(D.rotated,"none",{property:"end"})}(function G(H){H.eachSubnode(function(I){I.setPos(F.getPos("end"),"end");G(I)})})(F);D.fx.animate(E)}else{if(E.type=="replot"){D.refresh()}}},expand:function(F,E){if(!("collapsed" in F)){return}var D=this.viz;E=d.merge(this.options,D.config,E||{},{modes:["node-property:alpha:span","linear"]});delete F.collapsed;(function G(H){H.eachSubnode(function(I){delete I.ignore;I.setData("alpha",1,E.type=="animate"?"end":"current");G(I)})})(F);if(E.type=="animate"){D.compute("end");if(D.rotated){D.rotate(D.rotated,"none",{property:"end"})}D.fx.animate(E)}else{if(E.type=="replot"){D.refresh()}}},preprocessSum:function(E){var D=this.viz;E.eachNode(function(G){if(!D.graph.hasNode(G.id)){D.graph.addNode(G);var H=D.graph.getNode(G.id);H.setData("alpha",0);H.setData("alpha",0,"start");H.setData("alpha",1,"end")}});var F=false;E.eachNode(function(G){G.eachAdjacency(function(H){var I=D.graph.getNode(H.nodeFrom.id);var J=D.graph.getNode(H.nodeTo.id);if(!I.adjacentTo(J)){var H=D.graph.addAdjacence(I,J,H.data);if(I.startAlpha==I.endAlpha&&J.startAlpha==J.endAlpha){F=true;H.setData("alpha",0);H.setData("alpha",0,"start");H.setData("alpha",1,"end")}}})});return F}};var a={none:{render:d.empty,contains:d.lambda(false)},circle:{render:function(G,H,D,F){var E=F.getCtx();E.beginPath();E.arc(H.x,H.y,D,0,Math.PI*2,true);E.closePath();E[G]()},contains:function(I,H,D){var F=I.x-H.x,E=I.y-H.y,G=F*F+E*E;return G<=D*D}},ellipse:{render:function(H,I,G,D,F){var E=F.getCtx();D/=2;G/=2;E.save();E.scale(G/D,D/G);E.beginPath();E.arc(I.x*(D/G),I.y*(G/D),D,0,Math.PI*2,true);E.closePath();E[H]();E.restore()},contains:function(L,J,G,D){G/=2;D/=2;var I=(G+D)/2,F=L.x-J.x,E=L.y-J.y,H=F*F+E*E;return H<=I*I}},square:{render:function(E,G,F,D){D.getCtx()[E+"Rect"](G.x-F,G.y-F,2*F,2*F)},contains:function(F,E,D){return Math.abs(E.x-F.x)<=D&&Math.abs(E.y-F.y)<=D}},rectangle:{render:function(G,H,F,D,E){E.getCtx()[G+"Rect"](H.x-F/2,H.y-D/2,F,D)},contains:function(G,F,E,D){return Math.abs(F.x-G.x)<=E/2&&Math.abs(F.y-G.y)<=D/2}},triangle:{render:function(J,L,G,D){var O=D.getCtx(),F=L.x,E=L.y-G,N=F-G,M=L.y+G,I=F+G,H=M;O.beginPath();O.moveTo(F,E);O.lineTo(N,M);O.lineTo(I,H);O.closePath();O[J]()},contains:function(F,E,D){return a.circle.contains(F,E,D)}},star:{render:function(H,J,I,E){var D=E.getCtx(),G=Math.PI/5;D.save();D.translate(J.x,J.y);D.beginPath();D.moveTo(I,0);for(var F=0;F<9;F++){D.rotate(G);if(F%2==0){D.lineTo((I/0.525731)*0.200811,0)}else{D.lineTo(I,0)}}D.closePath();D[H]();D.restore()},contains:function(F,E,D){return a.circle.contains(F,E,D)}}};var p={line:function(G,F,E){var D=E.getCtx();D.beginPath();D.moveTo(G.x,G.y);D.lineTo(F.x,F.y);D.stroke()},arrow:function(N,O,G,E,D){var P=D.getCtx();if(E){var F=N;N=O;O=F}var J=new u(O.x-N.x,O.y-N.y);J.$scale(G/J.norm());var H=new u(O.x-J.x,O.y-J.y),I=new u(-J.y/2,J.x/2),M=H.add(I),L=H.$add(I.$scale(-1));P.beginPath();P.moveTo(N.x,N.y);P.lineTo(O.x,O.y);P.stroke();P.beginPath();P.moveTo(M.x,M.y);P.lineTo(L.x,L.y);P.lineTo(O.x,O.y);P.closePath();P.fill()},hyperline:function(L,M,D,F){var N=F.getCtx();var G=H(L,M);if(G.a>1000||G.b>1000||G.ratio<0){N.beginPath();N.moveTo(L.x*D,L.y*D);N.lineTo(M.x*D,M.y*D);N.stroke()}else{var J=Math.atan2(M.y-G.y,M.x-G.x);var I=Math.atan2(L.y-G.y,L.x-G.x);var E=E(J,I);N.beginPath();N.arc(G.x*D,G.y*D,G.ratio*D,J,I,E);N.stroke()}function H(aa,Z){var S=(aa.x*Z.y-aa.y*Z.x),O=S;var R=aa.squaredNorm(),Q=Z.squaredNorm();if(S==0){return{x:0,y:0,ratio:-1}}var Y=(aa.y*Q-Z.y*R+aa.y-Z.y)/S;var W=(Z.x*R-aa.x*Q+Z.x-aa.x)/O;var X=-Y/2;var V=-W/2;var U=(Y*Y+W*W)/4-1;if(U<0){return{x:0,y:0,ratio:-1}}var T=Math.sqrt(U);var P={x:X,y:V,ratio:T>1000?-1:T,a:Y,b:W};return P}function E(O,P){return(O<P)?((O+Math.PI>P)?false:true):((P+Math.PI>O)?true:false)}}};f.Plot={nodeHelper:a,edgeHelper:p,Interpolator:{map:{border:"color",color:"color",width:"number",height:"number",dim:"number",alpha:"number",lineWidth:"number",angularWidth:"number",span:"number",valueArray:"array-number",dimArray:"array-number"},canvas:{globalAlpha:"number",fillStyle:"color",strokeStyle:"color",lineWidth:"number",shadowBlur:"number",shadowColor:"color",shadowOffsetX:"number",shadowOffsetY:"number",miterLimit:"number"},label:{size:"number",color:"color"},compute:function(F,E,D){return F+(E-F)*D},moebius:function(I,H,L,E){var G=E.scale(-L);if(G.norm()<1){var D=G.x,J=G.y;var F=I.startPos.getc().moebiusTransformation(G);I.pos.setc(F.x,F.y);G.x=D;G.y=J}},linear:function(E,D,H){var G=E.startPos.getc(true);var F=E.endPos.getc(true);E.pos.setc(this.compute(G.x,F.x,H),this.compute(G.y,F.y,H))},polar:function(F,E,I){var H=F.startPos.getp(true);var G=F.endPos.getp();var D=G.interpolate(H,I);F.pos.setp(D.theta,D.rho)},number:function(E,J,I,D,H){var G=E[D](J,"start");var F=E[D](J,"end");E[H](J,this.compute(G,F,I))},color:function(F,D,M,I,G){var J=d.hexToRgb(F[I](D,"start"));var L=d.hexToRgb(F[I](D,"end"));var H=this.compute;var E=d.rgbToHex([parseInt(H(J[0],L[0],M)),parseInt(H(J[1],L[1],M)),parseInt(H(J[2],L[2],M))]);F[G](D,E)},"array-number":function(G,F,R,O,I){var P=G[O](F,"start"),Q=G[O](F,"end"),S=[];for(var M=0,H=P.length;M<H;M++){var E=P[M],D=Q[M];if(E.length){for(var L=0,N=E.length,J=[];L<N;L++){J.push(this.compute(E[L],D[L],R))}S.push(J)}else{S.push(this.compute(E,D,R))}}G[I](F,S)},node:function(E,J,M,D,L,F){D=this[D];if(J){var I=J.length;for(var G=0;G<I;G++){var H=J[G];this[D[H]](E,H,M,L,F)}}else{for(var H in D){this[D[H]](E,H,M,L,F)}}},edge:function(F,E,L,G,D,J){var I=F.adjacencies;for(var H in I){this["node"](I[H],E,L,G,D,J)}},"node-property":function(E,D,F){this["node"](E,D,F,"map","getData","setData")},"edge-property":function(E,D,F){this["edge"](E,D,F,"map","getData","setData")},"label-property":function(E,D,F){this["node"](E,D,F,"label","getLabelData","setLabelData")},"node-style":function(E,D,F){this["node"](E,D,F,"canvas","getCanvasStyle","setCanvasStyle")},"edge-style":function(E,D,F){this["edge"](E,D,F,"canvas","getCanvasStyle","setCanvasStyle")}},sequence:function(E){var F=this;E=d.merge({condition:d.lambda(false),step:d.empty,onComplete:d.empty,duration:200},E||{});var D=setInterval(function(){if(E.condition()){E.step()}else{clearInterval(D);E.onComplete()}F.viz.refresh(true)},E.duration)},prepare:function(J){var I=this.viz.graph,G={"node-property":{getter:"getData",setter:"setData"},"edge-property":{getter:"getData",setter:"setData"},"node-style":{getter:"getCanvasStyle",setter:"setCanvasStyle"},"edge-style":{getter:"getCanvasStyle",setter:"setCanvasStyle"}};var E={};if(d.type(J)=="array"){for(var H=0,D=J.length;H<D;H++){var F=J[H].split(":");E[F.shift()]=F}}else{for(var L in J){if(L=="position"){E[J.position]=[]}else{E[L]=d.splat(J[L])}}}I.eachNode(function(M){M.startPos.set(M.pos);d.each(["node-property","node-style"],function(P){if(P in E){var Q=E[P];for(var O=0,N=Q.length;O<N;O++){M[G[P].setter](Q[O],M[G[P].getter](Q[O]),"start")}}});d.each(["edge-property","edge-style"],function(N){if(N in E){var O=E[N];M.eachAdjacency(function(Q){for(var R=0,P=O.length;R<P;R++){Q[G[N].setter](O[R],Q[G[N].getter](O[R]),"start")}})}})});return E},animate:function(G,F){G=d.merge(this.viz.config,G||{});var H=this,E=this.viz,J=E.graph,L=this.Interpolator,I=G.type==="nodefx"?this.nodeFxAnimation:this.animation;var D=this.prepare(G.modes);if(G.hideLabels){this.labels.hideLabels(true)}I.setOptions(d.merge(G,{$animating:false,compute:function(M){J.eachNode(function(N){for(var O in D){L[O](N,D[O],M,F)}});H.plot(G,this.$animating,M);this.$animating=true},complete:function(){if(G.hideLabels){H.labels.hideLabels(false)}H.plot(G);G.onComplete();G.onAfterCompute()}})).start()},nodeFx:function(F){var L=this.viz,M=L.graph,I=this.nodeFxAnimation,N=d.merge(this.viz.config,{elements:{id:false,properties:{}},reposition:false});F=d.merge(N,F||{},{onBeforeCompute:d.empty,onAfterCompute:d.empty});I.stopTimer();var J=F.elements.properties;if(!F.elements.id){M.eachNode(function(P){for(var O in J){P.setData(O,J[O],"end")}})}else{var D=d.splat(F.elements.id);d.each(D,function(Q){var P=M.getNode(Q);if(P){for(var O in J){P.setData(O,J[O],"end")}}})}var H=[];for(var E in J){H.push(E)}var G=["node-property:"+H.join(":")];if(F.reposition){G.push("linear");L.compute("end")}this.animate(d.merge(F,{modes:G,type:"nodefx"}))},plot:function(E,N){var L=this.viz,I=L.graph,F=L.canvas,D=L.root,J=this,M=F.getCtx(),H=Math.min,E=E||this.viz.controller;E.clearCanvas&&F.clear();var G=!!I.getNode(D).visited;I.eachNode(function(P){var O=P.getData("alpha");P.eachAdjacency(function(Q){var R=Q.nodeTo;if(!!R.visited===G&&P.drawn&&R.drawn){!N&&E.onBeforePlotLine(Q);M.save();M.globalAlpha=H(O,R.getData("alpha"),Q.getData("alpha"));J.plotLine(Q,F,N);M.restore();!N&&E.onAfterPlotLine(Q)}});M.save();if(P.drawn){!N&&E.onBeforePlotNode(P);J.plotNode(P,F,N);!N&&E.onAfterPlotNode(P)}if(!J.labelsHidden&&E.withLabels){if(P.drawn&&O>=0.95){J.labels.plotLabel(F,P,E)}else{J.labels.hideLabel(P,false)}}M.restore();P.visited=!G})},plotTree:function(H,E,M){var I=this,J=this.viz,F=J.canvas,G=this.config,L=F.getCtx();var D=H.getData("alpha");H.eachSubnode(function(O){if(E.plotSubtree(H,O)&&O.exist&&O.drawn){var N=H.getAdjacency(O.id);!M&&E.onBeforePlotLine(N);L.globalAlpha=Math.min(D,O.getData("alpha"));I.plotLine(N,F,M);!M&&E.onAfterPlotLine(N);I.plotTree(O,E,M)}});if(H.drawn){!M&&E.onBeforePlotNode(H);this.plotNode(H,F,M);!M&&E.onAfterPlotNode(H);if(!E.hideLabels&&E.withLabels&&D>=0.95){this.labels.plotLabel(F,H,E)}else{this.labels.hideLabel(H,false)}}else{this.labels.hideLabel(H,true)}},plotNode:function(F,E,N){var J=F.getData("type"),I=this.node.CanvasStyles;if(J!="none"){var D=F.getData("lineWidth"),H=F.getData("color"),G=F.getData("alpha"),L=E.getCtx();L.lineWidth=D;L.fillStyle=L.strokeStyle=H;L.globalAlpha=G;for(var M in I){L[M]=F.getCanvasStyle(M)}this.nodeTypes[J].render.call(this,F,E,N)}},plotLine:function(I,E,M){var H=I.getData("type"),G=this.edge.CanvasStyles;if(H!="none"){var D=I.getData("lineWidth"),F=I.getData("color"),J=E.getCtx();J.lineWidth=D;J.fillStyle=J.strokeStyle=F;for(var L in G){J[L]=I.getCanvasStyle(L)}this.edgeTypes[H].call(this,I,E,M)}}};f.Label={};f.Label.Native=new v({plotLabel:function(F,G,E){var D=F.getCtx();var H=G.pos.getc(true);D.font=G.getLabelData("style")+" "+G.getLabelData("size")+"px "+G.getLabelData("family");D.textAlign=G.getLabelData("textAlign");D.fillStyle=D.strokeStyle=G.getLabelData("color");D.textBaseline=G.getLabelData("textBaseline");this.renderLabel(F,G,E)},renderLabel:function(F,G,E){var D=F.getCtx();var H=G.pos.getc(true);D.fillText(G.name,H.x,H.y+G.getData("height")/2)},hideLabel:d.empty,hideLabels:d.empty});f.Label.DOM=new v({labelsHidden:false,labelContainer:false,labels:{},getLabelContainer:function(){return this.labelContainer?this.labelContainer:this.labelContainer=document.getElementById(this.viz.config.labelContainer)},getLabel:function(D){return(D in this.labels&&this.labels[D]!=null)?this.labels[D]:this.labels[D]=document.getElementById(D)},hideLabels:function(E){var D=this.getLabelContainer();if(E){D.style.display="none"}else{D.style.display=""}this.labelsHidden=E},clearLabels:function(D){for(var E in this.labels){if(D||!this.viz.graph.hasNode(E)){this.disposeLabel(E);delete this.labels[E]}}},disposeLabel:function(E){var D=this.getLabel(E);if(D&&D.parentNode){D.parentNode.removeChild(D)}},hideLabel:function(H,D){H=d.splat(H);var E=D?"":"none",F,G=this;d.each(H,function(J){var I=G.getLabel(J.id);if(I){I.style.display=E}})},fitsInCanvas:function(F,D){var E=D.getSize();if(F.x>=E.width||F.x<0||F.y>=E.height||F.y<0){return false}return true}});f.Label.HTML=new v({Implements:f.Label.DOM,plotLabel:function(G,H,F){var I=H.id,D=this.getLabel(I);if(!D&&!(D=document.getElementById(I))){D=document.createElement("div");var E=this.getLabelContainer();D.id=I;D.className="node";D.style.position="absolute";F.onCreateLabel(D,H);E.appendChild(D);this.labels[H.id]=D}this.placeLabel(D,H,F)}});f.Label.SVG=new v({Implements:f.Label.DOM,plotLabel:function(G,I,F){var L=I.id,D=this.getLabel(L);if(!D&&!(D=document.getElementById(L))){var H="http://www.w3.org/2000/svg";D=document.createElementNS(H,"svg:text");var J=document.createElementNS(H,"svg:tspan");D.appendChild(J);var E=this.getLabelContainer();D.setAttribute("id",L);D.setAttribute("class","node");E.appendChild(D);F.onCreateLabel(D,I);this.labels[I.id]=D}this.placeLabel(D,I,F)}});f.Geom=new v({initialize:function(D){this.viz=D;this.config=D.config;this.node=D.config.Node;this.edge=D.config.Edge},translate:function(E,D){D=d.splat(D);this.viz.graph.eachNode(function(F){d.each(D,function(G){F.getPos(G).$add(E)})})},setRightLevelToShow:function(G,D,I){var H=this.getRightLevelToShow(G,D),F=this.viz.labels,E=d.merge({execShow:true,execHide:true,onHide:d.empty,onShow:d.empty},I||{});G.eachLevel(0,this.config.levelsToShow,function(L){var J=L._depth-G._depth;if(J>H){E.onHide(L);if(E.execHide){L.drawn=false;L.exist=false;F.hideLabel(L,false)}}else{E.onShow(L);if(E.execShow){L.exist=true}}});G.drawn=true},getRightLevelToShow:function(G,E){var D=this.config;var H=D.levelsToShow;var F=D.constrained;if(!F){return H}while(!this.treeFitsInCanvas(G,E,H)&&H>1){H--}return H}});var e={construct:function(E){var F=(d.type(E)=="array");var D=new f(this.graphOptions,this.config.Node,this.config.Edge,this.config.Label);if(!F){(function(G,I){G.addNode(I);if(I.children){for(var H=0,J=I.children;H<J.length;H++){G.addAdjacence(I,J[H]);arguments.callee(G,J[H])}}})(D,E)}else{(function(P,Q){var H=function(U){for(var T=0,R=Q.length;T<R;T++){if(Q[T].id==U){return Q[T]}}var S={id:U,name:U};return P.addNode(S)};for(var M=0,I=Q.length;M<I;M++){P.addNode(Q[M]);var N=Q[M].adjacencies;if(N){for(var J=0,O=N.length;J<O;J++){var G=N[J],L={};if(typeof N[J]!="string"){L=G.data;G=G.nodeTo}P.addAdjacence(Q[M],H(G),L)}}}})(D,E)}return D},loadJSON:function(E,D){this.json=E;if(this.labels&&this.labels.clearLabels){this.labels.clearLabels(true)}this.graph=this.construct(E);if(d.type(E)!="array"){this.root=E.id}else{this.root=E[D?D:0].id}},toJSON:function(H){H=H||"tree";if(H=="tree"){var F={};var E=this.graph.getNode(this.root);var F=(function D(L){var I={};I.id=L.id;I.name=L.name;I.data=L.data;var J=[];L.eachSubnode(function(M){J.push(D(M))});I.children=J;return I})(E);return F}else{var F=[];var G=!!this.graph.getNode(this.root).visited;this.graph.eachNode(function(J){var I={};I.id=J.id;I.name=J.name;I.data=J.data;var L=[];J.eachAdjacency(function(M){var O=M.nodeTo;if(!!O.visited===G){var N={};N.nodeTo=O.id;N.data=M.data;L.push(N)}});I.adjacencies=L;F.push(I);J.visited=!G});return F}}};var i=$jit.Layouts={};var h={label:null,compute:function(G,H,E){this.initializeLabel(E);var D=this.label,F=D.style;G.eachNode(function(L){var P=L.getData("autoWidth"),Q=L.getData("autoHeight");if(P||Q){delete L.data.$width;delete L.data.$height;delete L.data.$dim;var I=L.getData("width"),R=L.getData("height");F.width=P?"auto":I+"px";F.height=Q?"auto":R+"px";D.innerHTML=L.name;var N=D.offsetWidth,J=D.offsetHeight;var O=L.getData("type");if(d.indexOf(["circle","square","triangle","star"],O)===-1){L.setData("width",N);L.setData("height",J)}else{var M=N>J?N:J;L.setData("width",M);L.setData("height",M);L.setData("dim",M)}}})},initializeLabel:function(D){if(!this.label){this.label=document.createElement("div");document.body.appendChild(this.label)}this.setLabelStyles(D)},setLabelStyles:function(D){d.extend(this.label.style,{visibility:"hidden",position:"absolute",width:"auto",height:"auto"});this.label.className="jit-autoadjust-label"}};i.Tree=(function(){var N=Array.prototype.slice;function L(X,S,P,V,Q){var U=S.Node;var R=S.multitree;if(U.overridable){var W=-1,T=-1;X.eachNode(function(aa){if(aa._depth==P&&(!R||("$orn" in aa.data)&&aa.data.$orn==V)){var Y=aa.getData("width",Q);var Z=aa.getData("height",Q);W=(W<Y)?Y:W;T=(T<Z)?Z:T}});return{width:W<0?U.width:W,height:T<0?U.height:T}}else{return U}}function O(Q,T,S,P){var R=(P=="left"||P=="right")?"y":"x";Q.getPos(T)[R]+=S}function I(Q,R){var P=[];d.each(Q,function(S){S=N.call(S);S[0]+=R;S[1]+=R;P.push(S)});return P}function M(S,P){if(S.length==0){return P}if(P.length==0){return S}var R=S.shift(),Q=P.shift();return[[R[0],Q[1]]].concat(M(S,P))}function G(P,Q){Q=Q||[];if(P.length==0){return Q}var R=P.pop();return G(P,M(R,Q))}function J(S,Q,T,P,R){if(S.length<=R||Q.length<=R){return 0}var V=S[R][1],U=Q[R][0];return Math.max(J(S,Q,T,P,++R)+T,V-U+P)}function H(S,Q,P){function R(V,X,U){if(X.length<=U){return[]}var W=X[U],T=J(V,W,Q,P,0);return[T].concat(R(M(V,I(W,T)),X,++U))}return R([],S,0)}function E(T,S,R){function P(W,Y,V){if(Y.length<=V){return[]}var X=Y[V],U=-J(X,W,S,R,0);return[U].concat(P(M(I(X,U),W),Y,++V))}T=N.call(T);var Q=P([],T.reverse(),0);return Q.reverse()}function D(V,T,Q,W){var R=H(V,T,Q),U=E(V,T,Q);if(W=="left"){U=R}else{if(W=="right"){R=U}}for(var S=0,P=[];S<R.length;S++){P[S]=(R[S]+U[S])/2}return P}function F(P,Z,Q,ag,ae){var S=ag.multitree;var Y=["x","y"],V=["width","height"];var R=+(ae=="left"||ae=="right");var W=Y[R],af=Y[1-R];var ab=ag.Node;var U=V[R],ad=V[1-R];var T=ag.siblingOffset;var ac=ag.subtreeOffset;var aa=ag.align;function X(aj,an,ar){var ai=aj.getData(U,Q);var aq=an||(aj.getData(ad,Q));var av=[],at=[],ao=false;var ah=aq+ag.levelDistance;aj.eachSubnode(function(ax){if(ax.exist&&(!S||("$orn" in ax.data)&&ax.data.$orn==ae)){if(!ao){ao=L(P,ag,ax._depth,ae,Q)}var aw=X(ax,ao[ad],ar+ah);av.push(aw.tree);at.push(aw.extent)}});var am=D(at,ac,T,aa);for(var al=0,ak=[],ap=[];al<av.length;al++){O(av[al],Q,am[al],ae);ap.push(I(at[al],am[al]))}var au=[[-ai/2,ai/2]].concat(G(ap));aj.getPos(Q)[W]=0;if(ae=="top"||ae=="left"){aj.getPos(Q)[af]=ar}else{aj.getPos(Q)[af]=-ar}return{tree:aj,extent:au}}X(Z,false,0)}return new v({compute:function(R,Q){var S=R||"start";var P=this.graph.getNode(this.root);d.extend(P,{drawn:true,exist:true,selected:true});h.compute(this.graph,S,this.config);if(!!Q||!("_depth" in P)){this.graph.computeLevels(this.root,0,"ignore")}this.computePositions(P,S)},computePositions:function(T,P){var R=this.config;var Q=R.multitree;var W=R.align;var S=W!=="center"&&R.indent;var X=R.orientation;var V=Q?["top","right","bottom","left"]:[X];var U=this;d.each(V,function(Y){F(U.graph,T,P,U.config,Y,P);var Z=["x","y"][+(Y=="left"||Y=="right")];(function aa(ab){ab.eachSubnode(function(ac){if(ac.exist&&(!Q||("$orn" in ac.data)&&ac.data.$orn==Y)){ac.getPos(P)[Z]+=ab.getPos(P)[Z];if(S){ac.getPos(P)[Z]+=W=="left"?S:-S}aa(ac)}})})(T)})}})})();$jit.ST=(function(){var E=[];function F(L){L=L||this.clickedNode;if(!this.config.constrained){return[]}var H=this.geom;var P=this.graph;var I=this.canvas;var G=L._depth,M=[];P.eachNode(function(Q){if(Q.exist&&!Q.selected){if(Q.isDescendantOf(L.id)){if(Q._depth<=G){M.push(Q)}}else{M.push(Q)}}});var N=H.getRightLevelToShow(L,I);L.eachLevel(N,N,function(Q){if(Q.exist&&!Q.selected){M.push(Q)}});for(var O=0;O<E.length;O++){var J=this.graph.getNode(E[O]);if(!J.isDescendantOf(L.id)){M.push(J)}}return M}function D(I){var H=[],G=this.config;I=I||this.clickedNode;this.clickedNode.eachLevel(0,G.levelsToShow,function(J){if(G.multitree&&!("$orn" in J.data)&&J.anySubnode(function(L){return L.exist&&!L.drawn})){H.push(J)}else{if(J.drawn&&!J.anySubnode("drawn")){H.push(J)}}});return H}return new v({Implements:[e,t,i.Tree],initialize:function(G){var I=$jit.ST;var H={levelsToShow:2,levelDistance:30,constrained:true,Node:{type:"rectangle"},duration:700,offsetX:0,offsetY:0};this.controller=this.config=d.merge(q("Canvas","Fx","Tree","Node","Edge","Controller","Tips","NodeStyles","Events","Navigation","Label"),H,G);var J=this.config;if(J.useCanvas){this.canvas=J.useCanvas;this.config.labelContainer=this.canvas.id+"-label"}else{if(J.background){J.background=d.merge({type:"Circles"},J.background)}this.canvas=new o(this,J);this.config.labelContainer=(typeof J.injectInto=="string"?J.injectInto:J.injectInto.id)+"-label"}this.graphOptions={complex:true};this.graph=new f(this.graphOptions,this.config.Node,this.config.Edge);this.labels=new I.Label[J.Label.type](this);this.fx=new I.Plot(this);this.op=new I.Op(this);this.group=new I.Group(this);this.geom=new I.Geom(this);this.clickedNode=null;this.initializeExtras()},plot:function(){this.fx.plot(this.controller)},switchPosition:function(M,L,J){var G=this.geom,H=this.fx,I=this;if(!H.busy){H.busy=true;this.contract({onComplete:function(){G.switchOrientation(M);I.compute("end",false);H.busy=false;if(L=="animate"){I.onClick(I.clickedNode.id,J)}else{if(L=="replot"){I.select(I.clickedNode.id,J)}}}},M)}},switchAlignment:function(I,H,G){this.config.align=I;if(H=="animate"){this.select(this.clickedNode.id,G)}else{if(H=="replot"){this.onClick(this.clickedNode.id,G)}}},addNodeInPath:function(G){E.push(G);this.select((this.clickedNode&&this.clickedNode.id)||this.root)},clearNodesInPath:function(G){E.length=0;this.select((this.clickedNode&&this.clickedNode.id)||this.root)},refresh:function(){this.reposition();this.select((this.clickedNode&&this.clickedNode.id)||this.root)},reposition:function(){this.graph.computeLevels(this.root,0,"ignore");this.geom.setRightLevelToShow(this.clickedNode,this.canvas);this.graph.eachNode(function(G){if(G.exist){G.drawn=true}});this.compute("end")},requestNodes:function(I,J){var H=d.merge(this.controller,J),G=this.config.levelsToShow;if(H.request){var M=[],L=I._depth;I.eachLevel(0,G,function(N){if(N.drawn&&!N.anySubnode()){M.push(N);N._level=G-(N._depth-L)}});this.group.requestNodes(M,H)}else{H.onComplete()}},contract:function(L,M){var J=this.config.orientation;var G=this.geom,I=this.group;if(M){G.switchOrientation(M)}var H=F.call(this);if(M){G.switchOrientation(J)}I.contract(H,d.merge(this.controller,L))},move:function(H,I){this.compute("end",false);var G=I.Move,J={x:G.offsetX,y:G.offsetY};if(G.enable){this.geom.translate(H.endPos.add(J).$scale(-1),"end")}this.fx.animate(d.merge(this.controller,{modes:["linear"]},I))},expand:function(H,I){var G=D.call(this,H);this.group.expand(G,d.merge(this.controller,I))},selectPath:function(J){var I=this;this.graph.eachNode(function(M){M.selected=false});function L(N){if(N==null||N.selected){return}N.selected=true;d.each(I.group.getSiblings([N])[N.id],function(O){O.exist=true;O.drawn=true});var M=N.getParents();M=(M.length>0)?M[0]:null;L(M)}for(var G=0,H=[J.id].concat(E);G<H.length;G++){L(this.graph.getNode(H[G]))}},setRoot:function(O,N,M){if(this.busy){return}this.busy=true;var L=this,I=this.canvas;var G=this.graph.getNode(this.root);var H=this.graph.getNode(O);function J(){if(this.config.multitree&&H.data.$orn){var Q=H.data.$orn;var R={left:"right",right:"left",top:"bottom",bottom:"top"}[Q];G.data.$orn=R;(function P(S){S.eachSubnode(function(T){if(T.id!=O){T.data.$orn=R;P(T)}})})(G);delete H.data.$orn}this.root=O;this.clickedNode=H;this.graph.computeLevels(this.root,0,"ignore");this.geom.setRightLevelToShow(H,I,{execHide:false,onShow:function(S){if(!S.drawn){S.drawn=true;S.setData("alpha",1,"end");S.setData("alpha",0);S.pos.setc(H.pos.x,H.pos.y)}}});this.compute("end");this.busy=true;this.fx.animate({modes:["linear","node-property:alpha"],onComplete:function(){L.busy=false;L.onClick(O,{onComplete:function(){M&&M.onComplete()}})}})}delete G.data.$orns;if(N=="animate"){J.call(this);L.selectPath(H)}else{if(N=="replot"){J.call(this);this.select(this.root)}}},addSubtree:function(G,I,H){if(I=="replot"){this.op.sum(G,d.extend({type:"replot"},H||{}))}else{if(I=="animate"){this.op.sum(G,d.extend({type:"fade:seq"},H||{}))}}},removeSubtree:function(M,H,L,J){var I=this.graph.getNode(M),G=[];I.eachLevel(+!H,false,function(N){G.push(N.id)});if(L=="replot"){this.op.removeNode(G,d.extend({type:"replot"},J||{}))}else{if(L=="animate"){this.op.removeNode(G,d.extend({type:"fade:seq"},J||{}))}}},select:function(G,J){var P=this.group,N=this.geom;var L=this.graph.getNode(G),I=this.canvas;var O=this.graph.getNode(this.root);var H=d.merge(this.controller,J);var M=this;H.onBeforeCompute(L);this.selectPath(L);this.clickedNode=L;this.requestNodes(L,{onComplete:function(){P.hide(P.prepare(F.call(M)),H);N.setRightLevelToShow(L,I);M.compute("current");M.graph.eachNode(function(S){var R=S.pos.getc(true);S.startPos.setc(R.x,R.y);S.endPos.setc(R.x,R.y);S.visited=false});var Q={x:H.offsetX,y:H.offsetY};M.geom.translate(L.endPos.add(Q).$scale(-1),["start","current","end"]);P.show(D.call(M));M.plot();H.onAfterCompute(M.clickedNode);H.onComplete()}})},onClick:function(H,P){var J=this.canvas,O=this,G=this.geom,L=this.config;var N={Move:{enable:true,offsetX:L.offsetX||0,offsetY:L.offsetY||0},setRightLevelToShowConfig:false,onBeforeRequest:d.empty,onBeforeContract:d.empty,onBeforeMove:d.empty,onBeforeExpand:d.empty};var I=d.merge(this.controller,N,P);if(!this.busy){this.busy=true;var M=this.graph.getNode(H);this.selectPath(M,this.clickedNode);this.clickedNode=M;I.onBeforeCompute(M);I.onBeforeRequest(M);this.requestNodes(M,{onComplete:function(){I.onBeforeContract(M);O.contract({onComplete:function(){G.setRightLevelToShow(M,J,I.setRightLevelToShowConfig);I.onBeforeMove(M);O.move(M,{Move:I.Move,onComplete:function(){I.onBeforeExpand(M);O.expand(M,{onComplete:function(){O.busy=false;I.onAfterCompute(H);I.onComplete()}})}})}})}})}}})})();$jit.ST.$extend=true;$jit.ST.Op=new v({Implements:f.Op,initialize:function(D){this.viz=D}});$jit.ST.Group=new v({initialize:function(D){this.viz=D;this.canvas=D.canvas;this.config=D.config;this.animation=new B;this.nodes=null},requestNodes:function(I,H){var G=0,E=I.length,L={};var F=function(){H.onComplete()};var D=this.viz;if(E==0){F()}for(var J=0;J<E;J++){L[I[J].id]=I[J];H.request(I[J].id,I[J]._level,{onComplete:function(N,M){if(M&&M.children){M.id=N;D.op.sum(M,{type:"nothing"})}if(++G==E){D.graph.computeLevels(D.root,0);F()}}})}},contract:function(F,E){var D=this.viz;var G=this;F=this.prepare(F);this.animation.setOptions(d.merge(E,{$animating:false,compute:function(H){if(H==1){H=0.99}G.plotStep(1-H,E,this.$animating);this.$animating="contract"},complete:function(){G.hide(F,E)}})).start()},hide:function(F,E){var D=this.viz;for(var G=0;G<F.length;G++){if(true||!E||!E.request){F[G].eachLevel(1,false,function(I){if(I.exist){d.extend(I,{drawn:false,exist:false})}})}else{var H=[];F[G].eachLevel(1,false,function(I){H.push(I.id)});D.op.removeNode(H,{type:"nothing"});D.labels.clearLabels()}}E.onComplete()},expand:function(E,D){var F=this;this.show(E);this.animation.setOptions(d.merge(D,{$animating:false,compute:function(G){F.plotStep(G,D,this.$animating);this.$animating="expand"},complete:function(){F.plotStep(undefined,D,false);D.onComplete()}})).start()},show:function(D){var E=this.config;this.prepare(D);d.each(D,function(G){if(E.multitree&&!("$orn" in G.data)){delete G.data.$orns;var F=" ";G.eachSubnode(function(H){if(("$orn" in H.data)&&F.indexOf(H.data.$orn)<0&&H.exist&&!H.drawn){F+=H.data.$orn+" "}});G.data.$orns=F}G.eachLevel(0,E.levelsToShow,function(H){if(H.exist){H.drawn=true}})})},prepare:function(D){this.nodes=this.getNodesWithChildren(D);return this.nodes},getNodesWithChildren:function(F){var E=[],H=this.config,D=this.viz.root;F.sort(function(M,L){return(M._depth<=L._depth)-(M._depth>=L._depth)});for(var I=0;I<F.length;I++){if(F[I].anySubnode("exist")){for(var G=I+1,J=false;!J&&G<F.length;G++){if(!H.multitree||"$orn" in F[G].data){J=J||F[I].isDescendantOf(F[G].id)}}if(!J){E.push(F[I])}}}return E},plotStep:function(O,J,Q){var N=this.viz,G=this.config,F=N.canvas,P=F.getCtx(),D=this.nodes;var I,H;var E={};for(I=0;I<D.length;I++){H=D[I];E[H.id]=[];var M=G.multitree&&!("$orn" in H.data);var L=M&&H.data.$orns;H.eachSubgraph(function(R){if(M&&L&&L.indexOf(R.data.$orn)>0&&R.drawn){R.drawn=false;E[H.id].push(R)}else{if((!M||!L)&&R.drawn){R.drawn=false;E[H.id].push(R)}}});H.drawn=true}if(D.length>0){N.fx.plot()}for(I in E){d.each(E[I],function(R){R.drawn=true})}for(I=0;I<D.length;I++){H=D[I];P.save();N.fx.plotSubtree(H,J,O,Q);P.restore()}},getSiblings:function(D){var E={};d.each(D,function(H){var G=H.getParents();if(G.length==0){E[H.id]=[H]}else{var F=[];G[0].eachSubnode(function(I){F.push(I)});E[H.id]=F}});return E}});$jit.ST.Geom=new v({Implements:f.Geom,switchOrientation:function(D){this.config.orientation=D},dispatch:function(){var E=Array.prototype.slice.call(arguments);var F=E.shift(),D=E.length;var G=function(H){return typeof H=="function"?H():H};if(D==2){return(F=="top"||F=="bottom")?G(E[0]):G(E[1])}else{if(D==4){switch(F){case"top":return G(E[0]);case"right":return G(E[1]);case"bottom":return G(E[2]);case"left":return G(E[3])}}}return undefined},getSize:function(L,J){var I=L.data,F=this.config;var E=F.siblingOffset;var H=(F.multitree&&("$orn" in I)&&I.$orn)||F.orientation;var D=L.getData("width")+E;var G=L.getData("height")+E;if(!J){return this.dispatch(H,G,D)}else{return this.dispatch(H,D,G)}},getTreeBaseSize:function(H,I,E){var F=this.getSize(H,true),D=0,G=this;if(E(I,H)){return F}if(I===0){return 0}H.eachSubnode(function(J){D+=G.getTreeBaseSize(J,I-1,E)});return(F>D?F:D)+this.config.subtreeOffset},getEdge:function(I,H,G){var E=function(M,L){return function(){return I.pos.add(new u(M,L))}};var J=this.node;var D=I.getData("width");var F=I.getData("height");if(H=="begin"){if(J.align=="center"){return this.dispatch(G,E(0,F/2),E(-D/2,0),E(0,-F/2),E(D/2,0))}else{if(J.align=="left"){return this.dispatch(G,E(0,F),E(0,0),E(0,0),E(D,0))}else{if(J.align=="right"){return this.dispatch(G,E(0,0),E(-D,0),E(0,-F),E(0,0))}else{throw"align: not implemented"}}}}else{if(H=="end"){if(J.align=="center"){return this.dispatch(G,E(0,-F/2),E(D/2,0),E(0,F/2),E(-D/2,0))}else{if(J.align=="left"){return this.dispatch(G,E(0,0),E(D,0),E(0,F),E(0,0))}else{if(J.align=="right"){return this.dispatch(G,E(0,-F),E(0,0),E(0,0),E(-D,0))}else{throw"align: not implemented"}}}}}},getScaledTreePosition:function(H,J){var I=this.node;var D=H.getData("width");var G=H.getData("height");var F=(this.config.multitree&&("$orn" in H.data)&&H.data.$orn)||this.config.orientation;var E=function(M,L){return function(){return H.pos.add(new u(M,L)).$scale(1-J)}};if(I.align=="left"){return this.dispatch(F,E(0,G),E(0,0),E(0,0),E(D,0))}else{if(I.align=="center"){return this.dispatch(F,E(0,G/2),E(-D/2,0),E(0,-G/2),E(D/2,0))}else{if(I.align=="right"){return this.dispatch(F,E(0,0),E(-D,0),E(0,-G),E(0,0))}else{throw"align: not implemented"}}}},treeFitsInCanvas:function(I,D,J){var F=D.getSize();var G=(this.config.multitree&&("$orn" in I.data)&&I.data.$orn)||this.config.orientation;var E=this.dispatch(G,F.width,F.height);var H=this.getTreeBaseSize(I,J,function(M,L){return M===0||!L.anySubnode()});return(H<E)}});$jit.ST.Plot=new v({Implements:f.Plot,initialize:function(D){this.viz=D;this.config=D.config;this.node=this.config.Node;this.edge=this.config.Edge;this.animation=new B;this.nodeTypes=new $jit.ST.Plot.NodeTypes;this.edgeTypes=new $jit.ST.Plot.EdgeTypes;this.labels=D.labels},plotSubtree:function(G,D,H,M){var J=this.viz,E=J.canvas,F=J.config;H=Math.min(Math.max(0.001,H),1);if(H>=0){G.drawn=false;var L=E.getCtx();var I=J.geom.getScaledTreePosition(G,H);L.translate(I.x,I.y);L.scale(H,H)}this.plotTree(G,d.merge(D,{withLabels:true,hideLabels:!!H,plotSubtree:function(Q,O){var N=F.multitree&&!("$orn" in G.data);var P=N&&G.getData("orns");return !N||P.indexOf(elem.getData("orn"))>-1}}),M);if(H>=0){G.drawn=true}},getAlignedPos:function(I,G,D){var F=this.node;var H,E;if(F.align=="center"){H={x:I.x-G/2,y:I.y-D/2}}else{if(F.align=="left"){E=this.config.orientation;if(E=="bottom"||E=="top"){H={x:I.x-G/2,y:I.y}}else{H={x:I.x,y:I.y-D/2}}}else{if(F.align=="right"){E=this.config.orientation;if(E=="bottom"||E=="top"){H={x:I.x-G/2,y:I.y-D}}else{H={x:I.x-G,y:I.y-D/2}}}else{throw"align: not implemented"}}}return H},getOrientation:function(D){var F=this.config;var E=F.orientation;if(F.multitree){var G=D.nodeFrom;var H=D.nodeTo;E=(("$orn" in G.data)&&G.data.$orn)||(("$orn" in H.data)&&H.data.$orn)}return E}});$jit.ST.Label={};$jit.ST.Label.Native=new v({Implements:f.Label.Native,renderLabel:function(F,G,E){var D=F.getCtx();var H=G.pos.getc(true);D.fillText(G.name,H.x,H.y)}});$jit.ST.Label.DOM=new v({Implements:f.Label.DOM,placeLabel:function(W,Q,M){var H=Q.pos.getc(true),V=this.viz.config,R=V.Node,D=this.viz.canvas,I=Q.getData("width"),T=Q.getData("height"),E=D.getSize(),N,U;var G=D.translateOffsetX,F=D.translateOffsetY,L=D.scaleOffsetX,J=D.scaleOffsetY,P=H.x*L+G,O=H.y*J+F;if(R.align=="center"){N={x:Math.round(P-I/2+E.width/2),y:Math.round(O-T/2+E.height/2)}}else{if(R.align=="left"){U=V.orientation;if(U=="bottom"||U=="top"){N={x:Math.round(P-I/2+E.width/2),y:Math.round(O+E.height/2)}}else{N={x:Math.round(P+E.width/2),y:Math.round(O-T/2+E.height/2)}}}else{if(R.align=="right"){U=V.orientation;if(U=="bottom"||U=="top"){N={x:Math.round(P-I/2+E.width/2),y:Math.round(O-T+E.height/2)}}else{N={x:Math.round(P-I+E.width/2),y:Math.round(O-T/2+E.height/2)}}}else{throw"align: not implemented"}}}var S=W.style;S.left=N.x+"px";S.top=N.y+"px";S.display=this.fitsInCanvas(N,D)?"":"none";M.onPlaceLabel(W,Q)}});$jit.ST.Label.SVG=new v({Implements:[$jit.ST.Label.DOM,f.Label.SVG],initialize:function(D){this.viz=D}});$jit.ST.Label.HTML=new v({Implements:[$jit.ST.Label.DOM,f.Label.HTML],initialize:function(D){this.viz=D}});$jit.ST.Plot.NodeTypes=new v({none:{render:d.empty,contains:d.lambda(false)},circle:{render:function(E,D){var G=E.getData("dim"),H=this.getAlignedPos(E.pos.getc(true),G,G),F=G/2;this.nodeHelper.circle.render("fill",{x:H.x+F,y:H.y+F},F,D)},contains:function(D,H){var F=D.getData("dim"),G=this.getAlignedPos(D.pos.getc(true),F,F),E=F/2;this.nodeHelper.circle.contains({x:G.x+E,y:G.y+E},E)}},square:{render:function(E,D){var G=E.getData("dim"),F=G/2,H=this.getAlignedPos(E.pos.getc(true),G,G);this.nodeHelper.square.render("fill",{x:H.x+F,y:H.y+F},F,D)},contains:function(D,H){var F=D.getData("dim"),G=this.getAlignedPos(D.pos.getc(true),F,F),E=F/2;this.nodeHelper.square.contains({x:G.x+E,y:G.y+E},E)}},ellipse:{render:function(G,E){var F=G.getData("width"),D=G.getData("height"),H=this.getAlignedPos(G.pos.getc(true),F,D);this.nodeHelper.ellipse.render("fill",{x:H.x+F/2,y:H.y+D/2},F,D,E)},contains:function(F,H){var E=F.getData("width"),D=F.getData("height"),G=this.getAlignedPos(F.pos.getc(true),E,D);this.nodeHelper.ellipse.contains({x:G.x+E/2,y:G.y+D/2},E,D,canvas)}},rectangle:{render:function(G,E){var F=G.getData("width"),D=G.getData("height"),H=this.getAlignedPos(G.pos.getc(true),F,D);this.nodeHelper.rectangle.render("fill",{x:H.x+F/2,y:H.y+D/2},F,D,E)},contains:function(F,H){var E=F.getData("width"),D=F.getData("height"),G=this.getAlignedPos(F.pos.getc(true),E,D);this.nodeHelper.rectangle.contains({x:G.x+E/2,y:G.y+D/2},E,D,canvas)}}});$jit.ST.Plot.EdgeTypes=new v({none:d.empty,line:function(E,G){var F=this.getOrientation(E),H=E.nodeFrom,I=E.nodeTo,D=H._depth<I._depth,L=this.viz.geom.getEdge(D?H:I,"begin",F),J=this.viz.geom.getEdge(D?I:H,"end",F);this.edgeHelper.line(L,J,G)},arrow:function(J,E){var I=this.getOrientation(J),F=J.nodeFrom,D=J.nodeTo,H=J.getData("dim"),M=this.viz.geom.getEdge(F,"begin",I),N=this.viz.geom.getEdge(D,"end",I),L=J.data.$direction,G=(L&&L.length>1&&L[0]!=F.id);this.edgeHelper.arrow(M,N,H,G,E)},"quadratic:begin":function(J,D){var I=this.getOrientation(J);var H=J.nodeFrom,L=J.nodeTo,N=H._depth<L._depth,E=this.viz.geom.getEdge(N?H:L,"begin",I),F=this.viz.geom.getEdge(N?L:H,"end",I),G=J.getData("dim"),M=D.getCtx();M.beginPath();M.moveTo(E.x,E.y);switch(I){case"left":M.quadraticCurveTo(E.x+G,E.y,F.x,F.y);break;case"right":M.quadraticCurveTo(E.x-G,E.y,F.x,F.y);break;case"top":M.quadraticCurveTo(E.x,E.y+G,F.x,F.y);break;case"bottom":M.quadraticCurveTo(E.x,E.y-G,F.x,F.y);break}M.stroke()},"quadratic:end":function(J,D){var I=this.getOrientation(J);var H=J.nodeFrom,L=J.nodeTo,N=H._depth<L._depth,E=this.viz.geom.getEdge(N?H:L,"begin",I),F=this.viz.geom.getEdge(N?L:H,"end",I),G=J.getData("dim"),M=D.getCtx();M.beginPath();M.moveTo(E.x,E.y);switch(I){case"left":M.quadraticCurveTo(F.x-G,F.y,F.x,F.y);break;case"right":M.quadraticCurveTo(F.x+G,F.y,F.x,F.y);break;case"top":M.quadraticCurveTo(F.x,F.y-G,F.x,F.y);break;case"bottom":M.quadraticCurveTo(F.x,F.y+G,F.x,F.y);break}M.stroke()},bezier:function(J,D){var I=this.getOrientation(J),H=J.nodeFrom,L=J.nodeTo,N=H._depth<L._depth,E=this.viz.geom.getEdge(N?H:L,"begin",I),F=this.viz.geom.getEdge(N?L:H,"end",I),G=J.getData("dim"),M=D.getCtx();M.beginPath();M.moveTo(E.x,E.y);switch(I){case"left":M.bezierCurveTo(E.x+G,E.y,F.x-G,F.y,F.x,F.y);break;case"right":M.bezierCurveTo(E.x-G,E.y,F.x+G,F.y,F.x,F.y);break;case"top":M.bezierCurveTo(E.x,E.y+G,F.x,F.y-G,F.x,F.y);break;case"bottom":M.bezierCurveTo(E.x,E.y-G,F.x,F.y+G,F.x,F.y);break}M.stroke()}});$jit.ST.Plot.NodeTypes.implement({"areachart-stacked":{render:function(ab,I){var Z=ab.pos.getc(true),D=ab.getData("width"),F=ab.getData("height"),M=this.getAlignedPos(Z,D,F),ag=M.x,af=M.y,R=ab.getData("stringArray"),L=ab.getData("dimArray"),G=ab.getData("valueArray"),ai=d.reduce(G,function(ao,ap){return ao+ap[0]},0),ah=d.reduce(G,function(ao,ap){return ao+ap[1]},0),O=ab.getData("colorArray"),H=O.length,ad=ab.getData("config"),P=ab.getData("gradient"),an=ad.showLabels,T=ad.showAggregates,aj=ad.Label,Y=ab.getData("prev");var S=I.getCtx(),N=ab.getData("border");if(O&&L&&R){for(var am=0,ak=L.length,Q=0,J=0,ac=0;am<ak;am++){S.fillStyle=S.strokeStyle=O[am%H];S.save();if(P&&(L[am][0]>0||L[am][1]>0)){var W=Q+L[am][0],U=J+L[am][1],al=Math.atan((U-W)/D),ae=55;var aa=S.createLinearGradient(ag+D/2,af-(W+U)/2,ag+D/2+ae*Math.sin(al),af-(W+U)/2+ae*Math.cos(al));var V=d.rgbToHex(d.map(d.hexToRgb(O[am%H].slice(1)),function(ao){return(ao*0.85)>>0}));aa.addColorStop(0,O[am%H]);aa.addColorStop(1,V);S.fillStyle=aa}S.beginPath();S.moveTo(ag,af-Q);S.lineTo(ag+D,af-J);S.lineTo(ag+D,af-J-L[am][1]);S.lineTo(ag,af-Q-L[am][0]);S.lineTo(ag,af-Q);S.fill();S.restore();if(N){var X=N.name==R[am];var E=X?0.7:0.8;var V=d.rgbToHex(d.map(d.hexToRgb(O[am%H].slice(1)),function(ao){return(ao*E)>>0}));S.strokeStyle=V;S.lineWidth=X?4:1;S.save();S.beginPath();if(N.index===0){S.moveTo(ag,af-Q);S.lineTo(ag,af-Q-L[am][0])}else{S.moveTo(ag+D,af-J);S.lineTo(ag+D,af-J-L[am][1])}S.stroke();S.restore()}Q+=(L[am][0]||0);J+=(L[am][1]||0);if(L[am][0]>0){ac+=(G[am][0]||0)}}if(Y&&aj.type=="Native"){S.save();S.beginPath();S.fillStyle=S.strokeStyle=aj.color;S.font=aj.style+" "+aj.size+"px "+aj.family;S.textAlign="center";S.textBaseline="middle";if(T(ab.name,ai,ah,ab)){S.fillText(ac,ag,af-Q-ad.labelOffset-aj.size/2,D)}if(an(ab.name,ai,ah,ab)){S.fillText(ab.name,ag,af+aj.size/2+ad.labelOffset)}S.restore()}}},contains:function(H,J){var P=H.pos.getc(true),E=H.getData("width"),T=H.getData("height"),S=this.getAlignedPos(P,E,T),R=S.x,Q=S.y,U=H.getData("dimArray"),D=J.x-R;if(J.x<R||J.x>R+E||J.y>Q||J.y<Q-T){return false}for(var L=0,I=U.length,O=Q,F=Q;L<I;L++){var G=U[L];O-=G[0];F-=G[1];var M=O+(F-O)*D/E;if(J.y>=M){var N=+(D>E/2);return{name:H.getData("stringArray")[L],color:H.getData("colorArray")[L],value:H.getData("valueArray")[L][N],index:N}}}return false}}});$jit.AreaChart=new v({st:null,colors:["#416D9C","#70A35E","#EBB056","#C74243","#83548B","#909291","#557EAA"],selected:{},busy:false,initialize:function(F){this.controller=this.config=d.merge(q("Canvas","Label","AreaChart"),{Label:{type:"Native"}},F);var G=this.config.showLabels,E=d.type(G),H=this.config.showAggregates,D=d.type(H);this.config.showLabels=E=="function"?G:d.lambda(G);this.config.showAggregates=D=="function"?H:d.lambda(H);this.initializeViz()},initializeViz:function(){var F=this.config,I=this,D=F.type.split(":")[0],H={};var E=new $jit.ST({injectInto:F.injectInto,orientation:"bottom",levelDistance:0,siblingOffset:0,subtreeOffset:0,withLabels:F.Label.type!="Native",useCanvas:F.useCanvas,Label:{type:F.Label.type},Node:{overridable:true,type:"areachart-"+D,align:"left",width:1,height:1},Edge:{type:"none"},Tips:{enable:F.Tips.enable,type:"Native",force:true,onShow:function(N,M,J){var L=J;F.Tips.onShow(N,L,M)}},Events:{enable:true,type:"Native",onClick:function(M,N,J){if(!F.filterOnClick&&!F.Events.enable){return}var L=N.getContains();if(L){F.filterOnClick&&I.filter(L.name)}F.Events.enable&&F.Events.onClick(L,N,J)},onRightClick:function(L,M,J){if(!F.restoreOnRightClick){return}I.restore()},onMouseMove:function(M,N,J){if(!F.selectOnHover){return}if(M){var L=N.getContains();I.select(M.id,L.name,L.index)}else{I.select(false,false,false)}}},onCreateLabel:function(Q,N){var W=F.Label,V=N.getData("valueArray"),O=d.reduce(V,function(X,Y){return X+Y[0]},0),T=d.reduce(V,function(X,Y){return X+Y[1]},0);if(N.getData("prev")){var S={wrapper:document.createElement("div"),aggregate:document.createElement("div"),label:document.createElement("div")};var J=S.wrapper,U=S.label,L=S.aggregate,M=J.style,R=U.style,P=L.style;H[N.id]=S;J.appendChild(U);J.appendChild(L);if(!F.showLabels(N.name,O,T,N)){U.style.display="none"}if(!F.showAggregates(N.name,O,T,N)){L.style.display="none"}M.position="relative";M.overflow="visible";M.fontSize=W.size+"px";M.fontFamily=W.family;M.color=W.color;M.textAlign="center";P.position=R.position="absolute";Q.style.width=N.getData("width")+"px";Q.style.height=N.getData("height")+"px";U.innerHTML=N.name;Q.appendChild(J)}},onPlaceLabel:function(ab,V){if(!V.getData("prev")){return}var Z=H[V.id],L=Z.wrapper.style,J=Z.label.style,U=Z.aggregate.style,S=V.getData("width"),Q=V.getData("height"),P=V.getData("dimArray"),M=V.getData("valueArray"),R=d.reduce(M,function(ac,ad){return ac+ad[0]},0),N=d.reduce(M,function(ac,ad){return ac+ad[1]},0),O=parseInt(L.fontSize,10),T=ab.style;if(P&&M){if(F.showLabels(V.name,R,N,V)){J.display=""}else{J.display="none"}if(F.showAggregates(V.name,R,N,V)){U.display=""}else{U.display="none"}L.width=U.width=J.width=ab.style.width=S+"px";U.left=J.left=-S/2+"px";for(var Y=0,W=M.length,X=0,aa=0;Y<W;Y++){if(P[Y][0]>0){X+=M[Y][0];aa+=P[Y][0]}}U.top=(-O-F.labelOffset)+"px";J.top=(F.labelOffset+aa)+"px";ab.style.top=parseInt(ab.style.top,10)-aa+"px";ab.style.height=L.height=aa+"px";Z.aggregate.innerHTML=X}}});var G=E.canvas.getSize();E.config.offsetY=-G.height/2+F.offset+(F.showLabels&&(F.labelOffset+F.Label.size));this.st=E;this.canvas=this.st.canvas},loadJSON:function(V){var S=d.time(),I=[],O=this.st,Y=d.splat(V.label),R=d.splat(V.color||this.colors),W=this.config,E=!!W.type.split(":")[1],G=W.animate;for(var T=0,F=V.values,Q=F.length;T<Q-1;T++){var X=F[T],M=F[T-1],N=F[T+1];var U=d.splat(F[T].values),D=d.splat(F[T+1].values);var H=d.zip(U,D);var L=0,J=0;I.push({id:S+X.label,name:X.label,data:{value:H,"$valueArray":H,"$colorArray":R,"$stringArray":Y,"$next":N.label,"$prev":M?M.label:null,"$config":W,"$gradient":E},children:[]})}var P={id:S+"$root",name:"",data:{"$type":"none","$width":1,"$height":1},children:I};O.loadJSON(P);this.normalizeDims();O.compute();O.select(O.root);if(G){O.fx.animate({modes:["node-property:height:dimArray"],duration:1500})}},updateJSON:function(G,J){if(this.busy){return}this.busy=true;var F=this.st,I=F.graph,L=G.label&&d.splat(G.label),E=G.values,D=this.config.animate,H=this;d.each(E,function(M){var R=I.getByName(M.label);if(R){M.values=d.splat(M.values);var N=R.getData("stringArray"),Q=R.getData("valueArray");d.each(Q,function(S,T){S[0]=M.values[T];if(L){N[T]=L[T]}});R.setData("valueArray",Q);var O=R.getData("prev");if(O){var P=I.getByName(O);var Q=P.getData("valueArray");d.each(Q,function(S,T){S[1]=M.values[T]});P.setData("valueArray",Q)}}});this.normalizeDims();F.compute();F.select(F.root);if(D){F.fx.animate({modes:["node-property:height:dimArray"],duration:1500,onComplete:function(){H.busy=false;J&&J.onComplete()}})}},filter:function(){if(this.busy){return}this.busy=true;if(this.config.Tips.enable){this.st.tips.hide()}this.select(false,false,false);var E=Array.prototype.slice.call(arguments);var D=this.st.graph.getNode(this.st.root);var F=this;D.eachAdjacency(function(G){var J=G.nodeTo,I=J.getData("dimArray"),H=J.getData("stringArray");J.setData("dimArray",d.map(I,function(M,L){return(d.indexOf(E,H[L])>-1)?M:[0,0]}),"end")});this.st.fx.animate({modes:["node-property:dimArray"],duration:1500,onComplete:function(){F.busy=false}})},restore:function(){if(this.busy){return}this.busy=true;if(this.config.Tips.enable){this.st.tips.hide()}this.select(false,false,false);this.normalizeDims();var D=this;this.st.fx.animate({modes:["node-property:height:dimArray"],duration:1500,onComplete:function(){D.busy=false}})},select:function(I,E,D){if(!this.config.selectOnHover){return}var F=this.selected;if(F.id!=I||F.name!=E||F.index!=D){F.id=I;F.name=E;F.index=D;this.st.graph.eachNode(function(J){J.setData("border",false)});if(I){var H=this.st.graph.getNode(I);H.setData("border",F);var G=D===0?"prev":"next";G=H.getData(G);if(G){H=this.st.graph.getByName(G);if(H){H.setData("border",{name:E,index:1-D})}}}this.st.plot()}},getLegend:function(){var F={};var G;this.st.graph.getNode(this.st.root).eachAdjacency(function(H){G=H.nodeTo});var E=G.getData("colorArray"),D=E.length;d.each(G.getData("stringArray"),function(I,H){F[I]=E[H%D]});return F},getMaxValue:function(){var D=0;this.st.graph.eachNode(function(I){var F=I.getData("valueArray"),E=0,H=0;d.each(F,function(J){E+=+J[0];H+=+J[1]});var G=H>E?H:E;D=D>G?D:G});return D},normalizeDims:function(){var J=this.st.graph.getNode(this.st.root),G=0;J.eachAdjacency(function(){G++});var I=this.getMaxValue(),N=this.st.canvas.getSize(),F=this.config,H=F.offset,L=F.labelOffset+F.Label.size,D=(N.width-2*H)/G,E=F.animate,M=N.height-2*H-(F.showAggregates&&L)-(F.showLabels&&L);this.st.graph.eachNode(function(T){var Q=0,S=0,O=[];d.each(T.getData("valueArray"),function(U){Q+=+U[0];S+=+U[1];O.push([0,0])});var R=S>Q?S:Q;T.setData("width",D);if(E){T.setData("height",R*M/I,"end");T.setData("dimArray",d.map(T.getData("valueArray"),function(U){return[U[0]*M/I,U[1]*M/I]}),"end");var P=T.getData("dimArray");if(!P){T.setData("dimArray",O)}}else{T.setData("height",R*M/I);T.setData("dimArray",d.map(T.getData("valueArray"),function(U){return[U[0]*M/I,U[1]*M/I]}))}})}});i.Radial=new v({compute:function(E){var F=d.splat(E||["current","start","end"]);h.compute(this.graph,F,this.config);this.graph.computeLevels(this.root,0,"ignore");var D=this.createLevelDistanceFunc();this.computeAngularWidths(F);this.computePositions(F,D)},computePositions:function(L,H){var N=L;var M=this.graph;var I=M.getNode(this.root);var J=this.parent;var D=this.config;for(var F=0,E=N.length;F<E;F++){var G=N[F];I.setPos(n(0,0),G);I.setData("span",Math.PI*2,G)}I.angleSpan={begin:0,end:2*Math.PI};M.eachBFS(this.root,function(S){var Y=S.angleSpan.end-S.angleSpan.begin;var aa=S.angleSpan.begin;var Z=H(S);var ab=0,O=[],R={};S.eachSubnode(function(ae){ab+=ae._treeAngularWidth;for(var af=0,ad=N.length;af<ad;af++){var ah=N[af],ag=ae.getData("dim",ah);R[ah]=(ah in R)?(ag>R[ah]?ag:R[ah]):ag}O.push(ae)},"ignore");if(J&&J.id==S.id&&O.length>0&&O[0].dist){O.sort(function(ae,ad){return(ae.dist>=ad.dist)-(ae.dist<=ad.dist)})}for(var U=0,W=O.length;U<W;U++){var Q=O[U];if(!Q._flag){var ac=Q._treeAngularWidth/ab*Y;var P=aa+ac/2;for(var V=0,T=N.length;V<T;V++){var X=N[V];Q.setPos(n(P,Z),X);Q.setData("span",ac,X);Q.setData("dim-quotient",Q.getData("dim",X)/R[X],X)}Q.angleSpan={begin:aa,end:aa+ac};aa+=ac}}},"ignore")},setAngularWidthForNodes:function(D){this.graph.eachBFS(this.root,function(G,E){var F=G.getData("angularWidth",D[0])||5;G._angularWidth=F/E},"ignore")},setSubtreesAngularWidth:function(){var D=this;this.graph.eachNode(function(E){D.setSubtreeAngularWidth(E)},"ignore")},setSubtreeAngularWidth:function(G){var F=this,E=G._angularWidth,D=0;G.eachSubnode(function(H){F.setSubtreeAngularWidth(H);D+=H._treeAngularWidth},"ignore");G._treeAngularWidth=Math.max(E,D)},computeAngularWidths:function(D){this.setAngularWidthForNodes(D);this.setSubtreesAngularWidth()}});u.prototype.moebiusTransformation=function(F){var D=this.add(F);var E=F.$conjugate().$prod(this);E.x++;return D.$div(E)};f.Util.moebiusTransformation=function(F,H,G,E,D){this.eachNode(F,function(J){for(var I=0;I<G.length;I++){var M=H[I].scale(-1),L=E?E:G[I];J.getPos(G[I]).set(J.getPos(L).getc().moebiusTransformation(M))}},D)};$jit.Hypertree=new v({Implements:[e,t,i.Radial],initialize:function(D){var G=$jit.Hypertree;var E={radius:"auto",offset:0,Edge:{type:"hyperline"},duration:1500,fps:35};this.controller=this.config=d.merge(q("Canvas","Node","Edge","Fx","Tips","NodeStyles","Events","Navigation","Controller","Label"),E,D);var F=this.config;if(F.useCanvas){this.canvas=F.useCanvas;this.config.labelContainer=this.canvas.id+"-label"}else{if(F.background){F.background=d.merge({type:"Circles"},F.background)}this.canvas=new o(this,F);this.config.labelContainer=(typeof F.injectInto=="string"?F.injectInto:F.injectInto.id)+"-label"}this.graphOptions={complex:false,Node:{selected:false,exist:true,drawn:true}};this.graph=new f(this.graphOptions,this.config.Node,this.config.Edge);this.labels=new G.Label[F.Label.type](this);this.fx=new G.Plot(this);this.op=new G.Op(this);this.json=null;this.root=null;this.busy=false;this.initializeExtras()},createLevelDistanceFunc:function(){var H=this.getRadius();var J=0,D=Math.max,E=this.config;this.graph.eachNode(function(L){J=D(L._depth,J)},"ignore");J++;var I=function(L){return function(N){N.scale=H;var P=N._depth+1;var O=0,M=Math.pow;while(P){O+=M(L,P--)}return O-E.offset}};for(var G=0.51;G<=1;G+=0.01){var F=(1-Math.pow(G,J))/(1-G);if(F>=2){return I(G-0.01)}}return I(0.75)},getRadius:function(){var D=this.config.radius;if(D!=="auto"){return D}var E=this.canvas.getSize();return Math.min(E.width,E.height)/2},refresh:function(D){if(D){this.reposition();this.graph.eachNode(function(E){E.startPos.rho=E.pos.rho=E.endPos.rho;E.startPos.theta=E.pos.theta=E.endPos.theta})}else{this.compute()}this.plot()},reposition:function(){this.compute("end");var D=this.graph.getNode(this.root).pos.getc().scale(-1);f.Util.moebiusTransformation(this.graph,[D],["end"],"end","ignore");this.graph.eachNode(function(E){if(E.ignore){E.endPos.rho=E.pos.rho;E.endPos.theta=E.pos.theta}})},plot:function(){this.fx.plot()},onClick:function(F,D){var E=this.graph.getNode(F).pos.getc(true);this.move(E,D)},move:function(H,F){var E=w(H.x,H.y);if(this.busy===false&&E.norm()<1){this.busy=true;var D=this.graph.getClosestNodeToPos(E),G=this;this.graph.computeLevels(D.id,0);this.controller.onBeforeCompute(D);F=d.merge({onComplete:d.empty},F||{});this.fx.animate(d.merge({modes:["moebius"],hideLabels:true},F,{onComplete:function(){G.busy=false;F.onComplete()}}),E)}}});$jit.Hypertree.$extend=true;(function(D){D.Op=new v({Implements:f.Op,initialize:function(E){this.viz=E}});D.Plot=new v({Implements:f.Plot,initialize:function(E){this.viz=E;this.config=E.config;this.node=this.config.Node;this.edge=this.config.Edge;this.animation=new B;this.nodeTypes=new D.Plot.NodeTypes;this.edgeTypes=new D.Plot.EdgeTypes;this.labels=E.labels}});D.Label={};D.Label.Native=new v({Implements:f.Label.Native,initialize:function(E){this.viz=E},renderLabel:function(G,I,F){var E=G.getCtx();var J=I.pos.getc(true);var H=this.viz.getRadius();E.fillText(I.name,J.x*H,J.y*H)}});D.Label.SVG=new v({Implements:f.Label.SVG,initialize:function(E){this.viz=E},placeLabel:function(Q,J,L){var O=J.pos.getc(true),G=this.viz.canvas,H=G.translateOffsetX,F=G.translateOffsetY,P=G.scaleOffsetX,N=G.scaleOffsetY,M=G.getSize(),E=this.viz.getRadius();var I={x:Math.round((O.x*P)*E+H+M.width/2),y:Math.round((O.y*N)*E+F+M.height/2)};Q.setAttribute("x",I.x);Q.setAttribute("y",I.y);L.onPlaceLabel(Q,J)}});D.Label.HTML=new v({Implements:f.Label.HTML,initialize:function(E){this.viz=E},placeLabel:function(R,L,M){var P=L.pos.getc(true),H=this.viz.canvas,I=H.translateOffsetX,G=H.translateOffsetY,Q=H.scaleOffsetX,O=H.scaleOffsetY,N=H.getSize(),E=this.viz.getRadius();var J={x:Math.round((P.x*Q)*E+I+N.width/2),y:Math.round((P.y*O)*E+G+N.height/2)};var F=R.style;F.left=J.x+"px";F.top=J.y+"px";F.display=this.fitsInCanvas(J,H)?"":"none";M.onPlaceLabel(R,L)}});D.Plot.NodeTypes=new v({none:{render:d.empty,contains:d.lambda(false)},circle:{render:function(G,E){var F=this.node,I=G.getData("dim"),H=G.pos.getc();I=F.transform?I*(1-H.squaredNorm()):I;H.$scale(G.scale);if(I>0.2){this.nodeHelper.circle.render("fill",H,I,E)}},contains:function(E,H){var F=E.getData("dim"),G=E.pos.getc().$scale(E.scale);return this.nodeHelper.circle.contains(G,H,F)}},ellipse:{render:function(H,F){var I=H.pos.getc().$scale(H.scale),G=H.getData("width"),E=H.getData("height");this.nodeHelper.ellipse.render("fill",I,G,E,F)},contains:function(G,I){var F=G.getData("width"),E=G.getData("height"),H=G.pos.getc().$scale(G.scale);return this.nodeHelper.circle.contains(H,I,F,E)}},square:{render:function(G,E){var F=this.node,I=G.getData("dim"),H=G.pos.getc();I=F.transform?I*(1-H.squaredNorm()):I;H.$scale(G.scale);if(I>0.2){this.nodeHelper.square.render("fill",H,I,E)}},contains:function(E,H){var F=E.getData("dim"),G=E.pos.getc().$scale(E.scale);return this.nodeHelper.square.contains(G,H,F)}},rectangle:{render:function(I,F){var H=this.node,G=I.getData("width"),E=I.getData("height"),J=I.pos.getc();G=H.transform?G*(1-J.squaredNorm()):G;E=H.transform?E*(1-J.squaredNorm()):E;J.$scale(I.scale);if(G>0.2&&E>0.2){this.nodeHelper.rectangle.render("fill",J,G,E,F)}},contains:function(G,I){var F=G.getData("width"),E=G.getData("height"),H=G.pos.getc().$scale(G.scale);return this.nodeHelper.square.contains(H,I,F,E)}},triangle:{render:function(G,E){var F=this.node,I=G.getData("dim"),H=G.pos.getc();I=F.transform?I*(1-H.squaredNorm()):I;H.$scale(G.scale);if(I>0.2){this.nodeHelper.triangle.render("fill",H,I,E)}},contains:function(E,H){var F=E.getData("dim"),G=E.pos.getc().$scale(E.scale);return this.nodeHelper.triangle.contains(G,H,F)}},star:{render:function(G,E){var F=this.node,I=G.getData("dim"),H=G.pos.getc();I=F.transform?I*(1-H.squaredNorm()):I;H.$scale(G.scale);if(I>0.2){this.nodeHelper.star.render("fill",H,I,E)}},contains:function(E,H){var F=E.getData("dim"),G=E.pos.getc().$scale(E.scale);return this.nodeHelper.star.contains(G,H,F)}}});D.Plot.EdgeTypes=new v({none:d.empty,line:function(E,F){var I=E.nodeFrom.pos.getc(true),H=E.nodeTo.pos.getc(true),G=E.nodeFrom.scale;this.edgeHelper.line({x:I.x*G,y:I.y*G},{x:H.x*G,y:H.y*G},F)},arrow:function(F,G){var M=F.nodeFrom.pos.getc(true),L=F.nodeTo.pos.getc(true),H=F.nodeFrom.scale,J=F.getData("dim"),I=F.data.$direction,E=(I&&I.length>1&&I[0]!=F.nodeFrom.id);this.edgeHelper.arrow({x:M.x*H,y:M.y*H},{x:L.x*H,y:L.y*H},J,E,G)},hyperline:function(E,F){var I=E.nodeFrom.pos.getc(),H=E.nodeTo.pos.getc(),G=this.viz.getRadius();this.edgeHelper.hyperline(I,H,G,F)}})})($jit.Hypertree);i.TM={};i.TM.SliceAndDice=new v({compute:function(I){var E=this.graph.getNode(this.clickedNode&&this.clickedNode.id||this.root);this.controller.onBeforeCompute(E);var G=this.canvas.getSize(),F=this.config,H=G.width,D=G.height;this.graph.computeLevels(this.root,0,"ignore");E.getPos(I).setc(-H/2,-D/2);E.setData("width",H,I);E.setData("height",D+F.titleHeight,I);this.computePositions(E,E,this.layout.orientation,I);this.controller.onAfterCompute(E)},computePositions:function(N,L,X,F){var U=0;N.eachSubnode(function(Z){U+=Z.getData("area",F)});var Y=this.config,V=Y.offset,R=N.getData("width",F),P=N.getData("height",F)-Y.titleHeight,E=N==L?1:(L.getData("area",F)/U);var Q,O,T,I,H,M,J;var W=(X=="h");if(W){X="v";Q=P;O=R*E;T="height";I="y";H="x";M=Y.titleHeight;J=0}else{X="h";Q=P*E;O=R;T="width";I="x";H="y";M=0;J=Y.titleHeight}var D=L.getPos(F);L.setData("width",O,F);L.setData("height",Q,F);var S=0,G=this;L.eachSubnode(function(aa){var Z=aa.getPos(F);Z[I]=S+D[I]+M;Z[H]=D[H]+J;G.computePositions(L,aa,X,F);S+=aa.getData(T,F)})}});i.TM.Area={compute:function(D){D=D||"current";var J=this.graph.getNode(this.clickedNode&&this.clickedNode.id||this.root);this.controller.onBeforeCompute(J);var F=this.config,N=this.canvas.getSize(),E=N.width,M=N.height,L=F.offset,G=E-L,I=M-L;this.graph.computeLevels(this.root,0,"ignore");J.getPos(D).setc(-E/2,-M/2);J.setData("width",E,D);J.setData("height",M,D);var H={top:-M/2+F.titleHeight,left:-E/2,width:G,height:I-F.titleHeight};this.computePositions(J,H,D);this.controller.onAfterCompute(J)},computeDim:function(H,I,L,G,F,D){if(H.length+I.length==1){var E=(H.length==1)?H:I;this.layoutLast(E,L,G,D);return}if(H.length>=2&&I.length==0){I=[H.shift()]}if(H.length==0){if(I.length>0){this.layoutRow(I,L,G,D)}return}var J=H[0];if(F(I,L)>=F([J].concat(I),L)){this.computeDim(H.slice(1),I.concat([J]),L,G,F,D)}else{var M=this.layoutRow(I,L,G,D);this.computeDim(H,[],M.dim,M,F,D)}},worstAspectRatio:function(D,M){if(!D||D.length==0){return Number.MAX_VALUE}var E=0,N=0,H=Number.MAX_VALUE;for(var J=0,I=D.length;J<I;J++){var F=D[J]._area;E+=F;H=H<F?H:F;N=N>F?N:F}var L=M*M,G=E*E;return Math.max(L*N/G,G/(L*H))},avgAspectRatio:function(H,E){if(!H||H.length==0){return Number.MAX_VALUE}var J=0;for(var F=0,D=H.length;F<D;F++){var I=H[F]._area;var G=I/E;J+=E>G?E/G:G/E}return J/D},layoutLast:function(E,D,H,G){var F=E[0];F.getPos(G).setc(H.left,H.top);F.setData("width",H.width,G);F.setData("height",H.height,G)}};i.TM.Squarified=new v({Implements:i.TM.Area,computePositions:function(H,L,E){var G=this.config;if(!(L.width>=L.height&&this.layout.horizontal())){this.layout.change()}var D=H.getSubnodes([1,1],"ignore");if(D.length>0){this.processChildrenLayout(H,D,L,E);for(var J=0,I=D.length;J<I;J++){var N=D[J];var O=G.offset,P=N.getData("height",E)-O-G.titleHeight,F=N.getData("width",E)-O;var M=N.getPos(E);L={width:F,height:P,top:M.y+G.titleHeight,left:M.x};this.computePositions(N,L,E)}}},processChildrenLayout:function(O,D,J,E){var H=J.width*J.height;var I,F=D.length,L=0,P=[];for(I=0;I<F;I++){P[I]=parseFloat(D[I].getData("area",E));L+=P[I]}for(I=0;I<F;I++){D[I]._area=H*P[I]/L}var G=this.layout.horizontal()?J.height:J.width;D.sort(function(R,Q){return(R._area<=Q._area)-(R._area>=Q._area)});var N=[D[0]];var M=D.slice(1);this.squarify(M,N,G,J,E)},squarify:function(E,H,D,G,F){this.computeDim(E,H,D,G,this.worstAspectRatio,F)},layoutRow:function(E,D,G,F){if(this.layout.horizontal()){return this.layoutV(E,D,G,F)}else{return this.layoutH(E,D,G,F)}},layoutV:function(D,P,L,E){var Q=0,G=function(R){return R};d.each(D,function(R){Q+=R._area});var F=G(Q/P),M=0;for(var I=0,H=D.length;I<H;I++){var J=G(D[I]._area/F);var N=D[I];N.getPos(E).setc(L.left,L.top+M);N.setData("width",F,E);N.setData("height",J,E);M+=J}var O={height:L.height,width:L.width-F,top:L.top,left:L.left+F};O.dim=Math.min(O.width,O.height);if(O.dim!=O.height){this.layout.change()}return O},layoutH:function(D,N,I,E){var P=0;d.each(D,function(Q){P+=Q._area});var O=P/N,J=I.top,F=0;for(var H=0,G=D.length;H<G;H++){var L=D[H];var N=L._area/O;L.getPos(E).setc(I.left+F,J);L.setData("width",N,E);L.setData("height",O,E);F+=N}var M={height:I.height-O,width:I.width,top:I.top+O,left:I.left};M.dim=Math.min(M.width,M.height);if(M.dim!=M.width){this.layout.change()}return M}});i.TM.Strip=new v({Implements:i.TM.Area,computePositions:function(H,L,E){var D=H.getSubnodes([1,1],"ignore"),G=this.config;if(D.length>0){this.processChildrenLayout(H,D,L,E);for(var J=0,I=D.length;J<I;J++){var N=D[J];var O=G.offset,P=N.getData("height",E)-O-G.titleHeight,F=N.getData("width",E)-O;var M=N.getPos(E);L={width:F,height:P,top:M.y+G.titleHeight,left:M.x};this.computePositions(N,L,E)}}},processChildrenLayout:function(O,D,I,E){var G=I.width*I.height;var H,F=D.length,J=0,P=[];for(H=0;H<F;H++){P[H]=+D[H].getData("area",E);J+=P[H]}for(H=0;H<F;H++){D[H]._area=G*P[H]/J}var N=this.layout.horizontal()?I.width:I.height;var M=[D[0]];var L=D.slice(1);this.stripify(L,M,N,I,E)},stripify:function(E,H,D,G,F){this.computeDim(E,H,D,G,this.avgAspectRatio,F)},layoutRow:function(E,D,G,F){if(this.layout.horizontal()){return this.layoutH(E,D,G,F)}else{return this.layoutV(E,D,G,F)}},layoutV:function(D,N,J,E){var O=0;d.each(D,function(P){O+=P._area});var F=O/N,L=0;for(var H=0,G=D.length;H<G;H++){var M=D[H];var I=M._area/F;M.getPos(E).setc(J.left,J.top+(N-I-L));M.setData("width",F,E);M.setData("height",I,E);L+=I}return{height:J.height,width:J.width-F,top:J.top,left:J.left+F,dim:N}},layoutH:function(D,M,I,E){var O=0;d.each(D,function(Q){O+=Q._area});var N=O/M,J=I.height-N,F=0;for(var H=0,G=D.length;H<G;H++){var L=D[H];var P=L._area/N;L.getPos(E).setc(I.left+F,I.top+J);L.setData("width",P,E);L.setData("height",N,E);F+=P}return{height:I.height-N,width:I.width,top:I.top,left:I.left,dim:M}}});i.Icicle=new v({compute:function(M){M=M||"current";var L=this.graph.getNode(this.root),G=this.config,P=this.canvas.getSize(),D=P.width,O=P.height,H=G.offset,J=G.constrained?G.levelsToShow:Number.MAX_VALUE;this.controller.onBeforeCompute(L);f.Util.computeLevels(this.graph,L.id,0,"ignore");var N=0;f.Util.eachLevel(L,0,false,function(R,Q){if(Q>N){N=Q}});var F=this.graph.getNode(this.clickedNode&&this.clickedNode.id||L.id);var E=Math.min(N,J-1);var I=F._depth;if(this.layout.horizontal()){this.computeSubtree(F,-D/2,-O/2,D/(E+1),O,I,E,M)}else{this.computeSubtree(F,-D/2,-O/2,D,O/(E+1),I,E,M)}},computeSubtree:function(M,O,L,D,R,J,F,N){M.getPos(N).setc(O,L);M.setData("width",D,N);M.setData("height",R,N);var H,Q=0,P=0;var E=f.Util.getSubnodes(M,[1,1]);if(!E.length){return}d.each(E,function(S){P+=S.getData("dim")});for(var I=0,G=E.length;I<G;I++){if(this.layout.horizontal()){H=R*E[I].getData("dim")/P;this.computeSubtree(E[I],O+D,L,D,H,J,F,N);L+=H}else{H=D*E[I].getData("dim")/P;this.computeSubtree(E[I],O,L+R,H,R,J,F,N);O+=H}}}});$jit.Icicle=new v({Implements:[e,t,i.Icicle],layout:{orientation:"h",vertical:function(){return this.orientation=="v"},horizontal:function(){return this.orientation=="h"},change:function(){this.orientation=this.vertical()?"h":"v"}},initialize:function(D){var E={animate:false,orientation:"h",offset:2,levelsToShow:Number.MAX_VALUE,constrained:false,Node:{type:"rectangle",overridable:true},Edge:{type:"none"},Label:{type:"Native"},duration:700,fps:45};var G=q("Canvas","Node","Edge","Fx","Tips","NodeStyles","Events","Navigation","Controller","Label");this.controller=this.config=d.merge(G,E,D);this.layout.orientation=this.config.orientation;var F=this.config;if(F.useCanvas){this.canvas=F.useCanvas;this.config.labelContainer=this.canvas.id+"-label"}else{this.canvas=new o(this,F);this.config.labelContainer=(typeof F.injectInto=="string"?F.injectInto:F.injectInto.id)+"-label"}this.graphOptions={complex:true,Node:{selected:false,exist:true,drawn:true}};this.graph=new f(this.graphOptions,this.config.Node,this.config.Edge,this.config.Label);this.labels=new $jit.Icicle.Label[this.config.Label.type](this);this.fx=new $jit.Icicle.Plot(this);this.op=new $jit.Icicle.Op(this);this.group=new $jit.Icicle.Group(this);this.clickedNode=null;this.initializeExtras()},refresh:function(){var D=this.config.Label.type;if(D!="Native"){var E=this;this.graph.eachNode(function(F){E.labels.hideLabel(F,false)})}this.compute();this.plot()},plot:function(){this.fx.plot(this.config)},enter:function(F){if(this.busy){return}this.busy=true;var E=this,D=this.config;var G={onComplete:function(){if(D.request){E.compute()}if(D.animate){E.graph.nodeList.setDataset(["current","end"],{alpha:[1,0]});f.Util.eachSubgraph(F,function(H){H.setData("alpha",1,"end")},"ignore");E.fx.animate({duration:500,modes:["node-property:alpha"],onComplete:function(){E.clickedNode=F;E.compute("end");E.fx.animate({modes:["linear","node-property:width:height"],duration:1000,onComplete:function(){E.busy=false;E.clickedNode=F}})}})}else{E.clickedNode=F;E.busy=false;E.refresh()}}};if(D.request){this.requestNodes(clickedNode,G)}else{G.onComplete()}},out:function(){if(this.busy){return}var I=this,H=f.Util,F=this.config,L=this.graph,E=H.getParents(L.getNode(this.clickedNode&&this.clickedNode.id||this.root)),G=E[0],D=G,J=this.clickedNode;this.busy=true;this.events.hoveredNode=false;if(!G){this.busy=false;return}callback={onComplete:function(){I.clickedNode=G;if(F.request){I.requestNodes(G,{onComplete:function(){I.compute();I.plot();I.busy=false}})}else{I.compute();I.plot();I.busy=false}}};if(F.animate){this.clickedNode=D;this.compute("end");this.clickedNode=J;this.fx.animate({modes:["linear","node-property:width:height"],duration:1000,onComplete:function(){I.clickedNode=D;L.nodeList.setDataset(["current","end"],{alpha:[0,1]});H.eachSubgraph(J,function(M){M.setData("alpha",1)},"ignore");I.fx.animate({duration:500,modes:["node-property:alpha"],onComplete:function(){callback.onComplete()}})}})}else{callback.onComplete()}},requestNodes:function(F,G){var E=d.merge(this.controller,G),D=this.config.constrained?this.config.levelsToShow:Number.MAX_VALUE;if(E.request){var I=[],H=F._depth;f.Util.eachLevel(F,0,D,function(J){if(J.drawn&&!f.Util.anySubnode(J)){I.push(J);J._level=J._depth-H;if(this.config.constrained){J._level=D-J._level}}});this.group.requestNodes(I,E)}else{E.onComplete()}}});$jit.Icicle.Op=new v({Implements:f.Op,initialize:function(D){this.viz=D}});$jit.Icicle.Group=new v({initialize:function(D){this.viz=D;this.canvas=D.canvas;this.config=D.config},requestNodes:function(I,H){var G=0,E=I.length,L={};var F=function(){H.onComplete()};var D=this.viz;if(E==0){F()}for(var J=0;J<E;J++){L[I[J].id]=I[J];H.request(I[J].id,I[J]._level,{onComplete:function(N,M){if(M&&M.children){M.id=N;D.op.sum(M,{type:"nothing"})}if(++G==E){f.Util.computeLevels(D.graph,D.root,0);F()}}})}}});$jit.Icicle.Plot=new v({Implements:f.Plot,initialize:function(D){this.viz=D;this.config=D.config;this.node=this.config.Node;this.edge=this.config.Edge;this.animation=new B;this.nodeTypes=new $jit.Icicle.Plot.NodeTypes;this.edgeTypes=new $jit.Icicle.Plot.EdgeTypes;this.labels=D.labels},plot:function(H,F){H=H||this.viz.controller;var D=this.viz,I=D.graph,E=I.getNode(D.clickedNode&&D.clickedNode.id||D.root),G=E._depth;D.canvas.clear();this.plotTree(E,d.merge(H,{withLabels:true,hideLabels:false,plotSubtree:function(J,L){return !D.config.constrained||(L._depth-G<D.config.levelsToShow)}}),F)}});$jit.Icicle.Label={};$jit.Icicle.Label.Native=new v({Implements:f.Label.Native,renderLabel:function(E,F,H){var L=E.getCtx(),D=F.getData("width"),J=F.getData("height"),M=F.getLabelData("size"),G=L.measureText(F.name);if(J<(M*1.5)||D<G.width){return}var I=F.pos.getc(true);L.fillText(F.name,I.x+D/2,I.y+J/2)}});$jit.Icicle.Label.SVG=new v({Implements:f.Label.SVG,initialize:function(D){this.viz=D},placeLabel:function(E,H,F){var J=H.pos.getc(true),G=this.viz.canvas;var D=G.getSize();var I={x:Math.round(J.x+D.width/2),y:Math.round(J.y+D.height/2)};E.setAttribute("x",I.x);E.setAttribute("y",I.y);F.onPlaceLabel(E,H)}});$jit.Icicle.Label.HTML=new v({Implements:f.Label.HTML,initialize:function(D){this.viz=D},placeLabel:function(E,I,F){var L=I.pos.getc(true),G=this.viz.canvas;var D=G.getSize();var J={x:Math.round(L.x+D.width/2),y:Math.round(L.y+D.height/2)};var H=E.style;H.left=J.x+"px";H.top=J.y+"px";H.display="";F.onPlaceLabel(E,I)}});$jit.Icicle.Plot.NodeTypes=new v({none:{render:d.empty},rectangle:{render:function(G,E,S){var F=this.viz.config;var J=F.offset;var D=G.getData("width");var P=G.getData("height");var I=G.getData("border");var O=G.pos.getc(true);var N=O.x+J/2,L=O.y+J/2;var R=E.getCtx();if(D-J<2||P-J<2){return}if(F.cushion){var H=G.getData("color");var Q=R.createRadialGradient(N+(D-J)/2,L+(P-J)/2,1,N+(D-J)/2,L+(P-J)/2,D<P?P:D);var M=d.rgbToHex(d.map(d.hexToRgb(H),function(T){return T*0.3>>0}));Q.addColorStop(0,H);Q.addColorStop(1,M);R.fillStyle=Q}if(I){R.strokeStyle=I;R.lineWidth=3}R.fillRect(N,L,Math.max(0,D-J),Math.max(0,P-J));I&&R.strokeRect(O.x,O.y,D,P)},contains:function(F,H){if(this.viz.clickedNode&&!$jit.Graph.Util.isDescendantOf(F,this.viz.clickedNode.id)){return false}var G=F.pos.getc(true),E=F.getData("width"),D=F.getData("height");return this.nodeHelper.rectangle.contains({x:G.x+E/2,y:G.y+D/2},H,E,D)}}});$jit.Icicle.Plot.EdgeTypes=new v({none:d.empty});$jit.RGraph=new v({Implements:[e,t,i.Radial],initialize:function(D){var E=$jit.RGraph;var F={interpolation:"linear",levelDistance:100};this.controller=this.config=d.merge(q("Canvas","Node","Edge","Fx","Controller","Tips","NodeStyles","Events","Navigation","Label"),F,D);var G=this.config;if(G.useCanvas){this.canvas=G.useCanvas;this.config.labelContainer=this.canvas.id+"-label"}else{if(G.background){G.background=d.merge({type:"Circles"},G.background)}this.canvas=new o(this,G);this.config.labelContainer=(typeof G.injectInto=="string"?G.injectInto:G.injectInto.id)+"-label"}this.graphOptions={complex:false,Node:{selected:false,exist:true,drawn:true}};this.graph=new f(this.graphOptions,this.config.Node,this.config.Edge);this.labels=new E.Label[G.Label.type](this);this.fx=new E.Plot(this);this.op=new E.Op(this);this.json=null;this.root=null;this.busy=false;this.parent=false;this.initializeExtras()},createLevelDistanceFunc:function(){var D=this.config.levelDistance;return function(E){return(E._depth+1)*D}},refresh:function(){this.compute();this.plot()},reposition:function(){this.compute("end")},plot:function(){this.fx.plot()},getNodeAndParentAngle:function(L){var F=false;var J=this.graph.getNode(L);var H=J.getParents();var G=(H.length>0)?H[0]:false;if(G){var D=G.pos.getc(),I=J.pos.getc();var E=D.add(I.scale(-1));F=Math.atan2(E.y,E.x);if(F<0){F+=2*Math.PI}}return{parent:G,theta:F}},tagChildren:function(H,J){if(H.angleSpan){var I=[];H.eachAdjacency(function(L){I.push(L.nodeTo)},"ignore");var D=I.length;for(var G=0;G<D&&J!=I[G].id;G++){}for(var F=(G+1)%D,E=0;J!=I[F].id;F=(F+1)%D){I[F].dist=E++}}},onClick:function(H,E){if(this.root!=H&&!this.busy){this.busy=true;this.root=H;that=this;this.controller.onBeforeCompute(this.graph.getNode(H));var F=this.getNodeAndParentAngle(H);this.tagChildren(F.parent,H);this.parent=F.parent;this.compute("end");var D=F.theta-F.parent.endPos.theta;this.graph.eachNode(function(I){I.endPos.set(I.endPos.getp().add(n(D,0)))});var G=this.config.interpolation;E=d.merge({onComplete:d.empty},E||{});this.fx.animate(d.merge({hideLabels:true,modes:[G]},E,{onComplete:function(){that.busy=false;E.onComplete()}}))}}});$jit.RGraph.$extend=true;(function(D){D.Op=new v({Implements:f.Op,initialize:function(E){this.viz=E}});D.Plot=new v({Implements:f.Plot,initialize:function(E){this.viz=E;this.config=E.config;this.node=E.config.Node;this.edge=E.config.Edge;this.animation=new B;this.nodeTypes=new D.Plot.NodeTypes;this.edgeTypes=new D.Plot.EdgeTypes;this.labels=E.labels}});D.Label={};D.Label.Native=new v({Implements:f.Label.Native});D.Label.SVG=new v({Implements:f.Label.SVG,initialize:function(E){this.viz=E},placeLabel:function(P,I,J){var N=I.pos.getc(true),F=this.viz.canvas,G=F.translateOffsetX,E=F.translateOffsetY,O=F.scaleOffsetX,M=F.scaleOffsetY,L=F.getSize();var H={x:Math.round(N.x*O+G+L.width/2),y:Math.round(N.y*M+E+L.height/2)};P.setAttribute("x",H.x);P.setAttribute("y",H.y);J.onPlaceLabel(P,I)}});D.Label.HTML=new v({Implements:f.Label.HTML,initialize:function(E){this.viz=E},placeLabel:function(Q,J,L){var O=J.pos.getc(true),G=this.viz.canvas,H=G.translateOffsetX,F=G.translateOffsetY,P=G.scaleOffsetX,N=G.scaleOffsetY,M=G.getSize();var I={x:Math.round(O.x*P+H+M.width/2),y:Math.round(O.y*N+F+M.height/2)};var E=Q.style;E.left=I.x+"px";E.top=I.y+"px";E.display=this.fitsInCanvas(I,G)?"":"none";L.onPlaceLabel(Q,J)}});D.Plot.NodeTypes=new v({none:{render:d.empty,contains:d.lambda(false)},circle:{render:function(F,E){var H=F.pos.getc(true),G=F.getData("dim");this.nodeHelper.circle.render("fill",H,G,E)},contains:function(E,H){var G=E.pos.getc(true),F=E.getData("dim");return this.nodeHelper.circle.contains(G,H,F)}},ellipse:{render:function(H,F){var I=H.pos.getc(true),G=H.getData("width"),E=H.getData("height");this.nodeHelper.ellipse.render("fill",I,G,E,F)},contains:function(G,I){var H=G.pos.getc(true),F=G.getData("width"),E=G.getData("height");return this.nodeHelper.ellipse.contains(H,I,F,E)}},square:{render:function(F,E){var H=F.pos.getc(true),G=F.getData("dim");this.nodeHelper.square.render("fill",H,G,E)},contains:function(E,H){var G=E.pos.getc(true),F=E.getData("dim");return this.nodeHelper.square.contains(G,H,F)}},rectangle:{render:function(H,F){var I=H.pos.getc(true),G=H.getData("width"),E=H.getData("height");this.nodeHelper.rectangle.render("fill",I,G,E,F)},contains:function(G,I){var H=G.pos.getc(true),F=G.getData("width"),E=G.getData("height");return this.nodeHelper.rectangle.contains(H,I,F,E)}},triangle:{render:function(F,E){var H=F.pos.getc(true),G=F.getData("dim");this.nodeHelper.triangle.render("fill",H,G,E)},contains:function(E,H){var G=E.pos.getc(true),F=E.getData("dim");return this.nodeHelper.triangle.contains(G,H,F)}},star:{render:function(F,E){var H=F.pos.getc(true),G=F.getData("dim");this.nodeHelper.star.render("fill",H,G,E)},contains:function(E,H){var G=E.pos.getc(true),F=E.getData("dim");return this.nodeHelper.star.contains(G,H,F)}}});D.Plot.EdgeTypes=new v({none:d.empty,line:function(E,F){var H=E.nodeFrom.pos.getc(true),G=E.nodeTo.pos.getc(true);this.edgeHelper.line(H,G,F)},arrow:function(F,G){var L=F.nodeFrom.pos.getc(true),J=F.nodeTo.pos.getc(true),I=F.getData("dim"),H=F.data.$direction,E=(H&&H.length>1&&H[0]!=F.nodeFrom.id);this.edgeHelper.arrow(L,J,I,E,G)}})})($jit.RGraph);i.ForceDirected=new v({getOptions:function(J){var H=this.canvas.getSize();var E=H.width,G=H.height;var I=0;this.graph.eachNode(function(M){I++});var L=E*G/I,F=Math.sqrt(L);var D=this.config.levelDistance;return{width:E,height:G,tstart:E*0.1,nodef:function(M){return L/(M||1)},edgef:function(M){return F*(M-D)}}},compute:function(E,F){var G=d.splat(E||["current","start","end"]);var D=this.getOptions();h.compute(this.graph,G,this.config);this.graph.computeLevels(this.root,0,"ignore");this.graph.eachNode(function(H){d.each(G,function(I){var J=H.getPos(I);if(J.equals(u.KER)){J.x=D.width/5*(Math.random()-0.5);J.y=D.height/5*(Math.random()-0.5)}H.disp={};d.each(G,function(L){H.disp[L]=w(0,0)})})});this.computePositions(G,D,F)},computePositions:function(H,F,I){var J=this.config.iterations,E=0,G=this;if(I){(function D(){for(var M=I.iter,L=0;L<M;L++){F.t=F.tstart*(1-E++/(J-1));G.computePositionStep(H,F);if(E>=J){I.onComplete();return}}I.onStep(Math.round(E/(J-1)*100));setTimeout(D,1)})()}else{for(;E<J;E++){F.t=F.tstart*(1-E/(J-1));this.computePositionStep(H,F)}}},computePositionStep:function(L,D){var M=this.graph;var F=Math.min,J=Math.max;var I=w(0,0);M.eachNode(function(O){d.each(L,function(P){O.disp[P].x=0;O.disp[P].y=0});M.eachNode(function(P){if(P.id!=O.id){d.each(L,function(T){var R=O.getPos(T),Q=P.getPos(T);I.x=R.x-Q.x;I.y=R.y-Q.y;var S=I.norm()||1;O.disp[T].$add(I.$scale(D.nodef(S)/S))})}})});var E=!!M.getNode(this.root).visited;M.eachNode(function(O){O.eachAdjacency(function(P){var Q=P.nodeTo;if(!!Q.visited===E){d.each(L,function(U){var S=O.getPos(U),R=Q.getPos(U);I.x=S.x-R.x;I.y=S.y-R.y;var T=I.norm()||1;O.disp[U].$add(I.$scale(-D.edgef(T)/T));Q.disp[U].$add(I.$scale(-1))})}});O.visited=!E});var N=D.t,G=D.width/2,H=D.height/2;M.eachNode(function(O){d.each(L,function(R){var P=O.disp[R];var Q=P.norm()||1;var R=O.getPos(R);R.$add(w(P.x*F(Math.abs(P.x),N)/Q,P.y*F(Math.abs(P.y),N)/Q));R.x=F(G,J(-G,R.x));R.y=F(H,J(-H,R.y))})})}});$jit.ForceDirected=new v({Implements:[e,t,i.ForceDirected],initialize:function(E){var D=$jit.ForceDirected;var F={iterations:50,levelDistance:50};this.controller=this.config=d.merge(q("Canvas","Node","Edge","Fx","Tips","NodeStyles","Events","Navigation","Controller","Label"),F,E);var G=this.config;if(G.useCanvas){this.canvas=G.useCanvas;this.config.labelContainer=this.canvas.id+"-label"}else{if(G.background){G.background=d.merge({type:"Circles"},G.background)}this.canvas=new o(this,G);this.config.labelContainer=(typeof G.injectInto=="string"?G.injectInto:G.injectInto.id)+"-label"}this.graphOptions={complex:true,Node:{selected:false,exist:true,drawn:true}};this.graph=new f(this.graphOptions,this.config.Node,this.config.Edge);this.labels=new D.Label[G.Label.type](this);this.fx=new D.Plot(this);this.op=new D.Op(this);this.json=null;this.busy=false;this.initializeExtras()},refresh:function(){this.compute();this.plot()},reposition:function(){this.compute("end")},computeIncremental:function(D){D=d.merge({iter:20,property:"end",onStep:d.empty,onComplete:d.empty},D||{});this.config.onBeforeCompute(this.graph.getNode(this.root));this.compute(D.property,D)},plot:function(){this.fx.plot()},animate:function(D){this.fx.animate(d.merge({modes:["linear"]},D||{}))}});$jit.ForceDirected.$extend=true;(function(D){D.Op=new v({Implements:f.Op,initialize:function(E){this.viz=E}});D.Plot=new v({Implements:f.Plot,initialize:function(E){this.viz=E;this.config=E.config;this.node=E.config.Node;this.edge=E.config.Edge;this.animation=new B;this.nodeTypes=new D.Plot.NodeTypes;this.edgeTypes=new D.Plot.EdgeTypes;this.labels=E.labels}});D.Label={};D.Label.Native=new v({Implements:f.Label.Native});D.Label.SVG=new v({Implements:f.Label.SVG,initialize:function(E){this.viz=E},placeLabel:function(P,I,J){var N=I.pos.getc(true),F=this.viz.canvas,G=F.translateOffsetX,E=F.translateOffsetY,O=F.scaleOffsetX,M=F.scaleOffsetY,L=F.getSize();var H={x:Math.round(N.x*O+G+L.width/2),y:Math.round(N.y*M+E+L.height/2)};P.setAttribute("x",H.x);P.setAttribute("y",H.y);J.onPlaceLabel(P,I)}});D.Label.HTML=new v({Implements:f.Label.HTML,initialize:function(E){this.viz=E},placeLabel:function(Q,J,L){var O=J.pos.getc(true),G=this.viz.canvas,H=G.translateOffsetX,F=G.translateOffsetY,P=G.scaleOffsetX,N=G.scaleOffsetY,M=G.getSize();var I={x:Math.round(O.x*P+H+M.width/2),y:Math.round(O.y*N+F+M.height/2)};var E=Q.style;E.left=I.x+"px";E.top=I.y+"px";E.display=this.fitsInCanvas(I,G)?"":"none";L.onPlaceLabel(Q,J)}});D.Plot.NodeTypes=new v({none:{render:d.empty,contains:d.lambda(false)},circle:{render:function(F,E){var H=F.pos.getc(true),G=F.getData("dim");this.nodeHelper.circle.render("fill",H,G,E)},contains:function(E,H){var G=E.pos.getc(true),F=E.getData("dim");return this.nodeHelper.circle.contains(G,H,F)}},ellipse:{render:function(H,F){var I=H.pos.getc(true),G=H.getData("width"),E=H.getData("height");this.nodeHelper.ellipse.render("fill",I,G,E,F)},contains:function(G,I){var H=G.pos.getc(true),F=G.getData("width"),E=G.getData("height");return this.nodeHelper.ellipse.contains(H,I,F,E)}},square:{render:function(F,E){var H=F.pos.getc(true),G=F.getData("dim");this.nodeHelper.square.render("fill",H,G,E)},contains:function(E,H){var G=E.pos.getc(true),F=E.getData("dim");return this.nodeHelper.square.contains(G,H,F)}},rectangle:{render:function(H,F){var I=H.pos.getc(true),G=H.getData("width"),E=H.getData("height");this.nodeHelper.rectangle.render("fill",I,G,E,F)},contains:function(G,I){var H=G.pos.getc(true),F=G.getData("width"),E=G.getData("height");return this.nodeHelper.rectangle.contains(H,I,F,E)}},triangle:{render:function(F,E){var H=F.pos.getc(true),G=F.getData("dim");this.nodeHelper.triangle.render("fill",H,G,E)},contains:function(E,H){var G=E.pos.getc(true),F=E.getData("dim");return this.nodeHelper.triangle.contains(G,H,F)}},star:{render:function(F,E){var H=F.pos.getc(true),G=F.getData("dim");this.nodeHelper.star.render("fill",H,G,E)},contains:function(E,H){var G=E.pos.getc(true),F=E.getData("dim");return this.nodeHelper.star.contains(G,H,F)}}});D.Plot.EdgeTypes=new v({none:d.empty,line:function(E,F){var H=E.nodeFrom.pos.getc(true),G=E.nodeTo.pos.getc(true);this.edgeHelper.line(H,G,F)},arrow:function(F,G){var L=F.nodeFrom.pos.getc(true),J=F.nodeTo.pos.getc(true),I=F.getData("dim"),H=F.data.$direction,E=(H&&H.length>1&&H[0]!=F.nodeFrom.id);this.edgeHelper.arrow(L,J,I,E,G)}})})($jit.ForceDirected);$jit.TM={};var C=$jit.TM;$jit.TM.$extend=true;C.Base={layout:{orientation:"h",vertical:function(){return this.orientation=="v"},horizontal:function(){return this.orientation=="h"},change:function(){this.orientation=this.vertical()?"h":"v"}},initialize:function(D){var E={orientation:"h",titleHeight:13,offset:2,levelsToShow:3,constrained:false,animate:false,Node:{type:"rectangle",overridable:true,width:3,height:3,color:"#444"},Label:{textAlign:"center",textBaseline:"top"},Edge:{type:"none"},duration:700,fps:45};this.controller=this.config=d.merge(q("Canvas","Node","Edge","Fx","Controller","Tips","NodeStyles","Events","Navigation","Label"),E,D);this.layout.orientation=this.config.orientation;var F=this.config;if(F.useCanvas){this.canvas=F.useCanvas;this.config.labelContainer=this.canvas.id+"-label"}else{if(F.background){F.background=d.merge({type:"Circles"},F.background)}this.canvas=new o(this,F);this.config.labelContainer=(typeof F.injectInto=="string"?F.injectInto:F.injectInto.id)+"-label"}this.graphOptions={complex:true,Node:{selected:false,exist:true,drawn:true}};this.graph=new f(this.graphOptions,this.config.Node,this.config.Edge);this.labels=new C.Label[F.Label.type](this);this.fx=new C.Plot(this);this.op=new C.Op(this);this.group=new C.Group(this);this.geom=new C.Geom(this);this.clickedNode=null;this.busy=false;this.initializeExtras()},refresh:function(){if(this.busy){return}this.busy=true;var E=this;if(this.config.animate){this.compute("end");this.geom.setRightLevelToShow(this.graph.getNode(this.root));this.fx.animate(d.merge(this.config,{modes:["linear","node-property:width:height"],onComplete:function(){E.busy=false}}))}else{var D=this.config.Label.type;if(D!="Native"){var E=this;this.graph.eachNode(function(F){E.labels.hideLabel(F,false)})}this.busy=false;this.compute();this.plot()}},plot:function(){this.fx.plot()},leaf:function(D){return D.getSubnodes([1,1],"ignore").length==0},enter:function(J){if(this.busy){return}this.busy=true;var F=this,E=this.config,H=this.graph,D=J,G=this.clickedNode;var I={onComplete:function(){if(E.levelsToShow>0){F.geom.setRightLevelToShow(J)}if(E.request){F.compute()}if(E.animate){H.nodeList.setDataset(["current","end"],{alpha:[1,0]});J.eachSubgraph(function(L){L.setData("alpha",1,"end")},"ignore");F.fx.animate({duration:500,modes:["node-property:alpha"],onComplete:function(){F.clickedNode=D;F.compute("end");F.clickedNode=G;F.fx.animate({modes:["linear","node-property:width:height"],duration:1000,onComplete:function(){F.busy=false;F.clickedNode=D}})}})}else{F.busy=false;F.clickedNode=J;F.refresh()}}};if(E.request){this.requestNodes(D,I)}else{I.onComplete()}},out:function(){if(this.busy){return}this.busy=true;this.events.hoveredNode=false;var H=this,F=this.config,J=this.graph,E=J.getNode(this.clickedNode&&this.clickedNode.id||this.root).getParents(),G=E[0],D=G,I=this.clickedNode;if(!G){this.busy=false;return}callback={onComplete:function(){H.clickedNode=G;if(F.request){H.requestNodes(G,{onComplete:function(){H.compute();H.plot();H.busy=false}})}else{H.compute();H.plot();H.busy=false}}};if(F.levelsToShow>0){this.geom.setRightLevelToShow(G)}if(F.animate){this.clickedNode=D;this.compute("end");this.clickedNode=I;this.fx.animate({modes:["linear","node-property:width:height"],duration:1000,onComplete:function(){H.clickedNode=D;J.nodeList.setDataset(["current","end"],{alpha:[0,1]});I.eachSubgraph(function(L){L.setData("alpha",1)},"ignore");H.fx.animate({duration:500,modes:["node-property:alpha"],onComplete:function(){callback.onComplete()}})}})}else{callback.onComplete()}},requestNodes:function(F,G){var E=d.merge(this.controller,G),D=this.config.levelsToShow;if(E.request){var I=[],H=F._depth;F.eachLevel(0,D,function(L){var J=D-(L._depth-H);if(L.drawn&&!L.anySubnode()&&J>0){I.push(L);L._level=J}});this.group.requestNodes(I,E)}else{E.onComplete()}}};C.Op=new v({Implements:f.Op,initialize:function(D){this.viz=D}});C.Geom=new v({Implements:f.Geom,getRightLevelToShow:function(){return this.viz.config.levelsToShow},setRightLevelToShow:function(E){var F=this.getRightLevelToShow(),D=this.viz.labels;E.eachLevel(0,F+1,function(H){var G=H._depth-E._depth;if(G>F){H.drawn=false;H.exist=false;H.ignore=true;D.hideLabel(H,false)}else{H.drawn=true;H.exist=true;delete H.ignore}});E.drawn=true;delete E.ignore}});C.Group=new v({initialize:function(D){this.viz=D;this.canvas=D.canvas;this.config=D.config},requestNodes:function(I,H){var G=0,E=I.length,L={};var F=function(){H.onComplete()};var D=this.viz;if(E==0){F()}for(var J=0;J<E;J++){L[I[J].id]=I[J];H.request(I[J].id,I[J]._level,{onComplete:function(N,M){if(M&&M.children){M.id=N;D.op.sum(M,{type:"nothing"})}if(++G==E){D.graph.computeLevels(D.root,0);F()}}})}}});C.Plot=new v({Implements:f.Plot,initialize:function(D){this.viz=D;this.config=D.config;this.node=this.config.Node;this.edge=this.config.Edge;this.animation=new B;this.nodeTypes=new C.Plot.NodeTypes;this.edgeTypes=new C.Plot.EdgeTypes;this.labels=D.labels},plot:function(F,E){var D=this.viz,G=D.graph;D.canvas.clear();this.plotTree(G.getNode(D.clickedNode&&D.clickedNode.id||D.root),d.merge(D.config,F||{},{withLabels:true,hideLabels:false,plotSubtree:function(I,H){return I.anySubnode("exist")}}),E)}});C.Label={};C.Label.Native=new v({Implements:f.Label.Native,initialize:function(D){this.config=D.config;this.leaf=D.leaf},renderLabel:function(E,F,G){if(!this.leaf(F)&&!this.config.titleHeight){return}var I=F.pos.getc(true),M=E.getCtx(),D=F.getData("width"),L=F.getData("height"),J=I.x+D/2,H=I.y;M.fillText(F.name,J,H,D)}});C.Label.SVG=new v({Implements:f.Label.SVG,initialize:function(D){this.viz=D;this.leaf=D.leaf;this.config=D.config},placeLabel:function(O,H,I){var M=H.pos.getc(true),E=this.viz.canvas,F=E.translateOffsetX,D=E.translateOffsetY,N=E.scaleOffsetX,L=E.scaleOffsetY,J=E.getSize();var G={x:Math.round(M.x*N+F+J.width/2),y:Math.round(M.y*L+D+J.height/2)};O.setAttribute("x",G.x);O.setAttribute("y",G.y);if(!this.leaf(H)&&!this.config.titleHeight){O.style.display="none"}I.onPlaceLabel(O,H)}});C.Label.HTML=new v({Implements:f.Label.HTML,initialize:function(D){this.viz=D;this.leaf=D.leaf;this.config=D.config},placeLabel:function(P,I,J){var N=I.pos.getc(true),F=this.viz.canvas,G=F.translateOffsetX,E=F.translateOffsetY,O=F.scaleOffsetX,M=F.scaleOffsetY,L=F.getSize();var H={x:Math.round(N.x*O+G+L.width/2),y:Math.round(N.y*M+E+L.height/2)};var D=P.style;D.left=H.x+"px";D.top=H.y+"px";D.width=I.getData("width")*O+"px";D.height=I.getData("height")*M+"px";D.zIndex=I._depth*100;D.display="";if(!this.leaf(I)&&!this.config.titleHeight){P.style.display="none"}J.onPlaceLabel(P,I)}});C.Plot.NodeTypes=new v({none:{render:d.empty},rectangle:{render:function(G,E,U){var L=this.viz.leaf(G),F=this.config,Q=F.offset,J=F.titleHeight,P=G.pos.getc(true),D=G.getData("width"),R=G.getData("height"),I=G.getData("border"),T=E.getCtx(),O=P.x+Q/2,M=P.y+Q/2;if(D<=Q||R<=Q){return}if(L){if(F.cushion){var S=T.createRadialGradient(O+(D-Q)/2,M+(R-Q)/2,1,O+(D-Q)/2,M+(R-Q)/2,D<R?R:D);var H=G.getData("color");var N=d.rgbToHex(d.map(d.hexToRgb(H),function(V){return V*0.2>>0}));S.addColorStop(0,H);S.addColorStop(1,N);T.fillStyle=S}T.fillRect(O,M,D-Q,R-Q);if(I){T.save();T.strokeStyle=I;T.strokeRect(O,M,D-Q,R-Q);T.restore()}}else{if(J>0){T.fillRect(P.x+Q/2,P.y+Q/2,D-Q,J-Q);if(I){T.save();T.strokeStyle=I;T.strokeRect(P.x+Q/2,P.y+Q/2,D-Q,R-Q);T.restore()}}}},contains:function(G,I){if(this.viz.clickedNode&&!G.isDescendantOf(this.viz.clickedNode.id)){return false}var H=G.pos.getc(true),F=G.getData("width"),E=this.viz.leaf(G),D=E?G.getData("height"):this.config.titleHeight;return this.nodeHelper.rectangle.contains({x:H.x+F/2,y:H.y+D/2},I,F,D)}}});C.Plot.EdgeTypes=new v({none:d.empty});C.SliceAndDice=new v({Implements:[e,t,C.Base,i.TM.SliceAndDice]});C.Squarified=new v({Implements:[e,t,C.Base,i.TM.Squarified]});C.Strip=new v({Implements:[e,t,C.Base,i.TM.Strip]});q.BarChart={$extend:true,animate:true,type:"stacked",offset:25,labelOffset:3,barsOffset:0,hoveredColor:"#9fd4ff",orientation:"horizontal",showAggregates:true,showLabels:true,Tips:{enable:false,onShow:d.empty,onHide:d.empty},Events:{enable:false,onClick:d.empty}};$jit.ST.Plot.NodeTypes.implement({"barchart-stacked":{render:function(W,H){var N=W.pos.getc(true),V=W.getData("width"),T=W.getData("height"),R=this.getAlignedPos(N,V,T),Q=R.x,P=R.y,S=W.getData("dimArray"),L=W.getData("valueArray"),J=W.getData("colorArray"),G=J.length,ad=W.getData("stringArray");var Y=H.getCtx(),D={},Z=W.getData("border"),E=W.getData("gradient"),af=W.getData("config"),F=af.orientation=="horizontal",I=af.showAggregates,U=af.showLabels,O=af.Label;if(J&&S&&ad){for(var ac=0,X=S.length,ab=0,M=0;ac<X;ac++){Y.fillStyle=Y.strokeStyle=J[ac%G];if(E){var ae;if(F){ae=Y.createLinearGradient(Q+ab+S[ac]/2,P,Q+ab+S[ac]/2,P+T)}else{ae=Y.createLinearGradient(Q,P-ab-S[ac]/2,Q+V,P-ab-S[ac]/2)}var aa=d.rgbToHex(d.map(d.hexToRgb(J[ac%G].slice(1)),function(ag){return(ag*0.5)>>0}));ae.addColorStop(0,aa);ae.addColorStop(0.5,J[ac%G]);ae.addColorStop(1,aa);Y.fillStyle=ae}if(F){Y.fillRect(Q+ab,P,S[ac],T)}else{Y.fillRect(Q,P-ab-S[ac],V,S[ac])}if(Z&&Z.name==ad[ac]){D.acum=ab;D.dimValue=S[ac]}ab+=(S[ac]||0);M+=(L[ac]||0)}if(Z){Y.save();Y.lineWidth=2;Y.strokeStyle=Z.color;if(F){Y.strokeRect(Q+D.acum+1,P+1,D.dimValue-2,T-2)}else{Y.strokeRect(Q+1,P-D.acum-D.dimValue+1,V-2,D.dimValue-2)}Y.restore()}if(O.type=="Native"){Y.save();Y.fillStyle=Y.strokeStyle=O.color;Y.font=O.style+" "+O.size+"px "+O.family;Y.textBaseline="middle";if(I(W.name,M)){if(F){Y.textAlign="right";Y.fillText(M,Q+ab-af.labelOffset,P+T/2)}else{Y.textAlign="center";Y.fillText(M,Q+V/2,P-T-O.size/2-af.labelOffset)}}if(U(W.name,M,W)){if(F){Y.textAlign="center";Y.translate(Q-af.labelOffset-O.size/2,P+T/2);Y.rotate(Math.PI/2);Y.fillText(W.name,0,0)}else{Y.textAlign="center";Y.fillText(W.name,Q+V/2,P+O.size/2+af.labelOffset)}}Y.restore()}}},contains:function(I,L){var O=I.pos.getc(true),F=I.getData("width"),T=I.getData("height"),S=this.getAlignedPos(O,F,T),R=S.x,P=S.y,U=I.getData("dimArray"),G=I.getData("config"),E=L.x-R,D=G.orientation=="horizontal";if(D){if(L.x<R||L.x>R+F||L.y>P+T||L.y<P){return false}}else{if(L.x<R||L.x>R+F||L.y>P||L.y<P-T){return false}}for(var M=0,J=U.length,Q=(D?R:P);M<J;M++){var H=U[M];if(D){Q+=H;var N=Q;if(L.x<=N){return{name:I.getData("stringArray")[M],color:I.getData("colorArray")[M],value:I.getData("valueArray")[M]}}}else{Q-=H;var N=Q;if(L.y>=N){return{name:I.getData("stringArray")[M],color:I.getData("colorArray")[M],value:I.getData("valueArray")[M]}}}}return false}},"barchart-grouped":{render:function(X,H){var O=X.pos.getc(true),W=X.getData("width"),U=X.getData("height"),S=this.getAlignedPos(O,W,U),R=S.x,Q=S.y,T=X.getData("dimArray"),M=X.getData("valueArray"),ad=M.length,L=X.getData("colorArray"),G=L.length,af=X.getData("stringArray");var Z=H.getCtx(),D={},aa=X.getData("border"),E=X.getData("gradient"),ah=X.getData("config"),F=ah.orientation=="horizontal",J=ah.showAggregates,V=ah.showLabels,P=ah.Label,I=(F?U:W)/ad;if(L&&T&&af){for(var ae=0,Y=ad,ac=0,N=0;ae<Y;ae++){Z.fillStyle=Z.strokeStyle=L[ae%G];if(E){var ag;if(F){ag=Z.createLinearGradient(R+T[ae]/2,Q+I*ae,R+T[ae]/2,Q+I*(ae+1))}else{ag=Z.createLinearGradient(R+I*ae,Q-T[ae]/2,R+I*(ae+1),Q-T[ae]/2)}var ab=d.rgbToHex(d.map(d.hexToRgb(L[ae%G].slice(1)),function(ai){return(ai*0.5)>>0}));ag.addColorStop(0,ab);ag.addColorStop(0.5,L[ae%G]);ag.addColorStop(1,ab);Z.fillStyle=ag}if(F){Z.fillRect(R,Q+I*ae,T[ae],I)}else{Z.fillRect(R+I*ae,Q-T[ae],I,T[ae])}if(aa&&aa.name==af[ae]){D.acum=I*ae;D.dimValue=T[ae]}ac+=(T[ae]||0);N+=(M[ae]||0)}if(aa){Z.save();Z.lineWidth=2;Z.strokeStyle=aa.color;if(F){Z.strokeRect(R+1,Q+D.acum+1,D.dimValue-2,I-2)}else{Z.strokeRect(R+D.acum+1,Q-D.dimValue+1,I-2,D.dimValue-2)}Z.restore()}if(P.type=="Native"){Z.save();Z.fillStyle=Z.strokeStyle=P.color;Z.font=P.style+" "+P.size+"px "+P.family;Z.textBaseline="middle";if(J(X.name,N)){if(F){Z.textAlign="right";Z.fillText(N,R+Math.max.apply(null,T)-ah.labelOffset,Q+U/2)}else{Z.textAlign="center";Z.fillText(N,R+W/2,Q-Math.max.apply(null,T)-P.size/2-ah.labelOffset)}}if(V(X.name,N,X)){if(F){Z.textAlign="center";Z.translate(R-ah.labelOffset-P.size/2,Q+U/2);Z.rotate(Math.PI/2);Z.fillText(X.name,0,0)}else{Z.textAlign="center";Z.fillText(X.name,R+W/2,Q+P.size/2+ah.labelOffset)}}Z.restore()}}},contains:function(P,L){var G=P.pos.getc(true),O=P.getData("width"),N=P.getData("height"),J=this.getAlignedPos(G,O,N),I=J.x,H=J.y,M=P.getData("dimArray"),S=M.length,V=P.getData("config"),F=L.x-I,D=V.orientation=="horizontal",E=(D?N:O)/S;if(D){if(L.x<I||L.x>I+O||L.y>H+N||L.y<H){return false}}else{if(L.x<I||L.x>I+O||L.y>H||L.y<H-N){return false}}for(var R=0,Q=M.length;R<Q;R++){var U=M[R];if(D){var T=H+E*R;if(L.x<=I+U&&L.y>=T&&L.y<=T+E){return{name:P.getData("stringArray")[R],color:P.getData("colorArray")[R],value:P.getData("valueArray")[R]}}}else{var T=I+E*R;if(L.x>=T&&L.x<=T+E&&L.y>=H-U){return{name:P.getData("stringArray")[R],color:P.getData("colorArray")[R],value:P.getData("valueArray")[R]}}}}return false}}});$jit.BarChart=new v({st:null,colors:["#416D9C","#70A35E","#EBB056","#C74243","#83548B","#909291","#557EAA"],selected:{},busy:false,initialize:function(F){this.controller=this.config=d.merge(q("Canvas","Label","BarChart"),{Label:{type:"Native"}},F);var G=this.config.showLabels,E=d.type(G),H=this.config.showAggregates,D=d.type(H);this.config.showLabels=E=="function"?G:d.lambda(G);this.config.showAggregates=D=="function"?H:d.lambda(H);this.initializeViz()},initializeViz:function(){var F=this.config,I=this;var D=F.type.split(":")[0],J=F.orientation=="horizontal",H={};var E=new $jit.ST({injectInto:F.injectInto,orientation:J?"left":"bottom",levelDistance:0,siblingOffset:F.barsOffset,subtreeOffset:0,withLabels:F.Label.type!="Native",useCanvas:F.useCanvas,Label:{type:F.Label.type},Node:{overridable:true,type:"barchart-"+D,align:"left",width:1,height:1},Edge:{type:"none"},Tips:{enable:F.Tips.enable,type:"Native",force:true,onShow:function(O,N,L){var M=L;F.Tips.onShow(O,M,N)}},Events:{enable:true,type:"Native",onClick:function(N,O,L){if(!F.Events.enable){return}var M=O.getContains();F.Events.onClick(M,O,L)},onMouseMove:function(N,O,L){if(!F.hoveredColor){return}if(N){var M=O.getContains();I.select(N.id,M.name,M.index)}else{I.select(false,false,false)}}},onCreateLabel:function(Q,O){var W=F.Label,U=O.getData("valueArray"),T=d.reduce(U,function(X,Y){return X+Y},0);var S={wrapper:document.createElement("div"),aggregate:document.createElement("div"),label:document.createElement("div")};var L=S.wrapper,V=S.label,M=S.aggregate,N=L.style,R=V.style,P=M.style;H[O.id]=S;L.appendChild(V);L.appendChild(M);if(!F.showLabels(O.name,T,O)){R.display="none"}if(!F.showAggregates(O.name,T,O)){P.display="none"}N.position="relative";N.overflow="visible";N.fontSize=W.size+"px";N.fontFamily=W.family;N.color=W.color;N.textAlign="center";P.position=R.position="absolute";Q.style.width=O.getData("width")+"px";Q.style.height=O.getData("height")+"px";P.left=R.left="0px";V.innerHTML=O.name;Q.appendChild(L)},onPlaceLabel:function(S,O){if(!H[O.id]){return}var U=H[O.id],P=U.wrapper.style,W=U.label.style,T=U.aggregate.style,X=F.type.split(":")[0]=="grouped",L=F.orientation=="horizontal",aa=O.getData("dimArray"),ab=O.getData("valueArray"),M=(X&&L)?Math.max.apply(null,aa):O.getData("width"),Z=(X&&!L)?Math.max.apply(null,aa):O.getData("height"),N=parseInt(P.fontSize,10),V=S.style;if(aa&&ab){P.width=T.width=W.width=S.style.width=M+"px";for(var R=0,Q=ab.length,Y=0;R<Q;R++){if(aa[R]>0){Y+=ab[R]}}if(F.showLabels(O.name,Y,O)){W.display=""}else{W.display="none"}if(F.showAggregates(O.name,Y,O)){T.display=""}else{T.display="none"}if(F.orientation=="horizontal"){T.textAlign="right";W.textAlign="left";W.textIndex=T.textIndent=F.labelOffset+"px";T.top=W.top=(Z-N)/2+"px";S.style.height=P.height=Z+"px"}else{T.top=(-N-F.labelOffset)+"px";W.top=(F.labelOffset+Z)+"px";S.style.top=parseInt(S.style.top,10)-Z+"px";S.style.height=P.height=Z+"px"}U.aggregate.innerHTML=Y}}});var G=E.canvas.getSize();if(J){E.config.offsetX=+G.width/2-F.offset-(F.showLabels&&(F.labelOffset+F.Label.size))}else{E.config.offsetY=-G.height/2+F.offset+(F.showLabels&&(F.labelOffset+F.Label.size))}this.st=E;this.canvas=this.st.canvas},loadJSON:function(S){if(this.busy){return}this.busy=true;var Q=d.time(),J=[],L=this.st,V=d.splat(S.label),P=d.splat(S.color||this.colors),T=this.config,D=!!T.type.split(":")[1],G=T.animate,F=T.orientation=="horizontal",H=this;for(var R=0,E=S.values,N=E.length;R<N;R++){var U=E[R];var I=d.splat(E[R].values);var O=0;J.push({id:Q+U.label,name:U.label,data:{value:I,"$valueArray":I,"$colorArray":P,"$stringArray":V,"$gradient":D,"$config":T},children:[]})}var M={id:Q+"$root",name:"",data:{"$type":"none","$width":1,"$height":1},children:J};L.loadJSON(M);this.normalizeDims();L.compute();L.select(L.root);if(G){if(F){L.fx.animate({modes:["node-property:width:dimArray"],duration:1500,onComplete:function(){H.busy=false}})}else{L.fx.animate({modes:["node-property:height:dimArray"],duration:1500,onComplete:function(){H.busy=false}})}}else{this.busy=false}},updateJSON:function(G,J){if(this.busy){return}this.busy=true;var F=this.st;var I=F.graph;var E=G.values;var D=this.config.animate;var H=this;var L=this.config.orientation=="horizontal";d.each(E,function(M){var N=I.getByName(M.label);if(N){N.setData("valueArray",d.splat(M.values));if(G.label){N.setData("stringArray",d.splat(G.label))}}});this.normalizeDims();F.compute();F.select(F.root);if(D){if(L){F.fx.animate({modes:["node-property:width:dimArray"],duration:1500,onComplete:function(){H.busy=false;J&&J.onComplete()}})}else{F.fx.animate({modes:["node-property:height:dimArray"],duration:1500,onComplete:function(){H.busy=false;J&&J.onComplete()}})}}},select:function(F,D){if(!this.config.hoveredColor){return}var E=this.selected;if(E.id!=F||E.name!=D){E.id=F;E.name=D;E.color=this.config.hoveredColor;this.st.graph.eachNode(function(G){if(F==G.id){G.setData("border",E)}else{G.setData("border",false)}});this.st.plot()}},getLegend:function(){var F={};var G;this.st.graph.getNode(this.st.root).eachAdjacency(function(H){G=H.nodeTo});var E=G.getData("colorArray"),D=E.length;d.each(G.getData("stringArray"),function(I,H){F[I]=E[H%D]});return F},getMaxValue:function(){var E=0,D=this.config.type.split(":")[0]=="stacked";this.st.graph.eachNode(function(H){var F=H.getData("valueArray"),G=0;if(!F){return}if(D){d.each(F,function(I){G+=+I})}else{G=Math.max.apply(null,F)}E=E>G?E:G});return E},setBarType:function(D){this.config.type=D;this.st.config.Node.type="barchart-"+D.split(":")[0]},normalizeDims:function(){var N=this.st.graph.getNode(this.st.root),H=0;N.eachAdjacency(function(){H++});var J=this.getMaxValue(),P=this.st.canvas.getSize(),G=this.config,I=G.offset,E=G.orientation=="horizontal",D=(P[E?"height":"width"]-2*I-(H-1)*G.barsOffset)/H,F=G.animate,O=P[E?"width":"height"]-2*I-(!E&&G.showAggregates&&(G.Label.size+G.labelOffset))-(G.showLabels&&(G.Label.size+G.labelOffset)),M=E?"height":"width",L=E?"width":"height";this.st.graph.eachNode(function(T){var S=0,Q=[];d.each(T.getData("valueArray"),function(U){S+=+U;Q.push(0)});T.setData(M,D);if(F){T.setData(L,S*O/J,"end");T.setData("dimArray",d.map(T.getData("valueArray"),function(U){return U*O/J}),"end");var R=T.getData("dimArray");if(!R){T.setData("dimArray",Q)}}else{T.setData(L,S*O/J);T.setData("dimArray",d.map(T.getData("valueArray"),function(U){return U*O/J}))}})}});q.PieChart={$extend:true,animate:true,offset:25,sliceOffset:0,labelOffset:3,type:"stacked",hoveredColor:"#9fd4ff",Events:{enable:false,onClick:d.empty},Tips:{enable:false,onShow:d.empty,onHide:d.empty},showLabels:true,resizeLabels:false,updateHeights:false};$jit.Sunburst=new v({Implements:[e,t,i.Radial],initialize:function(D){var F=$jit.Sunburst;var E={interpolation:"linear",levelDistance:100,Node:{type:"multipie",height:0},Edge:{type:"none"},Label:{textAlign:"start",textBaseline:"middle"}};this.controller=this.config=d.merge(q("Canvas","Node","Edge","Fx","Tips","NodeStyles","Events","Navigation","Controller","Label"),E,D);var G=this.config;if(G.useCanvas){this.canvas=G.useCanvas;this.config.labelContainer=this.canvas.id+"-label"}else{if(G.background){G.background=d.merge({type:"Circles"},G.background)}this.canvas=new o(this,G);this.config.labelContainer=(typeof G.injectInto=="string"?G.injectInto:G.injectInto.id)+"-label"}this.graphOptions={complex:false,Node:{selected:false,exist:true,drawn:true}};this.graph=new f(this.graphOptions,this.config.Node,this.config.Edge);this.labels=new F.Label[G.Label.type](this);this.fx=new F.Plot(this);this.op=new F.Op(this);this.json=null;this.root=null;this.rotated=null;this.busy=false;this.initializeExtras()},createLevelDistanceFunc:function(){var D=this.config.levelDistance;return function(E){return(E._depth+1)*D}},refresh:function(){this.compute();this.plot()},reposition:function(){this.compute("end")},rotate:function(F,G,E){var D=F.getPos(E.property||"current").getp(true).theta;this.rotated=F;this.rotateAngle(-D,G,E)},rotateAngle:function(F,I,E){var G=this;var D=d.merge(this.config,E||{},{modes:["polar"]});var H=E.property||(I==="animate"?"end":"current");if(I==="animate"){this.fx.animation.pause()}this.graph.eachNode(function(L){var J=L.getPos(H);J.theta+=F;if(J.theta<0){J.theta+=Math.PI*2}});if(I=="animate"){this.fx.animate(D)}else{if(I=="replot"){this.fx.plot();this.busy=false}}},plot:function(){this.fx.plot()}});$jit.Sunburst.$extend=true;(function(D){D.Op=new v({Implements:f.Op,initialize:function(E){this.viz=E}});D.Plot=new v({Implements:f.Plot,initialize:function(E){this.viz=E;this.config=E.config;this.node=E.config.Node;this.edge=E.config.Edge;this.animation=new B;this.nodeTypes=new D.Plot.NodeTypes;this.edgeTypes=new D.Plot.EdgeTypes;this.labels=E.labels}});D.Label={};D.Label.Native=new v({Implements:f.Label.Native,initialize:function(E){this.viz=E;this.label=E.config.Label;this.config=E.config},renderLabel:function(H,J,M){var T=J.getData("span");if(T<Math.PI/2&&Math.tan(T)*this.config.levelDistance*J._depth<10){return}var U=H.getCtx();var F=U.measureText(J.name);if(J.id==this.viz.root){var S=-F.width/2,Q=0,R=0;var E=0}else{var I=5;var E=M.levelDistance-I;var P=J.pos.clone();P.rho+=I;var G=P.getp(true);var N=P.getc(true);var S=N.x,Q=N.y;var L=Math.PI;var O=(G.theta>L/2&&G.theta<3*L/2);var R=O?G.theta+L:G.theta;if(O){S-=Math.abs(Math.cos(G.theta)*F.width);Q+=Math.sin(G.theta)*F.width}else{if(J.id==this.viz.root){S-=F.width/2}}}U.save();U.translate(S,Q);U.rotate(R);U.fillText(J.name,0,0);U.restore()}});D.Label.SVG=new v({Implements:f.Label.SVG,initialize:function(E){this.viz=E},placeLabel:function(T,H,J){var P=H.pos.getc(true),S=this.viz,F=this.viz.canvas;var L=F.getSize();var G={x:Math.round(P.x+L.width/2),y:Math.round(P.y+L.height/2)};T.setAttribute("x",G.x);T.setAttribute("y",G.y);var M=T.getBBox();if(M){var R=T.getAttribute("x");var O=T.getAttribute("y");var E=H.pos.getp(true);var I=Math.PI;var N=(E.theta>I/2&&E.theta<3*I/2);if(N){T.setAttribute("x",R-M.width);T.setAttribute("y",O-M.height)}else{if(H.id==S.root){T.setAttribute("x",R-M.width/2)}}var Q=N?E.theta+I:E.theta;if(H._depth){T.setAttribute("transform","rotate("+Q*360/(2*I)+" "+R+" "+O+")")}}J.onPlaceLabel(T,H)}});D.Label.HTML=new v({Implements:f.Label.HTML,initialize:function(E){this.viz=E},placeLabel:function(O,H,J){var M=H.pos.clone(),F=this.viz.canvas,N=H.getData("height"),I=((N||H._depth==0)?N:this.viz.config.levelDistance)/2,L=F.getSize();M.rho+=I;M=M.getc(true);var G={x:Math.round(M.x+L.width/2),y:Math.round(M.y+L.height/2)};var E=O.style;E.left=G.x+"px";E.top=G.y+"px";E.display=this.fitsInCanvas(G,F)?"":"none";J.onPlaceLabel(O,H)}});D.Plot.NodeTypes=new v({none:{render:d.empty,contains:d.lambda(false),anglecontains:function(I,L){var H=I.getData("span")/2,F=I.pos.theta;var G=F-H,E=F+H;if(G<0){G+=Math.PI*2}var J=Math.atan2(L.y,L.x);if(J<0){J+=Math.PI*2}if(G>E){return(J>G&&J<=Math.PI*2)||J<E}else{return J>G&&J<E}}},pie:{render:function(J,H){var O=J.getData("span")/2,G=J.pos.theta;var I=G-O,L=G+O;var N=J.pos.getp(true);var E=new c(N.rho,I);var F=E.getc(true);E.theta=L;var M=E.getc(true);var P=H.getCtx();P.beginPath();P.moveTo(0,0);P.lineTo(F.x,F.y);P.moveTo(0,0);P.lineTo(M.x,M.y);P.moveTo(0,0);P.arc(0,0,N.rho*J.getData("dim-quotient"),I,L,false);P.fill()},contains:function(G,I){if(this.nodeTypes.none.anglecontains.call(this,G,I)){var E=Math.sqrt(I.x*I.x+I.y*I.y);var F=this.config.levelDistance,H=G._depth;return(E<=F*H)}return false}},multipie:{render:function(L,I){var S=L.getData("height");var M=S?S:this.config.levelDistance;var R=L.getData("span")/2,H=L.pos.theta;var J=H-R,O=H+R;var Q=L.pos.getp(true);var F=new c(Q.rho,J);var G=F.getc(true);F.theta=O;var P=F.getc(true);F.rho+=M;var E=F.getc(true);F.theta=J;var N=F.getc(true);var T=I.getCtx();T.moveTo(0,0);T.beginPath();T.arc(0,0,Q.rho,J,O,false);T.arc(0,0,Q.rho+M,O,J,true);T.moveTo(G.x,G.y);T.lineTo(N.x,N.y);T.moveTo(P.x,P.y);T.lineTo(E.x,E.y);T.fill();if(L.collapsed){T.save();T.lineWidth=2;T.moveTo(0,0);T.beginPath();T.arc(0,0,Q.rho+M+5,O-0.01,J+0.01,true);T.stroke();T.restore()}},contains:function(H,L){if(this.nodeTypes.none.anglecontains.call(this,H,L)){var F=Math.sqrt(L.x*L.x+L.y*L.y);var E=H.getData("height");var I=E?E:this.config.levelDistance;var G=this.config.levelDistance,J=H._depth;return(F>=G*J)&&(F<=(G*J+I))}return false}},"gradient-multipie":{render:function(H,E){var N=E.getCtx();var M=H.getData("height");var I=M?M:this.config.levelDistance;var F=N.createRadialGradient(0,0,H.getPos().rho,0,0,H.getPos().rho+I);var L=d.hexToRgb(H.getData("color")),J=[];d.each(L,function(O){J.push(parseInt(O*0.5,10))});var G=d.rgbToHex(J);F.addColorStop(0,G);F.addColorStop(1,H.getData("color"));N.fillStyle=F;this.nodeTypes.multipie.render.call(this,H,E)},contains:function(E,F){return this.nodeTypes.multipie.contains.call(this,E,F)}},"gradient-pie":{render:function(J,G){var E=G.getCtx();var L=E.createRadialGradient(0,0,0,0,0,J.getPos().rho);var I=d.hexToRgb(J.getData("color")),F=[];d.each(I,function(M){F.push(parseInt(M*0.5,10))});var H=d.rgbToHex(F);L.addColorStop(1,H);L.addColorStop(0,J.getData("color"));E.fillStyle=L;this.nodeTypes.pie.render.call(this,J,G)},contains:function(E,F){return this.nodeTypes.pie.contains.call(this,E,F)}}});D.Plot.EdgeTypes=new v({none:d.empty,line:function(E,F){var H=E.nodeFrom.pos.getc(true),G=E.nodeTo.pos.getc(true);this.edgeHelper.line(H,G,F)},arrow:function(F,G){var L=F.nodeFrom.pos.getc(true),J=F.nodeTo.pos.getc(true),I=F.getData("dim"),H=F.data.$direction,E=(H&&H.length>1&&H[0]!=F.nodeFrom.id);this.edgeHelper.arrow(L,J,I,E,G)},hyperline:function(E,F){var I=E.nodeFrom.pos.getc(),H=E.nodeTo.pos.getc(),G=Math.max(I.norm(),H.norm());this.edgeHelper.hyperline(I.$scale(1/G),H.$scale(1/G),G,F)}})})($jit.Sunburst);$jit.Sunburst.Plot.NodeTypes.implement({"piechart-stacked":{render:function(ac,H){var ab=ac.pos.getp(true),J=ac.getData("dimArray"),aa=ac.getData("valueArray"),O=ac.getData("colorArray"),G=O.length,U=ac.getData("stringArray"),X=ac.getData("span")/2,S=ac.pos.theta,N=S-X,R=S+X,Z=new c;var V=H.getCtx(),T={},Q=ac.getData("gradient"),L=ac.getData("border"),ah=ac.getData("config"),aq=ah.showLabels,ag=ah.resizeLabels,aj=ah.Label;var am=ah.sliceOffset*Math.cos((N+R)/2);var M=ah.sliceOffset*Math.sin((N+R)/2);if(O&&J&&U){for(var an=0,ak=J.length,D=0,af=0;an<ak;an++){var I=J[an],ao=O[an%G];if(I<=0){continue}V.fillStyle=V.strokeStyle=ao;if(Q&&I){var al=V.createRadialGradient(am,M,D+ah.sliceOffset,am,M,D+I+ah.sliceOffset);var E=d.hexToRgb(ao),ae=d.map(E,function(au){return(au*0.8)>>0}),F=d.rgbToHex(ae);al.addColorStop(0,ao);al.addColorStop(0.5,ao);al.addColorStop(1,F);V.fillStyle=al}Z.rho=D+ah.sliceOffset;Z.theta=N;var ap=Z.getc(true);Z.theta=R;var W=Z.getc(true);Z.rho+=I;var ar=Z.getc(true);Z.theta=N;var Y=Z.getc(true);V.beginPath();V.arc(am,M,D+0.01,N,R,false);V.arc(am,M,D+I+0.01,R,N,true);V.fill();if(L&&L.name==U[an]){T.acum=D;T.dimValue=J[an];T.begin=N;T.end=R}D+=(I||0);af+=(aa[an]||0)}if(L){V.save();V.globalCompositeOperation="source-over";V.lineWidth=2;V.strokeStyle=L.color;var ai=N<R?1:-1;V.beginPath();V.arc(am,M,T.acum+0.01+1,T.begin,T.end,false);V.arc(am,M,T.acum+T.dimValue+0.01-1,T.end,T.begin,true);V.closePath();V.stroke();V.restore()}if(aq&&aj.type=="Native"){V.save();V.fillStyle=V.strokeStyle=aj.color;var ad=ag?ac.getData("normalizedDim"):1,P=(aj.size*ad)>>0;P=P<+ag?+ag:P;V.font=aj.style+" "+P+"px "+aj.family;V.textBaseline="middle";V.textAlign="center";Z.rho=D+ah.labelOffset+ah.sliceOffset;Z.theta=ac.pos.theta;var at=Z.getc(true);V.fillText(ac.name,at.x,at.y);V.restore()}}},contains:function(G,L){if(this.nodeTypes.none.anglecontains.call(this,G,L)){var N=Math.sqrt(L.x*L.x+L.y*L.y);var D=this.config.levelDistance,J=G._depth;var E=G.getData("config");if(N<=D*J+E.sliceOffset){var O=G.getData("dimArray");for(var I=0,H=O.length,M=E.sliceOffset;I<H;I++){var F=O[I];if(N>=M&&N<=M+F){return{name:G.getData("stringArray")[I],color:G.getData("colorArray")[I],value:G.getData("valueArray")[I],label:G.name}}M+=F}}return false}return false}}});$jit.PieChart=new v({sb:null,colors:["#416D9C","#70A35E","#EBB056","#C74243","#83548B","#909291","#557EAA"],selected:{},busy:false,initialize:function(D){this.controller=this.config=d.merge(q("Canvas","PieChart","Label"),{Label:{type:"Native"}},D);this.initializeViz()},initializeViz:function(){var E=this.config,H=this;var D=E.type.split(":")[0];var I=new $jit.Sunburst({injectInto:E.injectInto,useCanvas:E.useCanvas,withLabels:E.Label.type!="Native",Label:{type:E.Label.type},Node:{overridable:true,type:"piechart-"+D,width:1,height:1},Edge:{type:"none"},Tips:{enable:E.Tips.enable,type:"Native",force:true,onShow:function(N,M,J){var L=J;E.Tips.onShow(N,L,M)}},Events:{enable:true,type:"Native",onClick:function(M,N,J){if(!E.Events.enable){return}var L=N.getContains();E.Events.onClick(L,N,J)},onMouseMove:function(M,N,J){if(!E.hoveredColor){return}if(M){var L=N.getContains();H.select(M.id,L.name,L.index)}else{H.select(false,false,false)}}},onCreateLabel:function(N,M){var J=E.Label;if(E.showLabels){var L=N.style;L.fontSize=J.size+"px";L.fontFamily=J.family;L.color=J.color;L.textAlign="center";N.innerHTML=M.name}},onPlaceLabel:function(aa,U){if(!E.showLabels){return}var O=U.pos.getp(true),R=U.getData("dimArray"),X=U.getData("span")/2,P=U.pos.theta,Z=P-X,L=P+X,ac=new c;var T=E.showLabels,N=E.resizeLabels,Q=E.Label;if(R){for(var Y=0,V=R.length,W=0;Y<V;Y++){W+=R[Y]}var ab=N?U.getData("normalizedDim"):1,J=(Q.size*ab)>>0;J=J<+N?+N:J;aa.style.fontSize=J+"px";ac.rho=W+E.labelOffset+E.sliceOffset;ac.theta=(Z+L)/2;var O=ac.getc(true);var M=H.canvas.getSize();var S={x:Math.round(O.x+M.width/2),y:Math.round(O.y+M.height/2)};aa.style.left=S.x+"px";aa.style.top=S.y+"px"}}});var G=I.canvas.getSize(),F=Math.min;I.config.levelDistance=F(G.width,G.height)/2-E.offset-E.sliceOffset;this.sb=I;this.canvas=this.sb.canvas;this.canvas.getCtx().globalCompositeOperation="lighter"},loadJSON:function(S){var Q=d.time(),J=[],D=this.sb,V=d.splat(S.label),M=V.length,P=d.splat(S.color||this.colors),G=P.length,T=this.config,E=!!T.type.split(":")[1],H=T.animate,O=M==1;for(var R=0,F=S.values,N=F.length;R<N;R++){var U=F[R];var I=d.splat(U.values);J.push({id:Q+U.label,name:U.label,data:{value:I,"$valueArray":I,"$colorArray":O?d.splat(P[R%G]):P,"$stringArray":V,"$gradient":E,"$config":T,"$angularWidth":d.reduce(I,function(W,X){return W+X})},children:[]})}var L={id:Q+"$root",name:"",data:{"$type":"none","$width":1,"$height":1},children:J};D.loadJSON(L);this.normalizeDims();D.refresh();if(H){D.fx.animate({modes:["node-property:dimArray"],duration:1500})}},updateJSON:function(F,I){if(this.busy){return}this.busy=true;var J=this.sb;var H=J.graph;var E=F.values;var D=this.config.animate;var G=this;d.each(E,function(L){var N=H.getByName(L.label),M=d.splat(L.values);if(N){N.setData("valueArray",M);N.setData("angularWidth",d.reduce(M,function(O,P){return O+P}));if(F.label){N.setData("stringArray",d.splat(F.label))}}});this.normalizeDims();if(D){J.compute("end");J.fx.animate({modes:["node-property:dimArray:span","linear"],duration:1500,onComplete:function(){G.busy=false;I&&I.onComplete()}})}else{J.refresh()}},select:function(F,D){if(!this.config.hoveredColor){return}var E=this.selected;if(E.id!=F||E.name!=D){E.id=F;E.name=D;E.color=this.config.hoveredColor;this.sb.graph.eachNode(function(G){if(F==G.id){G.setData("border",E)}else{G.setData("border",false)}});this.sb.plot()}},getLegend:function(){var F={};var G;this.sb.graph.getNode(this.sb.root).eachAdjacency(function(H){G=H.nodeTo});var E=G.getData("colorArray"),D=E.length;d.each(G.getData("stringArray"),function(I,H){F[I]=E[H%D]});return F},getMaxValue:function(){var D=0;this.sb.graph.eachNode(function(G){var E=G.getData("valueArray"),F=0;d.each(E,function(H){F+=+H});D=D>F?D:F});return D},normalizeDims:function(){var E=this.sb.graph.getNode(this.sb.root),D=0;E.eachAdjacency(function(){D++});var I=this.getMaxValue(),H=this.config,F=H.animate,G=this.sb.config.levelDistance;this.sb.graph.eachNode(function(O){var N=0,J=[];d.each(O.getData("valueArray"),function(P){N+=+P;J.push(1)});var M=(J.length==1)&&!H.updateHeights;if(F){O.setData("dimArray",d.map(O.getData("valueArray"),function(P){return M?G:(P*G/I)}),"end");var L=O.getData("dimArray");if(!L){O.setData("dimArray",J)}}else{O.setData("dimArray",d.map(O.getData("valueArray"),function(P){return M?G:(P*G/I)}))}O.setData("normalizedDim",N/I)})}})})();var vis4=function(){};vis4.log=function(){try{if(window.console!==null){console.log.apply(this,arguments)}}catch(a){}};vis4.str2time=function(a){var c=a.split(".");return Math.round(Date.UTC(2000+c[0],c[1]-1,c[2])*0.001)};vis4.round=function(e,a){var c=Math.pow(10,a);return Math.round(e*c)/c};vis4.formatNumber_ksep=".";vis4.formatNumber_dsep=",";vis4.formatNumber=function(f,a){f=""+f;var d="",h=0;for(var e=f.length-1;e>=0;e--){if(h>0&&h<f.length&&h%3==0){d=vis4.formatNumber_ksep+d}d=f[e]+d;h++}return d};vis4.parseTSV=function(j,f){var k=j.split("\n");var e=[];var h;var c;for(c=0;c<k.length;c++){var n=k[c];if(n!==""){if(f){if(c===0){h=n.split("\t")}else{var d={};var i=n.split("\t");if(i.length!=h.length){return"wrong tsv format"}for(var a=0;a<h.length;a++){d[$.trim(h[a])]=$.trim(i[a])}e.push(d)}}else{e.push(n.split("\t"))}}}return e};vis4.map=function(a,e){var d={};for(var c=0;c<a.length;c++){d[a[c][e]]=a[c]}return d};vis4.DelayedTask=function(){var a=this;a.init=function(d){var f=this,c=[];for(var e in d){if(e>2){c.push(d[e])}}f.func=d[2];f.scope=d[1];f.args=c;f.running=true;f.timer=window.setTimeout(this.run.bind(f),d[0])};a.run=function(){var c=this;c.func.apply(c.scope,c.args);c.running=false};a.cancel=function(){vis4.log("canceling timer",this);window.clearTimeout(this.timer);this.running=false};a.init(arguments)};var vis4loadingItem=function(a,e,d,c){this.url=a;this.id=e;this.type=d;this.loader=c;this.load=function(){$.get(this.url,this.processContent.bind(this))};this.processContent=function(f){if(this.type=="tsv"){this.data=vis4.parseTSV(f,true)}else{if(this.type=="json"){this.data=(typeof(f)=="string")?$.parseJSON(f):f}else{this.data=f}}this.loader.itemLoaded()}};var vis4loader=function(){this.items=[];this.byID={};this.add=function(a,e,c){if(c===null){c="text"}var d=new vis4loadingItem(a,e,c,this);this.items.push(d);this.byID[e]=d};this.load=function(c){this.callback=c;this.loaded=0;for(var a=0;a<this.items.length;a++){this.items[a].load()}};this.itemLoaded=function(){this.loaded++;if(this.loaded==this.items.length){this.callback(this)}};this.get=function(a){return this.byID[a].data}};Function.prototype.bind=function(c){var a=this;return function(){return a.apply(c,arguments)}};var vis4color=function(a){this.h=0;this.s=0.5;this.l=0.8;this.v=1;this.i=1;this.r=255;this.g=0;this.b=0;this.x="#FF0000";this.u=0;this.br=1;this.K=1/180*Math.PI;if(a=="hsi"||a=="hsl"||a=="hsb"||a=="hsv"){this.mode=a}this.log=function(c){if(window.console!==null){console.log(c)}};this.cos=function(c){return Math.cos(c*this.K)};this.trim=function(c){return Math.max(0,Math.min(1,c))};this.setMode=function(c){if(c!="hsv"&&c!="hsi"&&c!="hsl"&&c!="hsb"){this.log("unknown color mode "+c)}this.mode=c;this.rgb2hsx()};this.setHexColor=function(c){if(c.charAt(0)!="#"){c="#"+c}if(c.length==4){c="#"+c.charAt(1)+c.charAt(1)+c.charAt(2)+c.charAt(2)+c.charAt(3)+c.charAt(3)}if(c.length!=7){this.log("invalid hex color")}this.x=c;this.hex2int();this.int2rgb();this.rgb2hsx()};this.setRGBColor=function(e,d,c){this.r=e;this.b=c;this.g=d;this.rgb2int();this.int2hex();this.rgb2hsx()};this.setHSVColor=function(e,d,c){if(this.mode!="hsv"){this.mode="hsv"}this.h=e;this.s=this.trim(d);this.v=this.trim(c);this.hsv2rgb();this.rgb2int();this.int2hex()};this.setHSLColor=function(e,d,c){if(this.mode!="hsl"){this.mode="hsl"}this.h=e;this.s=this.trim(d);this.l=this.trim(c);this.hsl2rgb();this.rgb2int();this.int2hex()};this.setHSBColor=function(e,d,c){if(this.mode!="hsb"){this.mode="hsb"}this.h=e;this.s=this.trim(d);this.b=this.trim(c);this.hsb2rgb();this.rgb2int();this.int2hex()};this.setHSIColor=function(e,d,c){if(this.mode!="hsi"){this.mode="hsi"}this.h=e;this.s=this.trim(d);this.i=this.trim(c);this.hsi2rgb();this.rgb2int();this.int2hex()};this.onChange=function(){};this.rgb2int=function(){this.u=this.r<<16|this.g<<8|this.b;this.onChange()};this.int2rgb=function(){this.r=this.u>>16;this.g=this.u>>8&255;this.b=this.u&255};this.hex2int=function(){this.u=parseInt(this.x.substr(1),16);this.onChange()};this.int2hex=function(){var c="000000"+this.u.toString(16).toUpperCase();this.x="#"+c.substr(c.length-6);this.onChange()};this.int2rgb=function(){this.r=this.u>>16;this.g=this.u>>8&255;this.b=this.u&255};this.hsx2rgb=function(){switch(this.mode){case"hsv":this.hsv2rgb();break;case"hsi":this.hsi2rgb();break;case"hsl":this.hsl2rgb();break;case"hsb":this.hsb2rgb();break}};this.rgb2hsx=function(){switch(this.mode){case"hsv":this.rgb2hsv();break;case"hsi":this.rgb2hsi();break;case"hsl":this.rgb2hsl();break;case"hsb":this.rgb2hsb();break}};this.hue=function(c){this._evaluate(c,"h");this.hsx2rgb();this.rgb2int();this.int2hex();return this};this.saturation=function(c){this._evaluate(c,"s");this.hsx2rgb();this.rgb2int();this.int2hex();return this};this.lightness=function(c){if(this.mode!="hsl"){this.log("WARNING: lightness property not available in "+this.mode+" mode");return}this._evaluate(c,"l");this.hsx2rgb();this.rgb2int();this.int2hex();return this};this.brightness=function(c){if(this.mode!="hsb"){this.log("WARNING: brightness property not available in "+this.mode+" mode");return}this._evaluate(c,"br");this.hsx2rgb();this.rgb2int();this.int2hex();return this};this.value=function(c){if(this.mode!="hsv"){this.log("WARNING: value property not available in "+this.mode+" mode");return}this._evaluate(c,"v");this.hsx2rgb();this.rgb2int();this.int2hex();return this};this.intensity=function(c){if(this.mode!="hsi"){this.log("WARNING: intensity property not available in "+this.mode+" mode");return}this._evaluate(c,"i");this.hsx2rgb();this.rgb2int();this.int2hex();return this};this._evaluate=function(d,c){if(typeof(d)=="string"){if(d.charAt(0)=="+"&&!isNaN(d.substr(1))){this[c]=Number(this[c])+Number(d.substr(1))}else{if(d.charAt(0)=="-"&&!isNaN(d.substr(1))){this[c]=this[c]-Number(d.substr(1))}}if(d.charAt(0)=="*"&&!isNaN(d.substr(1))){this[c]=this[c]*Number(d.substr(1))}else{if(d.charAt(0)=="/"&&!isNaN(d.substr(1))){this[c]=this[c]/Number(d.substr(1))}}}else{if(!isNaN(d)){this[c]=Number(d)}}};this.rgb=function(){return[this.r,this.g,this.b]};this.hsl=function(){return[this.h,this.s,this.l]};this.rgb2hsv=function(){var d=Math.min(Math.min(this.r,this.g),this.b),c=Math.max(Math.max(this.r,this.g),this.b),e=c-d;this.v=c/255;this.s=e/c;if(this.s===0){this.h=undefined}else{if(this.r==c){this.h=(this.g-this.b)/e}if(this.g==c){this.h=2+(this.b-this.r)/e}if(this.b==c){this.h=4+(this.r-this.g)/e}this.h*=60;if(this.h<0){this.h+=360}}};this.hsv2rgb=function(){var k=this.h,j=this.s,c=this.v*255,e,n,o,l,d;if(this.s===0&&isNaN(k)){this.r=this.g=this.b=c}else{if(k==360){k=0}k/=60;e=Math.floor(k);n=k-e;o=c*(1-j);l=c*(1-j*n);d=c*(1-j*(1-n));switch(e){case 0:this._rgb(c,d,o);break;case 1:this._rgb(l,c,o);break;case 2:this._rgb(o,c,d);break;case 3:this._rgb(o,l,c);break;case 4:this._rgb(d,o,c);break;case 5:this._rgb(c,o,l)}}};this._rgb=function(e,d,c){this.r=e;this.g=d;this.b=c};this.rgb2hsl=function(){var h=this.r/255,f=this.g/255,d=this.b/255,e=Math.min(Math.min(h,f),d),c=Math.max(Math.max(h,f),d);this.l=(c+e)/2;if(c==e){this.s=0;this.h=undefined}else{if(this.l<0.5){this.s=(c-e)/(c+e)}else{this.s=(c-e)/(2-c-e)}}if(h==c){this.h=(f-d)/(c-e)}else{if(f==c){this.h=2+(d-h)/(c-e)}else{if(d==c){this.h=4+(h-f)/(c-e)}}}this.h*=60;if(this.h<0){this.h+=360}};this.hsl2rgb=function(){if(this.s===0){this.r=this.g=this.b=this.l*255}else{var k,j,e=[0,0,0],l=[0,0,0];if(this.l<0.5){j=this.l*(1+this.s)}else{j=this.l+this.s-this.l*this.s}k=2*this.l-j;var f=this.h/360;e[0]=f+1/3;e[1]=f;e[2]=f-1/3;for(var d=0;d<3;d++){if(e[d]<0){e[d]+=1}if(e[d]>1){e[d]-=1}if(6*e[d]<1){l[d]=k+(j-k)*6*e[d]}else{if(2*e[d]<1){l[d]=j}else{if(3*e[d]<2){l[d]=k+(j-k)*((2/3)-e[d])*6}else{l[d]=k}}}}this.r=l[0]*255;this.g=l[1]*255;this.b=l[2]*255}};this.rgb2hsb=function(){this.rgb2hsl();this.br=this._rgbLuminance()};this._rgbLuminance=function(){return(0.2126*this.r+0.7152*this.g+0.0722*this.b)/255};this.hsb2rgb=function(){var i=0.001;var f=0,c=1,h=0.5;var e;this.l=h;this.hsl2rgb();e=this._rgbLuminance();var d=0;while(Math.abs(e-this.br)>i&&d<100){if(e>this.br){c=h}else{f=h}h=(f+c)/2;this.l=h;this.hsl2rgb();e=this._rgbLuminance();d++}this.br=e};this.rgb2hsi=function(){var e,i=this.r,h=this.g,d=this.b,c=Math.max(Math.max(i,h),d),f=i+h+d,j=c-e;i=i/f;h=h/f;d=d/f;e=Math.min(Math.min(i,h),d);this.i=(i+h+d)/765;this.h=this.acos((i-0.5*h-0.5*d)/Math.sqrt((i-h)*(i-h)+(i-d)*(h-d)));this.s=1-3*e;if(d>h){this.h=360-this.h}};this.hsi2rgb=function(){var f=this.h,d=this.i,e=this.s,k,c,j,l=this.cos;if(f<=120){c=(1-e)/3;k=(1+(e*l(f))/l(60-f))/3;j=1-(c+k)}else{if(f<=240){f-=120;k=(1-e)/3;j=(1+(e*l(f))/l(60-f))/3;c=1-(k+j)}else{f-=240;j=(1-e)/3;c=(1+(e*l(f))/l(60-f))/3;k=1-(j+c)}}k=Math.min(255,k*d*3*255);j=Math.min(255,j*d*3*255);c=Math.min(255,c*d*3*255)}};vis4color.fromHex=function(a,d){if(d==null){d="hsl"}var e=new vis4color(d);e.setHexColor(a);return e};vis4color.fromRGB=function(e,d,a,f){if(f===null){f="hsl"}var h=new vis4color(f);h.setRGBColor(e,d,a);return h};vis4color.fromHSV=function(e,d,a,f){if(f===null){f="hsl"}var i=new vis4color(f);i.setHSVColor(e,d,a);return i};vis4color.fromHSL=function(e,d,a,f){if(f===null){f="hsl"}var i=new vis4color(f);i.setHSLColor(e,d,a);return i};vis4color.fromHSB=function(e,d,a,f){if(f===null){f="hsl"}var i=new vis4color(f);i.setHSBColor(e,d,a);return i};vis4color.fromHSI=function(e,d,a,f){if(f===null){f="hsl"}var j=new vis4color(f);j.setHSIColor(e,d,a);return j};(function(e){var h={put:function(j,i){(i||window).location.hash=this.encoder(j)},get:function(k){var j=((k||window).location.hash).replace(/^#/,"");try{return e.browser.mozilla?j:decodeURIComponent(j)}catch(i){return j}},encoder:encodeURIComponent};var d={id:"__jQuery_history",init:function(){var i='<iframe id="'+this.id+'" style="display:none" src="javascript:false;" />';e("body").prepend(i);return this},_document:function(){return e("#"+this.id)[0].contentWindow.document},put:function(j){var i=this._document();i.open();i.close();h.put(j,i)},get:function(){return h.get(this._document())}};function f(j){j=e.extend({unescape:false},j||{});h.encoder=k(j.unescape);function k(l){if(l===true){return function(n){return n}}if(typeof l=="string"&&(l=i(l.split("")))||typeof l=="function"){return function(n){return l(encodeURIComponent(n))}}return encodeURIComponent}function i(n){var l=new RegExp(e.map(n,encodeURIComponent).join("|"),"ig");return function(o){return o.replace(l,decodeURIComponent)}}}var c={};c.base={callback:undefined,type:undefined,check:function(){},load:function(i){},init:function(j,i){f(i);a.callback=j;a._options=i;a._init()},_init:function(){},_options:{}};c.timer={_appState:undefined,_init:function(){var i=h.get();a._appState=i;a.callback(i);setInterval(a.check,100)},check:function(){var i=h.get();if(i!=a._appState){a._appState=i;a.callback(i)}},load:function(i){if(i!=a._appState){h.put(i);a._appState=i;a.callback(i)}}};c.iframeTimer={_appState:undefined,_init:function(){var i=h.get();a._appState=i;d.init().put(i);a.callback(i);setInterval(a.check,100)},check:function(){var j=d.get(),i=h.get();if(i!=j){if(i==a._appState){a._appState=j;h.put(j);a.callback(j)}else{a._appState=i;d.put(i);a.callback(i)}}},load:function(i){if(i!=a._appState){h.put(i);d.put(i);a._appState=i;a.callback(i)}}};c.hashchangeEvent={_init:function(){a.callback(h.get());e(window).bind("hashchange",a.check)},check:function(){a.callback(h.get())},load:function(i){h.put(i)}};var a=e.extend({},c.base);if(e.browser.msie&&(e.browser.version<8||document.documentMode<8)){a.type="iframeTimer"}else{if("onhashchange" in window){a.type="hashchangeEvent"}else{a.type="timer"}}e.extend(a,c[a.type]);e.history=a})(jQuery);var TWEEN=TWEEN||function(){var h,j,l,k,i=[];return{start:function(a){l=setInterval(this.update,1000/(a||60))},stop:function(){clearInterval(l)},add:function(a){i.push(a)},remove:function(a){h=i.indexOf(a);h!==-1&&i.splice(h,1)},update:function(){h=0;j=i.length;for(k=(new Date).getTime();h<j;){if(i[h].update(k)){h++}else{i.splice(h,1);j--}}}}}();TWEEN.Tween=function(A){var v={},z={},w={},u=1000,t=0,q=null,h=TWEEN.Easing.Linear.EaseNone,p=null,o=null,i=null;this.to=function(a,d){if(d!==null){u=d}for(var c in a){if(A[c]!==null){w[c]=a[c]}}return this};this.start=function(){TWEEN.add(this);q=(new Date).getTime()+t;for(var a in w){if(A[a]!==null){v[a]=A[a];z[a]=w[a]-A[a]}}return this};this.stop=function(){TWEEN.remove(this);return this};this.delay=function(a){t=a;return this};this.easing=function(a){h=a;return this};this.chain=function(a){p=a};this.onUpdate=function(a){o=a;return this};this.onComplete=function(a){i=a;return this};this.update=function(a){var d,c;if(a<q){return true}a=(a-q)/u;a=a>1?1:a;c=h(a);for(d in z){A[d]=v[d]+z[d]*c}o!==null&&o.call(A,c);if(a==1){i!==null&&i.call(A);p!==null&&p.start();return false}return true}};TWEEN.Easing={Linear:{},Quadratic:{},Cubic:{},Quartic:{},Quintic:{},Sinusoidal:{},Exponential:{},Circular:{},Elastic:{},Back:{},Bounce:{}};TWEEN.Easing.Linear.EaseNone=function(c){return c};TWEEN.Easing.Quadratic.EaseIn=function(c){return c*c};TWEEN.Easing.Quadratic.EaseOut=function(c){return -c*(c-2)};TWEEN.Easing.Quadratic.EaseInOut=function(c){if((c*=2)<1){return 0.5*c*c}return -0.5*(--c*(c-2)-1)};TWEEN.Easing.Cubic.EaseIn=function(c){return c*c*c};TWEEN.Easing.Cubic.EaseOut=function(c){return --c*c*c+1};TWEEN.Easing.Cubic.EaseInOut=function(c){if((c*=2)<1){return 0.5*c*c*c}return 0.5*((c-=2)*c*c+2)};TWEEN.Easing.Quartic.EaseIn=function(c){return c*c*c*c};TWEEN.Easing.Quartic.EaseOut=function(c){return -(--c*c*c*c-1)};TWEEN.Easing.Quartic.EaseInOut=function(c){if((c*=2)<1){return 0.5*c*c*c*c}return -0.5*((c-=2)*c*c*c-2)};TWEEN.Easing.Quintic.EaseIn=function(c){return c*c*c*c*c};TWEEN.Easing.Quintic.EaseOut=function(c){return(c-=1)*c*c*c*c+1};TWEEN.Easing.Quintic.EaseInOut=function(c){if((c*=2)<1){return 0.5*c*c*c*c*c}return 0.5*((c-=2)*c*c*c*c+2)};TWEEN.Easing.Sinusoidal.EaseIn=function(c){return -Math.cos(c*Math.PI/2)+1};TWEEN.Easing.Sinusoidal.EaseOut=function(c){return Math.sin(c*Math.PI/2)};TWEEN.Easing.Sinusoidal.EaseInOut=function(c){return -0.5*(Math.cos(Math.PI*c)-1)};TWEEN.Easing.Exponential.EaseIn=function(c){return c==0?0:Math.pow(2,10*(c-1))};TWEEN.Easing.Exponential.EaseOut=function(c){return c==1?1:-Math.pow(2,-10*c)+1};TWEEN.Easing.Exponential.EaseInOut=function(c){if(c==0){return 0}if(c==1){return 1}if((c*=2)<1){return 0.5*Math.pow(2,10*(c-1))}return 0.5*(-Math.pow(2,-10*(c-1))+2)};TWEEN.Easing.Circular.EaseIn=function(c){return -(Math.sqrt(1-c*c)-1)};TWEEN.Easing.Circular.EaseOut=function(c){return Math.sqrt(1- --c*c)};TWEEN.Easing.Circular.EaseInOut=function(c){if((c/=0.5)<1){return -0.5*(Math.sqrt(1-c*c)-1)}return 0.5*(Math.sqrt(1-(c-=2)*c)+1)};TWEEN.Easing.Elastic.EaseIn=function(f){var h,j=0.1,i=0.4;if(f==0){return 0}if(f==1){return 1}i||(i=0.3);if(!j||j<1){j=1;h=i/4}else{h=i/(2*Math.PI)*Math.asin(1/j)}return -(j*Math.pow(2,10*(f-=1))*Math.sin((f-h)*2*Math.PI/i))};TWEEN.Easing.Elastic.EaseOut=function(f){var h,j=0.1,i=0.4;if(f==0){return 0}if(f==1){return 1}i||(i=0.3);if(!j||j<1){j=1;h=i/4}else{h=i/(2*Math.PI)*Math.asin(1/j)}return j*Math.pow(2,-10*f)*Math.sin((f-h)*2*Math.PI/i)+1};TWEEN.Easing.Elastic.EaseInOut=function(f){var h,j=0.1,i=0.4;if(f==0){return 0}if(f==1){return 1}i||(i=0.3);if(!j||j<1){j=1;h=i/4}else{h=i/(2*Math.PI)*Math.asin(1/j)}if((f*=2)<1){return -0.5*j*Math.pow(2,10*(f-=1))*Math.sin((f-h)*2*Math.PI/i)}return j*Math.pow(2,-10*(f-=1))*Math.sin((f-h)*2*Math.PI/i)*0.5+1};TWEEN.Easing.Back.EaseIn=function(c){return c*c*(2.70158*c-1.70158)};TWEEN.Easing.Back.EaseOut=function(c){return(c-=1)*c*(2.70158*c+1.70158)+1};TWEEN.Easing.Back.EaseInOut=function(c){if((c*=2)<1){return 0.5*c*c*(3.5949095*c-2.5949095)}return 0.5*((c-=2)*c*(3.5949095*c+2.5949095)+2)};TWEEN.Easing.Bounce.EaseIn=function(c){return 1-TWEEN.Easing.Bounce.EaseOut(1-c)};TWEEN.Easing.Bounce.EaseOut=function(c){return(c/=1)<1/2.75?7.5625*c*c:c<2/2.75?7.5625*(c-=1.5/2.75)*c+0.75:c<2.5/2.75?7.5625*(c-=2.25/2.75)*c+0.9375:7.5625*(c-=2.625/2.75)*c+0.984375};TWEEN.Easing.Bounce.EaseInOut=function(c){if(c<0.5){return TWEEN.Easing.Bounce.EaseIn(c*2)*0.5}return TWEEN.Easing.Bounce.EaseOut(c*2-1)*0.5+0.5};
/*!
 * BubbleTree 2.0.2
 *
 * Copyright (c) 2011 Gregor Aisch (http://driven-by-data.net)
 * Licensed under the MIT license
 *
 */
;var BubbleTree=function(a,f,c){var e=jQuery;var d=this;d.version="2.0.1-openspending";d.$container=a.container;d.config=a;if(!d.config.hasOwnProperty("rootPath")){d.config.rootPath=""}d.tooltip=a.tooltipCallback?a.tooltipCallback:function(){};if(a.tooltip){d.tooltip=a.tooltip}d.style=a.bubbleStyles;d.ns=BubbleTree;d.nodesByUrlToken={};d.nodeList=[];d.iconsByUrlToken={};d.globalNodeCounter=0;d.displayObjects=[];d.bubbleScale=1;d.globRotation=0;d.currentYear=a.initYear;d.currentCenter=undefined;d.currentTransition=undefined;d.baseUrl="";d.loadData=function(h){e.ajax({url:h,dataType:"json",success:this.setData.bind(this)})};d.setData=function(i){var h=this;if(!i){i=h.config.data}h.initData(i);h.initPaper();h.initBubbles();h.initTween();h.initHistory()};d.initData=function(h){var i=this;h.level=0;i.preprocessData(h);i.traverse(h,0);i.treeRoot=h};d.preprocessData=function(q){var p=this,t=p.config.maxNodesPerLevel;if(t){if(t<q.children.length){var o=p.sortChildren(q.children);o.reverse();var h=[],l=[],k=0,j;for(var n in q.children){if(n<t){h.push(q.children[n])}else{l.push(q.children[n]);k+=Math.max(0,q.children[n].amount)}}q.children=h;q.children.push({label:"More",name:"more",amount:k,children:l,breakdown:j})}}};d.traverse=function(n,i){var p,o,h,l=this,j,k=l.config.bubbleStyles;if(!n.children){n.children=[]}l.nodeList.push(n);n.famount=l.ns.Utils.formatNumber(n.amount);if(n.parent){n.level=n.parent.level+1}if(l.config.clearColors===true){n.color=false}if(k){n.color=k.colors.getColor(n.name||n.id);n.icon=k.icons.svg.getIcon(n.name||n.id,k.icons.path)}if(!n.color){if(n.level>0){n.color=n.parent.color}else{n.color="#999999"}}if(n.children.length<2&&n.color){n.color=vis4color.fromHex(n.color).saturation("*.86").x}if(n.level>0){h=n.parent.children;if(h.length>1){n.left=h[(i-1+h.length)%h.length];n.right=h[(Number(i)+1)%h.length];if(n.right==n.left){n.right=undefined}}}if(n.label!==undefined&&n.label!==""){j=n.label}else{if(n.token!==undefined&&n.token!==""){j=n.token}else{j=""+l.globalNodeCounter}}l.globalNodeCounter++;n.urlToken=j.toLowerCase().replace(/\W/g,"-");while(l.nodesByUrlToken.hasOwnProperty(n.urlToken)){n.urlToken+="-"}l.nodesByUrlToken[n.urlToken]=n;n.maxChildAmount=0;n.children=l.sortChildren(n.children,true,l.config.sortBy);e.each(n.children,function(t,q){q.parent=n;n.maxChildAmount=Math.max(n.maxChildAmount,q.amount);l.traverse(q,t)});if(n.breakdowns){n.breakdownsByName={};e.each(n.breakdowns,function(t,q){q.famount=l.ns.Utils.formatNumber(q.amount);if(q.name){n.breakdownsByName[q.name]=q}})}};d.sortChildren=function(i,k,l){var h=[],j=true;if(l=="label"){l=d.compareLabels;k=false}else{l=d.compareAmounts}i.sort(l);if(k){while(i.length>0){h.push(j?i.pop():i.shift());j=!j}return h}else{return i}};d.compareAmounts=function(i,h){if(i.amount>h.amount){return 1}if(i.amount==h.amount){return 0}return -1};d.compareLabels=function(i,h){if(i.label>h.label){return 1}if(i.label==h.label){return 0}return -1};d.initPaper=function(){var q=this,j=q.$container,l=q.treeRoot,u=j.width(),p=j.height(),k=Raphael(j[0],u,p),n=Math.min(u,p)*0.5-40,i,o=q.ns.Vector,t=new o(u*0.5,p*0.5);console.log(t);q.width=u;q.height=p;q.paper=k;i=Math.pow((Math.pow(l.amount,0.6)+Math.pow(l.maxChildAmount,0.6)*2)/n,1.6666666667);q.a2radBase=q.ns.a2radBase=i;q.origin=t;e(window).resize(q.onResize.bind(q))};d.onResize=function(){var p=this,j=p.$container,t=j.width(),o=j.height(),n=Math.min(t,o)*0.5-40,i,k=p.treeRoot,q,l;p.paper.setSize(t,o);p.origin.x=t*0.5;p.origin.y=o*0.5;p.width=t;p.height=o;i=Math.pow((Math.pow(k.amount,0.6)+Math.pow(k.maxChildAmount,0.6)*2)/n,1.6666666667);p.a2radBase=p.ns.a2radBase=i;e.each(p.displayObjects,function(h,u){if(u.className=="bubble"){u.bubbleRad=p.ns.Utils.amount2rad(u.node.amount)}});if(p.currentCenter){p.changeView(p.currentCenter.urlToken)}};d.initTween=function(){this.tweenTimer=setInterval(this.loop,1000/120)};d.initBubbles=function(){var n=this,h=n.treeRoot,k,j=false,o=n.ns.Bubbles,p;n.bubbleClasses=[];if(!n.config.hasOwnProperty("bubbleType")){n.config.bubbleType=["plain"]}if(!e.isArray(n.config.bubbleType)){n.config.bubbleType=[n.config.bubbleType]}if(e.isArray(n.config.bubbleType)){e.each(n.config.bubbleType,function(q){if(n.config.bubbleType[q]=="icon"){j=true}n.bubbleClasses.push(n.getBubbleType(n.config.bubbleType[q]))})}var l=n.createBubble(h,n.origin,0,0,h.color);n.traverseBubbles(l)};d.getBubbleType=function(j){var h=this,i=h.ns.Bubbles;switch(j){case"pie":return i.Pies;case"donut":return i.Donut;case"multi":return i.Multi;case"icon":return i.Icon;default:return i.Plain}};d.traverseBubbles=function(o){var v=this,p,k=v.ns.Utils.amount2rad,q,u,j,z,n=0,h=0,w,l,t=Math.PI*2;j=o.node.children;e.each(j,function(A,B){n+=k(B.amount)});if(j.length>0){p=v.createRing(o.node,o.pos,0,{stroke:"#888","stroke-dasharray":"-"})}e.each(j,function(A,B){w=k(B.amount)/n*t;l=h+w*0.5;if(isNaN(l)){vis4.log(h,w,B.amount,n,t)}B.centerAngle=l;z=v.createBubble(B,o.pos,0,l,B.color);h+=w;v.traverseBubbles(z)})};d.createBubble=function(h,u,p,j,k){var o=this,t=o.ns,l,q,n,v=h.level;if(isNaN(v)){v=0}v=Math.min(v,o.bubbleClasses.length-1);n=new o.bubbleClasses[v](h,o,u,p,j,k);o.displayObjects.push(n);return n};d.createRing=function(o,j,i,h){var n=this,l=n.ns,k;k=new l.Ring(o,n,j,i,h);n.displayObjects.push(k);return k};d.changeView=function(z){var A=this,h=A.paper,V=Math.min(A.width,A.height)*0.35,ab=A.ns,ag=ab.Utils,Z=A.origin,S={stroke:"#ccc","stroke-dasharray":"- "},B={stroke:"#ccc","stroke-dasharray":". "},k=ag.amount2rad,I=A.treeRoot,af=A.nodesByUrlToken,P=af.hasOwnProperty(z)?af[z]:null,W=new ab.Layout(),n,ad,ac,N=Math.PI*2,U=A.getBubble.bind(A),p=A.getRing.bind(A),E=A.unifyAngle;if(P!==null){var v,M,aa,ae,J,F,D,l,w,ah,R,O,C,q=false,L=false;for(ac in A.displayObjects){A.displayObjects[ac].hideFlag=true}if(P==I||P.parent==I&&P.children.length<2){W.$(A).bubbleScale=1;W.$(Z).x=A.width*0.5;W.$(Z).y=A.height*0.5;v=U(I);if(P!=I){v.childRotation=-P.centerAngle}F=k(I.amount)+k(I.maxChildAmount)+20;R=p(I);W.$(R).rad=F;for(ac in I.children){J=I.children[ac];n=U(J);W.$(n).angle=E(J.centerAngle+v.childRotation);W.$(n).rad=F}}else{var G=P;if(P.children.length<2){P=P.parent}O=V/(k(P.amount)+k(P.maxChildAmount)*2);W.$(A).bubbleScale=O;v=U(P);if(A.currentCenter&&A.currentCenter==P.left){L=true}else{if(A.currentCenter&&A.currentCenter==P.right){q=true}}var H=A.shortestAngleTo;W.$(v).angle=H(v.angle,0);F=(k(P.amount)+k(P.maxChildAmount))*O+20;R=p(P);W.$(R).rad=F;M=U(P.parent);M.childRotation=-P.centerAngle;var Q=M;while(Q&&Q.node.parent){Q=U(Q.node.parent,true);W.$(Q).rad=0}W.$(M).rad=0;var X=A.width*0.5;D=0-Math.max(X*0.8-O*(k(P.parent.amount)+k(Math.max(P.amount*1.15+P.maxChildAmount*1.15,P.left.amount*0.85,P.right.amount*0.85))),O*k(P.parent.amount)*-1+X*0.15)+X;if(P.left&&P.right){var T=O*k(Math.max(P.left.amount,P.right.amount))}C=F+D;W.$(Z).x=A.width*0.5-D-(P!=G?F*0.35:0);W.$(Z).y=A.height*0.5;new vis4.DelayedTask(1500,vis4,vis4.log,Z,M.pos);D+=A.width*0.1;R=p(P.parent);W.$(R).rad=D;W.$(v).rad=D;var u=0-(P!=G?G.centerAngle+v.childRotation:0);for(var ac=0;ac<P.children.length;ac++){J=P.children[ac];n=U(J);W.$(n).angle=A.shortestAngleTo(n.angle,J.centerAngle+v.childRotation+u);W.$(n).rad=F}var Y=A.height*0.07;if(P.left){aa=P.left;w=k(aa.amount)*O;ah=N-Math.asin((A.paper.height*0.5+w-Y)/D);n=U(aa);W.$(n).rad=D;W.$(n).angle=H(n.angle,ah)}if(P.right){aa=P.right;w=k(aa.amount)*O;ah=Math.asin((A.paper.height*0.5+w-Y)/D);n=U(aa);W.$(n).rad=D;W.$(n).angle=H(n.angle,ah)}P=G}for(ac in A.displayObjects){var j=A.displayObjects[ac];if(j.hideFlag&&j.visible){W.$(j).alpha=0;if(j.className=="bubble"&&j.node.level>1){W.$(j).rad=0}W.hide(j)}else{if(!j.hideFlag){W.$(j).alpha=1;if(!j.visible){j.alpha=0;W.show(j)}}}}ad=new ab.Transitioner(e.browser.msie||A.currentCenter==P?0:1000);ad.changeLayout(W);A.currentTransition=ad;if(!A.currentCenter&&e.isFunction(A.config.firstNodeCallback)){A.config.firstNodeCallback(P)}A.currentCenter=P}else{ag.log("node "+z+" not found")}};d.unifyAngle=function(h){var j=Math.PI,i=j*2;while(h>=i){h-=i}while(h<0){h+=i}return h};d.shortestAngle=function(n,k){var l=function(p){return Math.round(p/Math.PI*180)+""};var o=Math.PI,j=o*2,i=d.unifyAngle;n=i(n);k=i(k);var h=k-n;if(h>o){h-=j}if(h<-o){h+=j}return h};d.shortestAngleTo=function(i,h){return i+d.shortestAngle(i,h)};d.shortestLeftTurn=function(j,i){var h=d.shortestAngle(j,i);if(h>0){h=h-Math.PI*2}return j+h};d.shortestRightTurn=function(j,i){var h=d.shortestAngle(j,i);if(h<0){h=Math.PI*2+h}return j+h};d.getBubble=function(i,h){return this.getDisplayObject("bubble",i,h)};d.getRing=function(h){return this.getDisplayObject("ring",h)};d.getDisplayObject=function(k,n,j){var l=this,h,p;for(h in l.displayObjects){p=l.displayObjects[h];if(p.className!=k){continue}if(p.node==n){if(!j){p.hideFlag=false}return p}}vis4.log(k+" not found for node",n)};d.initHistory=function(){e.history.init(d.urlChanged.bind(d),{unescape:",/"})};d.freshUrl="";d.urlChanged=function(j){var h=this,i=h.currentTransition;if(!h.freshUrl){if(j.indexOf("/~/")){h.baseUrl=j.substr(0,j.indexOf("/~/"))}}h.freshUrl=j;if(i&&i.running){vis4.log("transition is running at the moment, adding listener");i.onComplete(h.changeUrl.bind(h))}else{h.changeUrl()}};d.changeUrl=function(){var j=this,k=j.freshUrl.split("/"),i=k[k.length-1],h;if(j.freshUrl===""){j.navigateTo(j.treeRoot)}if(j.nodesByUrlToken.hasOwnProperty(i)){h=j.getUrlForNode(j.nodesByUrlToken[i]);if(j.freshUrl!=h){e.history.load(h)}else{j.navigateTo(j.nodesByUrlToken[i],true)}}else{j.navigateTo(j.treeRoot)}};d.navigateTo=function(j,h){var i=this;if(h){i.changeView(j.urlToken)}else{e.history.load(i.getUrlForNode(j))}e(".label, .label2",i.$container).removeClass("current");e(".label2."+j.id,i.$container).addClass("current");e(".label."+j.id,i.$container).addClass("current")};d.getUrlForNode=function(h){var i=[];i.push(h.urlToken);while(h.parent){i.push(h.parent.urlToken);h=h.parent}i.reverse();return d.baseUrl+"/~/"+i.join("/")};d.onNodeClick=function(h){if(e.isFunction(d.config.nodeClickCallback)){d.config.nodeClickCallback(h)}};d.clean=function(){var j=this,h;e(".label").remove()};this.loop=function(){TWEEN.update()};if(!d.config.hasOwnProperty("data")){throw new Error("no data")}if(typeof d.config.data=="string"){d.loadData()}else{new vis4.DelayedTask(1000,d,d.setData,d.config.data)}};BubbleTree.Styles={};BubbleTree.Layout=function(){var c=jQuery;var a=this;a.objects=[];a.props=[];a.toHide=[];a.toShow=[];a.$=function(h){var e=this,d,j,f;for(d in e.objects){j=e.objects[d];if(j==h){return e.props[d]}}e.objects.push(h);f={};e.props.push(f);return f};a.show=function(e){var d=this;d.toShow.push(e)};a.hide=function(e){var d=this;d.toHide.push(e)}};BubbleTree.Line=function(h,a,c,i,d,f){var e=jQuery;this.bc=h;this.o=c;this.angle=i;this.fromRad=d;this.attr=a;this.toRad=f;this.getXY=function(){this.x1=this.o.x+Math.cos(this.angle)*this.fromRad;this.y1=this.o.y-Math.sin(this.angle)*this.fromRad;this.x2=this.o.x+Math.cos(this.angle)*this.toRad;this.y2=this.o.y-Math.sin(this.angle)*this.toRad};this.init=function(){this.getXY();console.log("foo","M"+this.x1+" "+this.y1+"L"+this.x2+" "+this.y2,a);this.path=this.bc.paper.path("M"+this.x1+" "+this.y1+"L"+this.x2+" "+this.y2).attr(this.attr)};this.draw=function(){this.getXY();this.path.attr({path:"M"+this.x1+" "+this.y1+"L"+this.x2+" "+this.y2})};this.init()};BubbleTree.Loader=function(a){var d=jQuery;var c=this;c.config=a;c.ns=BubbleTree;c.loadData=function(){var f=this,e=f.config.data;console.log("loading url ",e);d.ajax({url:e,context:f,dataType:"json",success:function(h){this.run(h)}})};c.run=function(h){var e=this;var f=new BubbleTree(e.config);f.setData(h);e.config.instance=f};if(!c.config.hasOwnProperty("data")){}if(typeof c.config.data=="string"){c.loadData()}else{c.run(c.config.data)}};BubbleTree.MouseEventGroup=function(e,a){var d=jQuery;var c=this;c.target=e;c.members=a;c.click=function(l){var j=this,f=j.members,h,k;j.clickCallback=l;for(h in f){k=f[h];d(k).click(j.handleClick.bind(j))}};c.handleClick=function(f){var h=this;h.clickCallback({target:h.target,origEvent:f,mouseEventGroup:h})};c.hover=function(l){var j=this,f=j.members,h,k;j.hoverCallback=l;for(h in f){k=f[h];d(k).hover(j.handleMemberHover.bind(j),j.handleMemberUnHover.bind(j))}};c.unhover=function(h){var f=this;f.unhoverCallback=h};c.wasHovering=false;c.mouseIsOver=false;c.handleMemberHover=function(f){var h=this;new vis4.DelayedTask(25,h,h.handleMemberHoverDelayed,f)};c.handleMemberHoverDelayed=function(f){var h=this;h.mouseIsOver=true;if(!h.wasHovering){h.wasHovering=true;if(d.isFunction(h.hoverCallback)){h.hoverCallback({target:h.target,origEvent:f,mouseEventGroup:h})}}};c.handleMemberUnHover=function(f){var h=this;h.mouseIsOver=false;new vis4.DelayedTask(40,h,h.handleMemberUnHoverDelayed,f)};c.handleMemberUnHoverDelayed=function(f){var h=this;if(!h.mouseIsOver){h.wasHovering=false;if(d.isFunction(h.unhoverCallback)){h.unhoverCallback({target:h.target,origEvent:f,mouseEventGroup:h})}}};c.addMember=function(h){var f=this;if(f.hoverCallback){d(h).hover(f.handleMemberHover.bind(f),f.handleMemberUnHover.bind(f))}f.members.push(h)};c.removeMember=function(l){var k=this,f=k.members,j,h=[];if(k.clickCallback){d(l).unbind("click")}if(k.hoverCallback){d(l).unbind("mouseenter mouseleave")}for(j in f){if(f[j]!=l){h.push(f[j])}}k.members=h}};BubbleTree.Ring=function(e,h,i,c,a){var f=jQuery;var d=this;d.className="ring";d.rad=c;d.bc=h;d.attr=a;d.origin=i;d.alpha=1;d.visible=false;d.node=e;d.init=function(){};d.draw=function(){var j=this,k=j.origin;if(!j.visible){return}j.circle.attr({cx:k.x,cy:k.y,r:j.rad,"stroke-opacity":j.alpha})};d.hide=function(){var j=this;j.circle.remove();j.visible=false};d.show=function(){var j=this;j.circle=j.bc.paper.circle(i.x,i.y,j.rad).attr(j.attr);j.visible=true;j.circle.toBack()};d.init()};BubbleTree.Transitioner=function(d){var c=jQuery;var a=this;a.duration=d;a.running=false;a.completeCallbacks=[];a.changeLayout=function(k){var f,n,h,l,j=this;j.running=true;j.layout=k;for(f in k.toShow){n=k.toShow[f];if(c.isFunction(n.show)){n.show()}}for(f in k.objects){n=k.objects[f];if(n===undefined||n===null){continue}h=k.props[f];if(j.duration>0){var e=new TWEEN.Tween(n),q={};for(l in h){q[l]=h[l]}e.to(q,j.duration);e.easing(TWEEN.Easing.Exponential.EaseOut);if(c.isFunction(n.draw)){e.onUpdate(n.draw.bind(n))}if(f==k.objects.length-1){e.onComplete(j._completed.bind(j))}e.start()}else{for(l in h){n[l]=h[l]}if(n&&c.isFunction(n.draw)){n.draw()}}}if(j.duration===0){for(f in k.objects){n=k.objects[f];if(n&&c.isFunction(n.draw)){n.draw()}}j._completed()}};a.onComplete=function(i){var f=this;try{if(c.isFunction(i)){f.completeCallbacks.push(i)}}catch(h){}};a._completed=function(){var h=this,f=h.completeCallbacks,e,j;h.running=false;for(e in h.layout.objects){j=h.layout.objects[e];if(j&&c.isFunction(j.draw)){j.draw()}}for(e in h.layout.toHide){j=h.layout.toHide[e];if(j&&c.isFunction(j.hide)){j.hide()}}for(e in f){f[e]()}}};BubbleTree.Utils={};BubbleTree.Utils.log=function(){try{if(window.hasOwnProperty("console")){console.log.apply(this,arguments)}}catch(a){}};BubbleTree.Utils.amount2rad=function(c){return Math.pow(Math.max(0,c)/BubbleTree.a2radBase,0.6)};BubbleTree.Utils.formatNumber=function(c){var a="";if(c<0){c=c*-1;a="-"}if(c>=1000000000000){return a+Math.round(c/100000000000)/10+"t"}if(c>=1000000000){return a+Math.round(c/100000000)/10+"b"}if(c>=1000000){return a+Math.round(c/100000)/10+"m"}if(c>=1000){return a+Math.round(c/100)/10+"k"}else{return a+c}};BubbleTree.Vector=function(a,d){var c=this;c.x=a;c.y=d;c.length=function(){var e=this;return Math.sqrt(e.x*e.x+e.y*e.y)};c.normalize=function(e){var h=this,f=h.length();if(!e){e=1}h.x*=e/f;h.y*=e/f};c.clone=function(){var e=this;return new BubbleTree.Vector(e.x,e.y)}};BubbleTree.Bubbles=BubbleTree.Bubbles||{};BubbleTree.Bubbles.Plain=function(a,f,l,h,c,d){var e=jQuery;var j=BubbleTree,k=j.Utils,i=this;i.className="bubble";i.node=a;i.paper=f.paper;i.origin=l;i.bc=f;i.rad=h;i.angle=c;i.color=d;i.alpha=1;i.visible=false;i.ns=j;i.pos=j.Vector(0,0);i.bubbleRad=k.amount2rad(this.node.amount);i.container=i.bc.$container;i.childRotation=0;i.getXY=function(){var q=this,t=q.origin,n=q.angle,p=q.rad;if(q.pos===undefined){q.pos=new q.ns.Vector(0,0)}q.pos.x=t.x+Math.cos(n)*p;q.pos.y=t.y-Math.sin(n)*p};i.init=function(){var n=this;n.getXY();var o=false;if(!n.node.shortLabel){n.node.shortLabel=n.node.label.length>50?n.node.label.substr(0,30)+"...":n.node.label}n.initialized=true};i.onclick=function(o){var n=this;n.bc.onNodeClick(n.node);n.bc.navigateTo(n.node)};i.onhover=function(o){var n=this,p=n.bc.$container[0];o.node=n.node;o.target=n;o.bubblePos={x:n.pos.x,y:n.pos.y};o.mousePos={x:o.origEvent.pageX-p.offsetLeft,y:o.origEvent.pageY-p.offsetTop};o.type="SHOW";n.bc.tooltip(o)};i.onunhover=function(o){var n=this,p=n.bc.$container[0];o.node=n.node;o.type="HIDE";o.target=n;o.bubblePos={x:n.pos.x,y:n.pos.y};o.mousePos={x:o.origEvent.pageX-p.offsetLeft,y:o.origEvent.pageY-p.offsetTop};n.bc.tooltip(o)};i.draw=function(){var u=this,n=Math.max(5,u.bubbleRad*u.bc.bubbleScale),p=u.pos.x,o=u.pos.y,q=u.getXY(),t=n>20,z=u.pos.x,v=u.pos.y;if(!u.visible){return}u.circle.attr({cx:u.pos.x,cy:u.pos.y,r:n,"fill-opacity":u.alpha});if(u.node.children.length>1){u.dashedBorder.attr({cx:u.pos.x,cy:u.pos.y,r:n-4,"stroke-opacity":u.alpha*0.9})}else{u.dashedBorder.attr({"stroke-opacity":0})}if(!t){u.label.hide();u.label2.show()}else{u.label.show();if(n<40){u.label.find(".desc").hide();u.label2.show()}else{u.label.find(".desc").show();u.label2.hide()}}u.label.css({width:2*n+"px",opacity:u.alpha});u.label.css({left:(u.pos.x-n)+"px",top:(u.pos.y-u.label.height()*0.5)+"px"});var A=Math.max(80,3*n);u.label2.css({width:A+"px",opacity:u.alpha});u.label2.css({left:(z-A*0.5)+"px",top:(v+n)+"px"})};i.hide=function(){var o=this,n;o.circle.remove();o.dashedBorder.remove();o.label.remove();o.label2.remove();o.visible=false};i.show=function(){var t=this,p,o=t.pos.x,v=t.pos.y,q=Math.max(5,t.bubbleRad*t.bc.bubbleScale);t.circle=t.paper.circle(o,v,q).attr({stroke:false,fill:t.color});t.dashedBorder=t.paper.circle(o,v,q-3).attr({stroke:"#ffffff","stroke-dasharray":"- "});t.label=e('<div class="label '+t.node.id+'"><div class="amount">'+k.formatNumber(t.node.amount)+'</div><div class="desc">'+t.node.shortLabel+"</div></div>");t.container.append(t.label);if(t.node.children.length>0){e(t.circle.node).css({cursor:"pointer"});e(t.label).css({cursor:"pointer"})}t.label2=e('<div class="label2 '+t.node.id+'"><span>'+t.node.shortLabel+"</span></div>");t.container.append(t.label2);var u=[t.circle.node,t.label,t.dashedBorder.node];var n=new t.ns.MouseEventGroup(t,u);n.click(t.onclick.bind(t));n.hover(t.onhover.bind(t));n.unhover(t.onunhover.bind(t));t.visible=true};i.addOverlay=function(){var n=this;n.overlay=n.paper.circle(n.circle.attrs.cx,n.circle.attrs.cy,n.circle.attrs.r).attr({stroke:false,fill:"#fff",opacity:0});if(Raphael.svg){n.overlay.node.setAttribute("class",n.node.id)}e(n.overlay.node).css({cursor:"pointer"});e(n.overlay.node).click(n.onclick.bind(n));e(n.label).click(n.onclick.bind(n))};i.init()};BubbleTree.Bubbles=BubbleTree.Bubbles||{};BubbleTree.Bubbles.Donut=function(a,f,l,h,c,d){var e=jQuery;var j=BubbleTree,k=j.Utils,i=this;i.className="bubble";i.node=a;i.paper=f.paper;i.origin=l;i.bc=f;i.rad=h;i.angle=c;i.color=d;i.alpha=1;i.visible=false;i.ns=j;i.bubbleRad=k.amount2rad(this.node.amount);i.childRotation=0;i.getXY=function(){var q=this,t=q.origin,n=q.angle,p=q.rad;q.pos.x=t.x+Math.cos(n)*p;q.pos.y=t.y-Math.sin(n)*p};i.init=function(){var q=this;q.pos=new q.ns.Vector(0,0);q.getXY();var u=[],n,o,v,t=[],p=q.bc.config.bubbleStyles;if(!q.node.shortLabel){q.node.shortLabel=q.node.label.length>50?q.node.label.substr(0,30)+"...":q.node.label}q.breakdownOpacities=[0.2,0.7,0.45,0.6,0.35];q.breakdownColors=[false,false,false,false,false,false,false,false,false,false];for(o in q.node.breakdowns){n=q.node.breakdowns[o];n.famount=k.formatNumber(n.amount);v=n.amount/q.node.amount;u.push(v);t.push(n);if(p&&p.hasOwnProperty("name")&&p.name.hasOwnProperty(n.name)&&p.name[n.name].hasOwnProperty("opacity")){q.breakdownOpacities[t.length-1]=p.name[n.name].opacity}if(p&&p.hasOwnProperty("name")&&p.name.hasOwnProperty(n.name)&&p.name[n.name].hasOwnProperty("color")){q.breakdownColors[t.length-1]=p.name[n.name].color;q.breakdownOpacities[t.length-1]=1}}q.node.breakdowns=t;q.breakdown=u;var w=false;q.initialized=true};i.onclick=function(o){var n=this;n.bc.navigateTo(n.node)};i.onhover=function(o){var n=this,p=n.bc.$container[0];o.node=n.node;o.target=n;o.bubblePos={x:n.pos.x,y:n.pos.y};o.mousePos={x:o.origEvent.pageX-p.offsetLeft,y:o.origEvent.pageY-p.offsetTop};o.type="SHOW";n.bc.tooltip(o)};i.onunhover=function(o){var n=this,p=n.bc.$container[0];o.node=n.node;o.target=n;o.type="HIDE";o.bubblePos={x:n.pos.x,y:n.pos.y};o.mousePos={x:o.origEvent.pageX-p.offsetLeft,y:o.origEvent.pageY-p.offsetTop};n.bc.tooltip(o)};this.draw=function(){var N=this,C=Math.max(5,N.bubbleRad*N.bc.bubbleScale),u=N.pos.x,t=N.pos.y,H=N.getXY(),L=C>20,A=N.pos.x,z=N.pos.y;if(!N.visible){return}N.circle.attr({cx:A,cy:z,r:C,"fill-opacity":N.alpha});if(N.node.children.length>1){N.dashedBorder.attr({cx:A,cy:z,r:C*0.85,"stroke-opacity":N.alpha*0.8})}else{N.dashedBorder.attr({"stroke-opacity":0})}if(N.breakdown.length>1){var F,M,J,I,G,q,p,o,n,v=C*0.85,E=-Math.PI*0.5,O;for(F in N.breakdown){O=N.breakdown[F]*Math.PI*2;M=A+Math.cos((E))*v;q=z+Math.sin((E))*v;J=A+Math.cos((E+O))*v;p=z+Math.sin((E+O))*v;I=A+Math.cos((E+O))*C;o=z+Math.sin((E+O))*C;G=A+Math.cos((E))*C;n=z+Math.sin((E))*C;E+=O;var D="M"+M+" "+q+" A"+v+","+v+" 0 "+(O>Math.PI?"1,1":"0,1")+" "+J+","+p+" L"+I+" "+o+" A"+C+","+C+" 0 "+(O>Math.PI?"1,0":"0,0")+" "+G+" "+n+" Z";N.breakdownArcs[F].attr({path:D,"stroke-opacity":N.alpha*0.2,"fill-opacity":N.breakdownOpacities[F]*N.alpha})}}if(!L){N.label.hide();N.label2.show()}else{N.label.show();if(C<40){N.label.find(".desc").hide();N.label2.show()}else{N.label.find(".desc").show();N.label2.hide()}}N.label.css({width:2*C*0.9+"px",opacity:N.alpha});N.label.css({left:(N.pos.x-C*0.9)+"px",top:(N.pos.y-N.label.height()*0.53)+"px"});var B=Math.max(80,3*C);N.label2.css({width:B+"px",opacity:N.alpha});N.label2.css({left:(A-B*0.5)+"px",top:(z+C)+"px"})};this.hide=function(){var o=this,n;o.circle.remove();o.dashedBorder.remove();o.label.remove();o.label2.remove();o.visible=false;for(n in o.breakdownArcs){o.breakdownArcs[n].remove()}};i.show=function(){var u=this,q,t=Math.max(5,u.bubbleRad*u.bc.bubbleScale);u.circle=u.paper.circle(u.pos.x,u.pos.y,t).attr({stroke:false,fill:u.color});if(e.isFunction(u.bc.config.initTooltip)){u.bc.config.initTooltip(u.node,u.circle.node)}u.dashedBorder=u.paper.circle(u.pos.x,u.pos.y,t*0.85).attr({stroke:"#fff","stroke-opacity":u.alpha*0.4,"stroke-dasharray":". ",fill:false});u.label=e('<div class="label '+u.node.id+'"><div class="amount">'+k.formatNumber(u.node.amount)+'</div><div class="desc">'+u.node.shortLabel+"</div></div>");u.bc.$container.append(u.label);if(u.node.children.length>1){e(u.circle.node).css({cursor:"pointer"});e(u.label).css({cursor:"pointer"})}u.label2=e('<div class="label2 '+u.node.id+'"><span>'+u.node.shortLabel+"</span></div>");u.bc.$container.append(u.label2);var v=[u.circle.node,u.label];if(u.breakdown.length>1){u.breakdownArcs={};for(q in u.breakdown){var o=u.breakdownColors[q]?u.breakdownColors[q]:"#fff",p=u.paper.path("M 0 0 L 2 2").attr({fill:o,"fill-opacity":Math.random()*0.4+0.3,stroke:"#fff"});u.breakdownArcs[q]=p;if(e.isFunction(u.bc.config.initTooltip)){u.bc.config.initTooltip(u.node.breakdowns[q],p.node)}}for(q in u.breakdownArcs){e(u.breakdownArcs[q].node).click(u.onclick.bind(u))}}var n=new u.ns.MouseEventGroup(u,v);n.click(u.onclick.bind(u));n.hover(u.onhover.bind(u));n.unhover(u.onunhover.bind(u));u.visible=true};i.arcHover=function(u){var q=this,v=q.bc.$container[0],n,p=q.breakdownArcs,o,t=q.node.breakdowns;for(n in p){if(p[n].node==u.target){u.node=t[n];u.bubblePos={x:q.pos.x,y:q.pos.y};u.mousePos={x:u.pageX-v.offsetLeft,y:u.pageY-v.offsetTop};u.target=q;u.type="SHOW";q.bc.tooltip(u);return}}vis4.log("cant find the breakdown node")};i.arcUnhover=function(u){var q=this,v=q.bc.$container[0],n,p=q.breakdownArcs,o,t=q.node.breakdowns;for(n in p){if(p[n].node==u.target){u.node=t[n];u.bubblePos={x:q.pos.x,y:q.pos.y};u.mousePos={x:u.pageX-v.offsetLeft,y:u.pageY-v.offsetTop};u.type="HIDE";u.target=q;q.bc.tooltip(u);return}}vis4.log("cant find the breakdown node")};i.init()};BubbleTree.Bubbles=BubbleTree.Bubbles||{};BubbleTree.Bubbles.Icon=function(a,f,l,h,c,d){var e=jQuery;var j=BubbleTree,k=j.Utils,i=this;i.className="bubble";i.node=a;i.paper=f.paper;i.origin=l;i.bc=f;i.rad=h;i.angle=c;i.color=d;i.alpha=1;i.visible=false;i.ns=j;i.pos=j.Vector(0,0);i.bubbleRad=k.amount2rad(this.node.amount);i.iconLoaded=false;i.childRotation=0;i.getXY=function(){var q=this,t=q.origin,n=q.angle,p=q.rad;if(q.pos===undefined){q.pos=new q.ns.Vector(0,0)}q.pos.x=t.x+Math.cos(n)*p;q.pos.y=t.y-Math.sin(n)*p};i.init=function(){var n=this;n.getXY();if(e.browser.msie){n.hasIcon=false}else{n.hasIcon=n.node.hasOwnProperty("icon")}if(!n.node.shortLabel){n.node.shortLabel=n.node.label.length>50?n.node.label.substr(0,30)+"...":n.node.label}n.initialized=true};i.show=function(){var t=this,o,n=t.pos.x,p,u=t.pos.y,q=Math.max(5,t.bubbleRad*t.bc.bubbleScale);t.circle=t.paper.circle(n,u,q).attr({stroke:false,fill:t.color});t.dashedBorder=t.paper.circle(n,u,Math.min(q-3,q*0.95)).attr({stroke:"#ffffff","stroke-dasharray":"- "});if(e.isFunction(t.bc.config.initTooltip)){t.bc.config.initTooltip(t.node,t.circle.node)}t.label=e('<div class="label '+t.node.id+'"><div class="amount">'+k.formatNumber(t.node.amount)+'</div><div class="desc">'+t.node.shortLabel+"</div></div>");t.bc.$container.append(t.label);if(e.isFunction(t.bc.config.initTooltip)){t.bc.config.initTooltip(t.node,t.label[0])}t.label2=e('<div class="label2 '+t.node.id+'"><span>'+t.node.shortLabel+"</span></div>");t.bc.$container.append(t.label2);if(t.node.children.length>0){e(t.circle.node).css({cursor:"pointer"});e(t.label).css({cursor:"pointer"})}t.visible=true;if(t.hasIcon){if(!t.iconLoaded){t.loadIcon()}else{t.displayIcon()}}else{t.addOverlay()}};i.loadIcon=function(){var o=this,n=new vis4loader();n.add(o.bc.config.rootPath+o.node.icon);n.load(o.iconLoadComplete.bind(o))};i.iconLoadComplete=function(p){var q=this,n,o,t;n=p.items[0].data;q.iconPathData="";n=e(n);t=e("path",n);for(o in t){if(t[o]&&e.isFunction(t[o].getAttribute)){q.iconPathData+=String(t[o].getAttribute("d"))+" "}}q.iconLoaded=true;q.displayIcon()};i.displayIcon=function(){var o=this,n,p;o.iconPaths=[];p=o.paper.path(o.iconPathData);p.attr({fill:"#fff",stroke:"none"}).translate(-50,-50);o.iconPaths.push(p);o.addOverlay()};i.addOverlay=function(){var o=this;o.overlay=o.paper.circle(o.circle.attrs.cx,o.circle.attrs.cy,o.circle.attrs.r).attr({stroke:false,fill:"#fff","fill-opacity":0});if(Raphael.svg){o.overlay.node.setAttribute("class",o.node.id)}e(o.overlay.node).css({cursor:"pointer"});e(o.overlay.node).click(o.onclick.bind(o));e(o.label).click(o.onclick.bind(o));e(o.label2).click(o.onclick.bind(o));if(e.isPlainObject(o.bc.tooltip)){var n=o.bc.tooltip.content(o.node);e(o.overlay.node).qtip({position:{target:"mouse",viewport:e(window),adjust:{x:7,y:7}},show:{delay:o.bc.tooltip.delay||100},content:{title:n[0],text:n[1]}})}o.draw()};i.removeIcon=function(){var o=this,n,p;if(o.iconPaths){for(var n=0;n<o.iconPaths.length;n++){o.iconPaths[n].remove()}}o.iconPaths=[]};i.draw=function(){var C=this,n=Math.max(5,C.bubbleRad*C.bc.bubbleScale),q=C.pos.x,o=C.pos.y,v=C.getXY(),E=C.pos.x,D=C.pos.y,B=C.hasIcon&&n>15,A=C.hasIcon?n>40:n>20,z,G,u,t,p;if(!C.visible){return}C.circle.attr({cx:E,cy:D,r:n,"fill-opacity":C.alpha});if(C.overlay){C.overlay.attr({cx:E,cy:D,r:Math.max(10,n)})}if(C.node.children.length>1){C.dashedBorder.attr({cx:C.pos.x,cy:C.pos.y,r:Math.min(n-3,n-4),"stroke-opacity":C.alpha*0.9})}else{C.dashedBorder.attr({"stroke-opacity":0})}if(!A){C.label.hide();C.label2.show()}else{C.label.show();if((B&&n<70)||(!B&&n<40)){C.label.find(".desc").hide();C.label2.show()}else{C.label.find(".desc").show();C.label2.hide()}}p=B?D+n*0.77-C.label.height():D-C.label.height()*0.5;C.label.css({width:(B?n*1.2:2*n)+"px",opacity:C.alpha});C.label.css({left:(B?E-n*0.6:E-n)+"px",top:p+"px"});var F=Math.max(80,3*n);C.label2.css({width:F+"px",opacity:C.alpha});C.label2.css({left:(E-F*0.5)+"px",top:(D+n)+"px"});if(C.hasIcon){if(B){u=(n-(A?C.label.height()*0.5:0))/60;if(C.iconPaths){for(var z=0;z<C.iconPaths.length;z++){G=C.iconPaths[z];if(Raphael.version[0]=="1"){t="scale("+u+") translate("+(E/u)+", "+((D+(A?C.label.height()*-0.5:0))/u)+")"}else{t="scale("+u+") translate("+(E/u-50)+", "+((D+(A?C.label.height()*-0.5:0))/u-50)+")"}G.node.setAttribute("transform",t);G.attr({"fill-opacity":C.alpha})}}}else{if(C.iconPaths){for(var z=0;z<C.iconPaths.length;z++){G=C.iconPaths[z];G.attr({"fill-opacity":0})}}}}};i.hide=function(){var o=this,n;o.circle.remove();o.dashedBorder.remove();o.label.remove();o.label2.remove();o.visible=false;if(o.hasIcon){o.removeIcon()}if(o.overlay){o.overlay.remove()}};i.onclick=function(o){var n=this;n.bc.onNodeClick(n.node);n.bc.navigateTo(n.node)};i.onhover=function(o){var n=this,p=n.bc.$container[0];o.node=n.node;o.bubblePos={x:n.pos.x,y:n.pos.y};o.mousePos={x:o.origEvent.pageX-p.offsetLeft,y:o.origEvent.pageY-p.offsetTop};o.type="SHOW";o.target=n;n.bc.tooltip(o)};i.onunhover=function(o){var n=this,p=n.bc.$container[0];o.node=n.node;o.type="HIDE";o.target=n;o.bubblePos={x:n.pos.x,y:n.pos.y};o.mousePos={x:o.origEvent.pageX-p.offsetLeft,y:o.origEvent.pageY-p.offsetTop};n.bc.tooltip(o)};i.init()};(function(aa,Z,Y){function A(ad,ac){var ab,z,w,v,u,h=aa(this),f=aa(document.body),e=this===document?f:h,d=h.metadata?h.metadata(ac.metadata):V,a=ac.metadata.type==="html5"&&d?d[ac.metadata.name]:V,af=h.data(ac.metadata.name||"qtipopts");try{af=typeof af==="string"?(new Function("return "+af))():af}catch(ae){D("Unable to parse HTML5 attribute data: "+af)}v=aa.extend(X,{},U.defaults,ac,typeof af==="object"?C(af):V,C(a||d)),z=v.position,v.id=ad;if("boolean"===typeof v.content.text){w=h.attr(v.content.attr);if(v.content.attr!==W&&w){v.content.text=w}else{D("Unable to locate content for tooltip! Aborting render of tooltip on element: ",h);return W}}z.container===W&&(z.container=f),z.target===W&&(z.target=e),v.show.target===W&&(v.show.target=e),v.show.solo===X&&(v.show.solo=f),v.hide.target===W&&(v.hide.target=e),v.position.viewport===X&&(v.position.viewport=z.container),z.at=new T.Corner(z.at),z.my=new T.Corner(z.my);if(aa.data(this,"qtip")){if(v.overwrite){h.qtip("destroy")}else{if(v.overwrite===W){return W}}}v.suppress&&(u=aa.attr(this,"title"))&&aa(this).removeAttr("title").attr(F,u),ab=new B(h,v,ad,!!w),aa.data(this,"qtip",ab),h.bind("remove.qtip-"+ad,function(){ab.destroy()});return ab}function B(ae,ac,q,n){function a(){var t=[ac.show.target[0],ac.hide.target[0],k.rendered&&u.tooltip[0],ac.position.container[0],ac.position.viewport[0],Z,document];k.rendered?aa([]).pushStack(aa.grep(t,function(w){return typeof w==="object"})).unbind(v):ac.show.target.unbind(v+"-create")}function c(){function ak(an){ab.is(":visible")&&k.reposition(an)}function al(an){if(ab.hasClass(O)){return W}clearTimeout(k.timers.inactive),k.timers.inactive=setTimeout(function(){k.hide(an)},ac.hide.inactive)}function t(an){if(ab.hasClass(O)||af||ad){return W}var ar=aa(an.relatedTarget||an.target),aq=ar.closest(N)[0]===ab[0],ap=ar[0]===aj.show[0];clearTimeout(k.timers.show),clearTimeout(k.timers.hide);if(am.target==="mouse"&&aq||ac.hide.fixed&&(/mouse(out|leave|move)/.test(an.type)&&(aq||ap))){try{an.preventDefault(),an.stopImmediatePropagation()}catch(ao){}}else{ac.hide.delay>0?k.timers.hide=setTimeout(function(){k.hide(an)},ac.hide.delay):k.hide(an)}}function w(ao){if(ab.hasClass(O)){return W}clearTimeout(k.timers.show),clearTimeout(k.timers.hide);var an=function(){k.toggle(X,ao)};ac.show.delay>0?k.timers.show=setTimeout(an,ac.show.delay):an()}var am=ac.position,aj={show:ac.show.target,hide:ac.hide.target,viewport:aa(am.viewport),document:aa(document),body:aa(document.body),window:aa(Z)},ai={show:aa.trim(""+ac.show.event).split(" "),hide:aa.trim(""+ac.hide.event).split(" ")},z=aa.browser.msie&&parseInt(aa.browser.version,10)===6;ab.bind("mouseenter"+v+" mouseleave"+v,function(ao){var an=ao.type==="mouseenter";an&&k.focus(ao),ab.toggleClass(J,an)}),ac.hide.fixed&&(aj.hide=aj.hide.add(ab),ab.bind("mouseover"+v,function(){ab.hasClass(O)||clearTimeout(k.timers.hide)})),/mouse(out|leave)/i.test(ac.hide.event)?ac.hide.leave==="window"&&aj.window.bind("mouseout"+v+" blur"+v,function(an){/select|option/.test(an.target)&&!an.relatedTarget&&k.hide(an)}):/mouse(over|enter)/i.test(ac.show.event)&&aj.hide.bind("mouseleave"+v,function(an){clearTimeout(k.timers.show)}),(""+ac.hide.event).indexOf("unfocus")>-1&&aj.body.bind("mousedown"+v,function(an){var ap=aa(an.target),ao=!ab.hasClass(O)&&ab.is(":visible");ap[0]!==ab[0]&&ap.parents(N).length===0&&ap.add(ae).length>1&&!ap.attr("disabled")&&k.hide(an)}),"number"===typeof ac.hide.inactive&&(aj.show.bind("qtip-"+q+"-inactive",al),aa.each(U.inactiveEvents,function(ao,an){aj.hide.add(u.tooltip).bind(an+v+"-inactive",al)})),aa.each(ai.hide,function(an,aq){var ap=aa.inArray(aq,ai.show),ao=aa(aj.hide);ap>-1&&ao.add(aj.show).length===ao.length||aq==="unfocus"?(aj.show.bind(aq+v,function(ar){ab.is(":visible")?t(ar):w(ar)}),delete ai.show[ap]):aj.hide.bind(aq+v,t)}),aa.each(ai.show,function(ao,an){aj.show.bind(an+v,w)}),"number"===typeof ac.hide.distance&&aj.show.add(ab).bind("mousemove"+v,function(ao){var an=p.origin||{},aq=ac.hide.distance,ap=Math.abs;(ap(ao.pageX-an.pageX)>=aq||ap(ao.pageY-an.pageY)>=aq)&&k.hide(ao)}),am.target==="mouse"&&(aj.show.bind("mousemove"+v,function(an){S={pageX:an.pageX,pageY:an.pageY,type:"mousemove"}}),am.adjust.mouse&&(ac.hide.event&&ab.bind("mouseleave"+v,function(an){(an.relatedTarget||an.target)!==aj.show[0]&&k.hide(an)}),aj.document.bind("mousemove"+v,function(an){!ab.hasClass(O)&&ab.is(":visible")&&k.reposition(an||S)}))),(am.adjust.resize||aj.viewport.length)&&(aa.event.special.resize?aj.viewport:aj.window).bind("resize"+v,ak),(aj.viewport.length||z&&ab.css("position")==="fixed")&&aj.viewport.bind("scroll"+v,ak)}function d(t,ai){function w(aj){function ak(an){an&&(delete al[an.src],clearTimeout(k.timers.img[an.src]),aa(an).unbind(v)),aa.isEmptyObject(al)&&(k.redraw(),ai!==W&&k.reposition(p.event),aj())}var am,al={};if((am=z.find("img:not([height]):not([width])")).length===0){return ak()}am.each(function(an,ar){if(al[ar.src]===Y){var aq=0,ap=3;(function ao(){if(ar.height||ar.width||aq>ap){return ak(ar)}aq+=1,k.timers.img[ar.src]=setTimeout(ao,700)})(),aa(ar).bind("error"+v+" load"+v,function(){ak(this)}),al[ar.src]=ar}})}var z=u.content;if(!k.rendered||!t){return W}aa.isFunction(t)&&(t=t.call(ae,p.event,k)||""),t.jquery&&t.length>0?z.empty().append(t.css({display:"block"})):z.html(t),k.rendered<0?ab.queue("fx",w):(ad=0,w(aa.noop));return k}function e(t,z){var w=u.title;if(!k.rendered||!t){return W}aa.isFunction(t)&&(t=t.call(ae,p.event,k));if(t===W){return j(W)}t.jquery&&t.length>0?w.empty().append(t.css({display:"block"})):w.html(t),k.redraw(),z!==W&&k.rendered&&ab.is(":visible")&&k.reposition(p.event)}function f(w){var t=u.button,z=u.title;if(!k.rendered){return W}w?(z||h(),i()):t.remove()}function h(){var t=ag+"-title";u.titlebar&&j(),u.titlebar=aa("<div />",{"class":Q+"-titlebar "+(ac.style.widget?"ui-widget-header":"")}).append(u.title=aa("<div />",{id:t,"class":Q+"-title","aria-atomic":X})).insertBefore(u.content).delegate(".ui-tooltip-close","mousedown keydown mouseup keyup mouseout",function(w){aa(this).toggleClass("ui-state-active ui-state-focus",w.type.substr(-4)==="down")}).delegate(".ui-tooltip-close","mouseover mouseout",function(w){aa(this).toggleClass("ui-state-hover",w.type==="mouseover")}),ac.content.title.button?i():k.rendered&&k.redraw()}function i(){var t=ac.content.title.button,z=typeof t==="string",w=z?t:"Close tooltip";u.button&&u.button.remove(),t.jquery?u.button=t:u.button=aa("<a />",{"class":"ui-state-default ui-tooltip-close "+(ac.style.widget?"":Q+"-icon"),title:w,"aria-label":w}).prepend(aa("<span />",{"class":"ui-icon ui-icon-close",html:"&times;"})),u.button.appendTo(u.titlebar).attr("role","button").click(function(ai){ab.hasClass(O)||k.hide(ai);return W}),k.redraw()}function j(t){u.title&&(u.titlebar.remove(),u.titlebar=u.title=u.button=V,t!==W&&k.reposition())}function l(){var t=ac.style.widget;ab.toggleClass(P,t).toggleClass(M,!t),u.content.toggleClass(P+"-content",t),u.titlebar&&u.titlebar.toggleClass(P+"-header",t),u.button&&u.button.toggleClass(Q+"-icon",!t)}function o(w){var t=0,aj,ai=ac,z=w.split(".");while(ai=ai[z[t++]]){t<z.length&&(aj=ai)}return[aj||ac,z.pop()]}var k=this,ah=document.body,ag=Q+"-"+q,af=0,ad=0,ab=aa(),v=".qtip-"+q,u,p;k.id=q,k.rendered=W,k.elements=u={target:ae},k.timers={img:{}},k.options=ac,k.checks={},k.plugins={},k.cache=p={event:{},target:aa(),disabled:W,attr:n},k.checks.builtin={"^id$":function(t,aj,ai){var z=ai===X?U.nextid:ai,w=Q+"-"+z;z!==W&&z.length>0&&!aa("#"+w).length&&(ab[0].id=w,u.content[0].id=w+"-content",u.title[0].id=w+"-title")},"^content.text$":function(w,t,z){d(z)},"^content.title.text$":function(w,t,z){if(!z){return j()}!u.title&&z&&h(),e(z)},"^content.title.button$":function(w,t,z){f(z)},"^position.(my|at)$":function(w,t,z){"string"===typeof z&&(w[t]=new T.Corner(z))},"^position.container$":function(w,t,z){k.rendered&&ab.appendTo(z)},"^show.ready$":function(){k.rendered?k.toggle(X):k.render(1)},"^style.classes$":function(w,t,z){ab.attr("class",Q+" qtip ui-helper-reset "+z)},"^style.widget|content.title":l,"^events.(render|show|move|hide|focus|blur)$":function(t,z,w){ab[(aa.isFunction(w)?"":"un")+"bind"]("tooltip"+z,w)},"^(show|hide|position).(event|target|fixed|inactive|leave|distance|viewport|adjust)":function(){var t=ac.position;ab.attr("tracking",t.target==="mouse"&&t.adjust.mouse),a(),c()}},aa.extend(k,{render:function(t){if(k.rendered){return k}var aj=ac.content.text,ai=ac.content.title.text,z=ac.position,w=aa.Event("tooltiprender");aa.attr(ae[0],"aria-describedby",ag),ab=u.tooltip=aa("<div/>",{id:ag,"class":Q+" qtip ui-helper-reset "+M+" "+ac.style.classes+" "+Q+"-pos-"+ac.position.my.abbrev(),width:ac.style.width||"",height:ac.style.height||"",tracking:z.target==="mouse"&&z.adjust.mouse,role:"alert","aria-live":"polite","aria-atomic":W,"aria-describedby":ag+"-content","aria-hidden":X}).toggleClass(O,p.disabled).data("qtip",k).appendTo(ac.position.container).append(u.content=aa("<div />",{"class":Q+"-content",id:ag+"-content","aria-atomic":X})),k.rendered=-1,af=ad=1,ai&&(h(),aa.isFunction(ai)||e(ai,W)),aa.isFunction(aj)||d(aj,W),k.rendered=X,l(),aa.each(ac.events,function(ak,al){aa.isFunction(al)&&ab.bind(ak==="toggle"?"tooltipshow tooltiphide":"tooltip"+ak,al)}),aa.each(T,function(){this.initialize==="render"&&this(k)}),c(),ab.queue("fx",function(ak){w.originalEvent=p.event,ab.trigger(w,[k]),af=ad=0,k.redraw(),(ac.show.ready||t)&&k.toggle(X,p.event),ak()});return k},get:function(w){var t,z;switch(w.toLowerCase()){case"dimensions":t={height:ab.outerHeight(),width:ab.outerWidth()};break;case"offset":t=T.offset(ab,ac.position.container);break;default:z=o(w.toLowerCase()),t=z[0][z[1]],t=t.precedance?t.string():t}return t},set:function(an,am){function t(ap,ao){var at,ar,aq;for(at in z){for(ar in z[at]){if(aq=(new RegExp(ar,"i")).exec(ap)){ao.push(aq),z[at][ar].apply(k,ao)}}}}var al=/^position\.(my|at|adjust|target|container)|style|content|show\.ready/i,ak=/^content\.(title|attr)|style/i,aj=W,ai=W,z=k.checks,w;"string"===typeof an?(w=an,an={},an[w]=am):an=aa.extend(X,{},an),aa.each(an,function(ar,aq){var ap=o(ar.toLowerCase()),ao;ao=ap[0][ap[1]],ap[0][ap[1]]="object"===typeof aq&&aq.nodeType?aa(aq):aq,an[ar]=[ap[0],ap[1],aq,ao],aj=al.test(ar)||aj,ai=ak.test(ar)||ai}),C(ac),af=ad=1,aa.each(an,t),af=ad=0,ab.is(":visible")&&k.rendered&&(aj&&k.reposition(ac.position.target==="mouse"?V:p.event),ai&&k.redraw());return k},toggle:function(ap,ao){function t(){ap?(aa.browser.msie&&ab[0].style.removeAttribute("filter"),ab.css("overflow",""),"string"===typeof am.autofocus&&aa(am.autofocus,ab).focus(),w=aa.Event("tooltipvisible"),w.originalEvent=ao?p.event:V,ab.trigger(w,[k]),am.target.trigger("qtip-"+q+"-inactive")):ab.css({display:"",visibility:"",opacity:"",left:"",top:""})}if(!k.rendered){return ap?k.render(1):k}var an=ap?"show":"hide",am=ac[an],al=ab.is(":visible"),ak=!ao||ac[an].target.length<2||p.target[0]===ao.target,aj=ac.position,ai=ac.content,z,w;(typeof ap).search("boolean|number")&&(ap=!al);if(!ab.is(":animated")&&al===ap&&ak){return k}if(ao){if(/over|enter/.test(ao.type)&&/out|leave/.test(p.event.type)&&ao.target===ac.show.target[0]&&ab.has(ao.relatedTarget).length){return k}p.event=aa.extend({},ao)}w=aa.Event("tooltip"+an),w.originalEvent=ao?p.event:V,ab.trigger(w,[k,90]);if(w.isDefaultPrevented()){return k}aa.attr(ab[0],"aria-hidden",!ap),ap?(p.origin=aa.extend({},S),k.focus(ao),aa.isFunction(ai.text)&&d(ai.text,W),aa.isFunction(ai.title.text)&&e(ai.title.text,W),!E&&aj.target==="mouse"&&aj.adjust.mouse&&(aa(document).bind("mousemove.qtip",function(aq){S={pageX:aq.pageX,pageY:aq.pageY,type:"mousemove"}}),E=X),k.reposition(ao),(w.solo=!!am.solo)&&aa(N,am.solo).not(ab).qtip("hide",w)):(clearTimeout(k.timers.show),delete p.origin,E&&!aa(N+'[tracking="true"]:visible',am.solo).not(ab).length&&(aa(document).unbind("mousemove.qtip"),E=W),k.blur(ao)),ak&&ab.stop(0,1),am.effect===W?(ab[an](),t.call(ab)):aa.isFunction(am.effect)?(am.effect.call(ab,k),ab.queue("fx",function(aq){t(),aq()})):ab.fadeTo(90,ap?1:0,t),ap&&am.target.trigger("qtip-"+q+"-inactive");return k},show:function(t){return k.toggle(X,t)},hide:function(t){return k.toggle(W,t)},focus:function(t){if(!k.rendered){return k}var al=aa(N),ak=parseInt(ab[0].style.zIndex,10),aj=U.zindex+al.length,ai=aa.extend({},t),z,w;ab.hasClass(L)||(w=aa.Event("tooltipfocus"),w.originalEvent=ai,ab.trigger(w,[k,aj]),w.isDefaultPrevented()||(ak!==aj&&(al.each(function(){this.style.zIndex>ak&&(this.style.zIndex=this.style.zIndex-1)}),al.filter("."+L).qtip("blur",ai)),ab.addClass(L)[0].style.zIndex=aj));return k},blur:function(t){var z=aa.extend({},t),w;ab.removeClass(L),w=aa.Event("tooltipblur"),w.originalEvent=z,ab.trigger(w,[k]);return k},reposition:function(aB,aA){if(!k.rendered||af){return k}af=1;var az=ac.position.target,ay=ac.position,ax=ay.my,aw=ay.at,av=ay.adjust,au=av.method.split(" "),at=ab.outerWidth(),ar=ab.outerHeight(),aq=0,ao=0,an=aa.Event("tooltipmove"),al=ab.css("position")==="fixed",aj=ay.viewport,ai={left:0,top:0},z=ay.container,t=W,ap=k.plugins.tip,am={horizontal:au[0],vertical:au[1]=au[1]||au[0],enabled:aj.jquery&&az[0]!==Z&&az[0]!==ah&&av.method!=="none",left:function(aL){var aK=am.horizontal==="shift",aJ=-z.offset.left+aj.offset.left+aj.scrollLeft,aI=ax.x==="left"?at:ax.x==="right"?-at:-at/2,aH=aw.x==="left"?aq:aw.x==="right"?-aq:-aq/2,aG=ap&&ap.size?ap.size.width||0:0,aF=ap&&ap.corner&&ap.corner.precedance==="x"&&!aK?aG:0,aE=aJ-aL+aF,aD=aL+at-aj.width-aJ+aF,aC=aI-(ax.precedance==="x"||ax.x===ax.y?aH:0),w=ax.x==="center";aK?(aF=ap&&ap.corner&&ap.corner.precedance==="y"?aG:0,aC=(ax.x==="left"?1:-1)*aI-aF,ai.left+=aE>0?aE:aD>0?-aD:0,ai.left=Math.max(-z.offset.left+aj.offset.left+(aF&&ap.corner.x==="center"?ap.offset:0),aL-aC,Math.min(Math.max(-z.offset.left+aj.offset.left+aj.width,aL+aC),ai.left))):(aE>0&&(ax.x!=="left"||aD>0)?ai.left-=aC:aD>0&&(ax.x!=="right"||aE>0)&&(ai.left-=w?-aC:aC),ai.left!==aL&&w&&(ai.left-=av.x),ai.left<aJ&&-ai.left>aD&&(ai.left=aL));return ai.left-aL},top:function(aL){var aK=am.vertical==="shift",aJ=-z.offset.top+aj.offset.top+aj.scrollTop,aI=ax.y==="top"?ar:ax.y==="bottom"?-ar:-ar/2,aH=aw.y==="top"?ao:aw.y==="bottom"?-ao:-ao/2,aG=ap&&ap.size?ap.size.height||0:0,aF=ap&&ap.corner&&ap.corner.precedance==="y"&&!aK?aG:0,aE=aJ-aL+aF,aD=aL+ar-aj.height-aJ+aF,aC=aI-(ax.precedance==="y"||ax.x===ax.y?aH:0),w=ax.y==="center";aK?(aF=ap&&ap.corner&&ap.corner.precedance==="x"?aG:0,aC=(ax.y==="top"?1:-1)*aI-aF,ai.top+=aE>0?aE:aD>0?-aD:0,ai.top=Math.max(-z.offset.top+aj.offset.top+(aF&&ap.corner.x==="center"?ap.offset:0),aL-aC,Math.min(Math.max(-z.offset.top+aj.offset.top+aj.height,aL+aC),ai.top))):(aE>0&&(ax.y!=="top"||aD>0)?ai.top-=aC:aD>0&&(ax.y!=="bottom"||aE>0)&&(ai.top-=w?-aC:aC),ai.top!==aL&&w&&(ai.top-=av.y),ai.top<0&&-ai.top>aD&&(ai.top=aL));return ai.top-aL}},ak;if(aa.isArray(az)&&az.length===2){aw={x:"left",y:"top"},ai={left:az[0],top:az[1]}}else{if(az==="mouse"&&(aB&&aB.pageX||p.event.pageX)){aw={x:"left",y:"top"},aB=(aB&&(aB.type==="resize"||aB.type==="scroll")?p.event:aB&&aB.pageX&&aB.type==="mousemove"?aB:S&&S.pageX&&(av.mouse||!aB||!aB.pageX)?{pageX:S.pageX,pageY:S.pageY}:!av.mouse&&p.origin&&p.origin.pageX?p.origin:aB)||aB||p.event||S||{},ai={top:aB.pageY,left:aB.pageX}}else{az==="event"?aB&&aB.target&&aB.type!=="scroll"&&aB.type!=="resize"?az=p.target=aa(aB.target):az=p.target:p.target=aa(az),az=aa(az).eq(0);if(az.length===0){return k}az[0]===document||az[0]===Z?(aq=T.iOS?Z.innerWidth:az.width(),ao=T.iOS?Z.innerHeight:az.height(),az[0]===Z&&(ai={top:al||T.iOS?(aj||az).scrollTop():0,left:al||T.iOS?(aj||az).scrollLeft():0})):az.is("area")&&T.imagemap?ai=T.imagemap(az,aw,am.enabled?au:W):az[0].namespaceURI==="http://www.w3.org/2000/svg"&&T.svg?ai=T.svg(az,aw):(aq=az.outerWidth(),ao=az.outerHeight(),ai=T.offset(az,z)),ai.offset&&(aq=ai.width,ao=ai.height,t=ai.flipoffset,ai=ai.offset);if(T.iOS<4.1&&T.iOS>3.1||T.iOS==4.3||!T.iOS&&al){ak=aa(Z),ai.left-=ak.scrollLeft(),ai.top-=ak.scrollTop()}ai.left+=aw.x==="right"?aq:aw.x==="center"?aq/2:0,ai.top+=aw.y==="bottom"?ao:aw.y==="center"?ao/2:0}}ai.left+=av.x+(ax.x==="right"?-at:ax.x==="center"?-at/2:0),ai.top+=av.y+(ax.y==="bottom"?-ar:ax.y==="center"?-ar/2:0),am.enabled?(aj={elem:aj,height:aj[(aj[0]===Z?"h":"outerH")+"eight"](),width:aj[(aj[0]===Z?"w":"outerW")+"idth"](),scrollLeft:al?0:aj.scrollLeft(),scrollTop:al?0:aj.scrollTop(),offset:aj.offset()||{left:0,top:0}},z={elem:z,scrollLeft:z.scrollLeft(),scrollTop:z.scrollTop(),offset:z.offset()||{left:0,top:0}},ai.adjusted={left:am.horizontal!=="none"?am.left(ai.left):0,top:am.vertical!=="none"?am.top(ai.top):0},ai.adjusted.left+ai.adjusted.top&&ab.attr("class",ab[0].className.replace(/ui-tooltip-pos-\w+/i,Q+"-pos-"+ax.abbrev())),t&&ai.adjusted.left&&(ai.left+=t.left),t&&ai.adjusted.top&&(ai.top+=t.top)):ai.adjusted={left:0,top:0},an.originalEvent=aa.extend({},aB),ab.trigger(an,[k,ai,aj.elem||aj]);if(an.isDefaultPrevented()){return k}delete ai.adjusted,aA===W||isNaN(ai.left)||isNaN(ai.top)||az==="mouse"||!aa.isFunction(ay.effect)?ab.css(ai):aa.isFunction(ay.effect)&&(ay.effect.call(ab,k,aa.extend({},ai)),ab.queue(function(w){aa(this).css({opacity:"",height:""}),aa.browser.msie&&this.style.removeAttribute("filter"),w()})),af=0;return k},redraw:function(){if(k.rendered<1||ad){return k}var w=ac.position.container,t,aj,ai,z;ad=1,ac.style.height&&ab.css("height",ac.style.height),ac.style.width?ab.css("width",ac.style.width):(ab.css("width","").addClass(I),aj=ab.width()+1,ai=ab.css("max-width")||"",z=ab.css("min-width")||"",t=(ai+z).indexOf("%")>-1?w.width()/100:0,ai=(ai.indexOf("%")>-1?t:1)*parseInt(ai,10)||aj,z=(z.indexOf("%")>-1?t:1)*parseInt(z,10)||0,aj=ai+z?Math.min(Math.max(aj,z),ai):aj,ab.css("width",Math.round(aj)).removeClass(I)),ad=0;return k},disable:function(t){"boolean"!==typeof t&&(t=!ab.hasClass(O)&&!p.disabled),k.rendered?(ab.toggleClass(O,t),aa.attr(ab[0],"aria-disabled",t)):p.disabled=!!t;return k},enable:function(){return k.disable(W)},destroy:function(){var t=ae[0],z=aa.attr(t,F),w=ae.data("qtip");k.rendered&&(ab.remove(),aa.each(k.plugins,function(){this.destroy&&this.destroy()})),clearTimeout(k.timers.show),clearTimeout(k.timers.hide),a();if(!w||k===w){aa.removeData(t,"qtip"),ac.suppress&&z&&(aa.attr(t,"title",z),ae.removeAttr(F)),ae.removeAttr("aria-describedby")}ae.unbind(".qtip-"+q),delete R[k.id];return ae}})}function C(a){var d;if(!a||"object"!==typeof a){return W}if(a.metadata===V||"object"!==typeof a.metadata){a.metadata={type:a.metadata}}if("content" in a){if(a.content===V||"object"!==typeof a.content||a.content.jquery){a.content={text:a.content}}d=a.content.text||W,!aa.isFunction(d)&&(!d&&!d.attr||d.length<1||"object"===typeof d&&!d.jquery)&&(a.content.text=W);if("title" in a.content){if(a.content.title===V||"object"!==typeof a.content.title){a.content.title={text:a.content.title}}d=a.content.title.text||W,!aa.isFunction(d)&&(!d&&!d.attr||d.length<1||"object"===typeof d&&!d.jquery)&&(a.content.title.text=W)}}if("position" in a){if(a.position===V||"object"!==typeof a.position){a.position={my:a.position,at:a.position}}}if("show" in a){if(a.show===V||"object"!==typeof a.show){a.show.jquery?a.show={target:a.show}:a.show={event:a.show}}}if("hide" in a){if(a.hide===V||"object"!==typeof a.hide){a.hide.jquery?a.hide={target:a.hide}:a.hide={event:a.hide}}}if("style" in a){if(a.style===V||"object"!==typeof a.style){a.style={classes:a.style}}}aa.each(T,function(){this.sanitize&&this.sanitize(a)});return a}function D(){D.history=D.history||[],D.history.push(arguments);if("object"===typeof console){var e=console[console.warn?"warn":"log"],d=Array.prototype.slice.call(arguments),f;typeof arguments[0]==="string"&&(d[0]="qTip2: "+d[0]),f=e.apply?e.apply(console,d):e(d)}}"use strict";var X=!0,W=!1,V=null,U,T,S,R={},Q="ui-tooltip",P="ui-widget",O="ui-state-disabled",N="div.qtip."+Q,M=Q+"-default",L=Q+"-focus",J=Q+"-hover",I=Q+"-fluid",H="-31000px",G="_replacedByqTip",F="oldtitle",E;U=aa.fn.qtip=function(c,p,o){var f=(""+c).toLowerCase(),e=V,d=aa.makeArray(arguments).slice(1),a=d[d.length-1],q=this[0]?aa.data(this[0],"qtip"):V;if(!arguments.length&&q||f==="api"){return q}if("string"===typeof c){this.each(function(){var h=aa.data(this,"qtip");if(!h){return X}a&&a.timeStamp&&(h.cache.event=a);if(f!=="option"&&f!=="options"||!p){h[f]&&h[f].apply(h[f],d)}else{if(aa.isPlainObject(p)||o!==Y){h.set(p,o)}else{e=h.get(p);return W}}});return e!==V?e:this}if("object"===typeof c||!arguments.length){q=C(aa.extend(X,{},c));return U.bind.call(this,q,a)}},U.bind=function(a,c){return this.each(function(f){function h(k){function l(){j.render(typeof k==="object"||e.show.ready),d.show.add(d.hide).unbind(t)}if(j.cache.disabled){return W}j.cache.event=aa.extend({},k),j.cache.target=k?aa(k.target):[Y],e.show.delay>0?(clearTimeout(j.timers.show),j.timers.show=setTimeout(l,e.show.delay),u.show!==u.hide&&d.hide.bind(u.hide,function(){clearTimeout(j.timers.show)})):l()}var e,d,u,t,j,i;i=aa.isArray(a.id)?a.id[f]:a.id,i=!i||i===W||i.length<1||R[i]?U.nextid++:R[i]=i,t=".qtip-"+i+"-create",j=A.call(this,i,a);if(j===W){return X}e=j.options,aa.each(T,function(){this.initialize==="initialize"&&this(j)}),d={show:e.show.target,hide:e.hide.target},u={show:aa.trim(""+e.show.event).replace(/ /g,t+" ")+t,hide:aa.trim(""+e.hide.event).replace(/ /g,t+" ")+t},/mouse(over|enter)/i.test(u.show)&&!/mouse(out|leave)/i.test(u.hide)&&(u.hide+=" mouseleave"+t),d.show.bind("mousemove"+t,function(k){S={pageX:k.pageX,pageY:k.pageY,type:"mousemove"}}),d.show.bind(u.show,h),(e.show.ready||e.prerender)&&h(c)})},T=U.plugins={Corner:function(d){d=(""+d).replace(/([A-Z])/," $1").replace(/middle/gi,"center").toLowerCase(),this.x=(d.match(/left|right/i)||d.match(/center/)||["inherit"])[0].toLowerCase(),this.y=(d.match(/top|bottom|center/i)||["inherit"])[0].toLowerCase();var c=d.charAt(0);this.precedance=c==="t"||c==="b"?"y":"x",this.string=function(){return this.precedance==="y"?this.y+this.x:this.x+this.y},this.abbrev=function(){var f=this.x.substr(0,1),e=this.y.substr(0,1);return f===e?f:f==="c"||f!=="c"&&e!=="c"?e+f:f+e},this.clone=function(){return{x:this.x,y:this.y,precedance:this.precedance,string:this.string,abbrev:this.abbrev,clone:this.clone}}},offset:function(u,t){function j(d,c){q.left+=c*d.scrollLeft(),q.top+=c*d.scrollTop()}var q=u.offset(),p=t,o=0,n=document.body,l,k;if(p){do{p.css("position")!=="static"&&(l=p[0]===n?{left:parseInt(p.css("left"),10)||0,top:parseInt(p.css("top"),10)||0}:p.position(),q.left-=l.left+(parseInt(p.css("borderLeftWidth"),10)||0)+(parseInt(p.css("marginLeft"),10)||0),q.top-=l.top+(parseInt(p.css("borderTopWidth"),10)||0),k=p.css("overflow"),(k==="scroll"||k==="auto")&&++o);if(p[0]===n){break}}while(p=p.offsetParent());t[0]!==n&&o&&j(t,1)}return q},iOS:parseFloat((""+(/CPU.*OS ([0-9_]{1,3})|(CPU like).*AppleWebKit.*Mobile/i.exec(navigator.userAgent)||[0,""])[1]).replace("undefined","3_2").replace("_","."))||W,fn:{attr:function(a,k){if(this.length){var j=this[0],i="title",h=aa.data(j,"qtip");if(a===i&&h&&"object"===typeof h&&h.options.suppress){if(arguments.length<2){return aa.attr(j,F)}h&&h.options.content.attr===i&&h.cache.attr&&h.set("content.text",k);return this.attr(F,k)}}return aa.fn["attr"+G].apply(this,arguments)},clone:function(a){var i=aa([]),h="title",f=aa.fn["clone"+G].apply(this,arguments);a||f.filter("["+F+"]").attr("title",function(){return aa.attr(this,F)}).removeAttr(F);return f},remove:aa.ui?V:function(a,d){aa.ui||aa(this).each(function(){d||(!a||aa.filter(a,[this]).length)&&aa("*",this).add(this).each(function(){aa(this).triggerHandler("remove")})})}}},aa.each(T.fn,function(a,f){if(!f||aa.fn[a+G]){return X}var d=aa.fn[a+G]=aa.fn[a];aa.fn[a]=function(){return f.apply(this,arguments)||d.apply(this,arguments)}}),U.version="nightly",U.nextid=0,U.inactiveEvents="click dblclick mousedown mouseup mousemove mouseleave mouseenter".split(" "),U.zindex=15000,U.defaults={prerender:W,id:W,overwrite:X,suppress:X,content:{text:X,attr:"title",title:{text:W,button:W}},position:{my:"top left",at:"bottom right",target:W,container:W,viewport:W,adjust:{x:0,y:0,mouse:X,resize:X,method:"flip flip"},effect:function(a,f,e){aa(this).animate(f,{duration:200,queue:W})}},show:{target:W,event:"mouseenter",effect:X,delay:90,solo:W,ready:W,autofocus:W},hide:{target:W,event:"mouseleave",effect:X,delay:0,fixed:W,inactive:W,leave:"window",distance:W},style:{classes:"",widget:W,width:W,height:W},events:{render:V,move:V,show:V,hide:V,toggle:V,visible:V,focus:V,blur:V}},T.svg=function(w,v){var u=aa(document),t=w[0],q={width:0,height:0,offset:{top:10000000000,left:10000000000}},p,o,n,l,a;if(t.getBBox&&t.parentNode){p=t.getBBox(),o=t.getScreenCTM(),n=t.farthestViewportElement||t;if(!n.createSVGPoint){return q}l=n.createSVGPoint(),l.x=p.x,l.y=p.y,a=l.matrixTransform(o),q.offset.left=a.x,q.offset.top=a.y,l.x+=p.width,l.y+=p.height,a=l.matrixTransform(o),q.width=a.x-q.offset.left,q.height=a.y-q.offset.top,q.offset.left+=u.scrollLeft(),q.offset.top+=u.scrollTop()}return q}})(jQuery,window);var CSV={};(function(f){f.__type__="csv";var d=(typeof jQuery!=="undefined"&&jQuery.Deferred)||_.Deferred;f.fetch=function(o){var k=new d();if(o.file){var j=new FileReader();var n=o.encoding||"UTF-8";j.onload=function(q){var p=f.extractFields(f.parse(q.target.result,o),o);p.useMemoryStore=true;p.metadata={filename:o.file.name};k.resolve(p)};j.onerror=function(p){alert("Failed to load file. Code: "+p.target.error.code)};j.readAsText(o.file,n)}else{if(o.data){var l=f.extractFields(f.parse(o.data,o),o);l.useMemoryStore=true;k.resolve(l)}else{if(o.url){jQuery.get(o.url).done(function(q){var p=f.extractFields(f.parse(q,o),o);p.useMemoryStore=true;k.resolve(p)})}}}return k.promise()};f.extractFields=function(k,j){if(j.noHeaderRow!==true&&k.length>0){return{fields:k[0],records:k.slice(1)}}else{return{records:k}}};f.normalizeDialectOptions=function(k){var j={delimiter:",",doublequote:true,lineterminator:"\n",quotechar:'"',skipinitialspace:true,skipinitialrows:0};for(var l in k){if(l==="trim"){j.skipinitialspace=k.trim}else{j[l.toLowerCase()]=k[l]}}return j};f.parse=function(v,j){v=h(v);var w=f.normalizeDialectOptions(j);var t="",n=false,o=false,q="",u=[],k=[],l,p;p=function(z){if(o!==true){if(z===""){z=null}else{if(w.skipinitialspace===true){z=a(z)}}if(i.test(z)){z=parseInt(z,10)}else{if(e.test(z)){z=parseFloat(z,10)}}}return z};for(l=0;l<v.length;l+=1){t=v.charAt(l);if(n===false&&(t===w.delimiter||t==="\n")){q=p(q);u.push(q);if(t==="\n"){k.push(u);u=[]}q="";o=false}else{if(t!==w.quotechar){q+=t}else{if(!n){n=true;o=true}else{if(v.charAt(l+1)===w.quotechar){q+=w.quotechar;l+=1}else{n=false}}}}}q=p(q);u.push(q);k.push(u);if(w.skipinitialrows){k=k.slice(w.skipinitialrows)}return k};f.objectToArray=function(p){var k=[];var q=[];for(var n=0;n<p.fields.length;n++){q.push(p.fields[n].id)}k.push(q);for(var n=0;n<p.records.length;n++){var l=[];var j=p.records[n];for(var o=0;o<q.length;o++){l.push(j[q[o]])}k.push(l)}return k};f.serialize=function(p,k){var u=null;if(p instanceof Array){u=p}else{u=f.objectToArray(p)}var z=f.normalizeDialectOptions(k);var v="",t="",w="",n="",o,l,q;q=function(j){if(j===null){j=""}else{if(typeof j==="string"&&c.test(j)){if(z.doublequote){j=j.replace(/"/g,'""')}j=z.quotechar+j+z.quotechar}else{if(typeof j==="number"){j=j.toString(10)}}}return j};for(o=0;o<u.length;o+=1){v=u[o];for(l=0;l<v.length;l+=1){t=q(v[l]);if(l===(v.length-1)){w+=t;n+=w+"\n";w=""}else{w+=t+z.delimiter}t=""}}return n};var i=/^\d+$/,e=/^\d*\.\d+$|^\d+\.\d*$/,c=/^\s|\s$|,|"|\n/,a=(function(){if(String.prototype.trim){return function(j){return j.trim()}}else{return function(j){return j.replace(/^\s*/,"").replace(/\s*$/,"")}}}());function h(j){if(j.charAt(j.length-1)!=="\n"){return j}else{return j.substring(0,j.length-1)}}}(CSV));var recline=recline||{};recline.Backend=recline.Backend||{};recline.Backend.CSV=CSV;
/*! openspending.aggregator.js - Aggregation API tools
 * ------------------------------------------------------------------------
 *
 * Copyright 2013 Open Knowledge Foundation
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
;var OpenSpending=OpenSpending||{};OpenSpending.Aggregator=function(){this.configFromQueryString=function(d){var c=OpenSpending.Common.parseQueryString(d);var a={};_.each(c,function(f,e){if(e=="breakdown"){a.breakdown=f}else{if(e=="drilldown"){a.drilldowns=f.split("|")}else{if(e=="cut"){a.cuts=f.split("|")}}}});return a};this.get=function(c){var a=this;a.config=c;if(!a.config.processEntry){a.config.processEntry=function(d){return d}}if(a.config.measure===undefined||_.isString(a.config.measure)){a.config.measure=[a.config.measure||"amount"]}a.queryData=function(){var f={},d=a.config;f.dataset=d.dataset;f.drilldown=d.drilldowns.join("|");f.order=d.order;f.page=d.page;f.pagesize=d.pagesize;f.inflate=d.inflate;if(d.cuts!==undefined){f.cut=d.cuts.join("|")}if(_.isEqual(d.measure,["amount"])){f.measure=d.measure.join("|")}var e=d.drilldowns.slice();if(d.breakdown!==undefined&&d.breakdown.length){e.push(d.breakdown)}e=jQuery.unique(e);f.drilldown=e.join("|");return f};a.queryUrl=function(){var e,d=a.config;if(d.localApiCache!==undefined){return d.localApiCache}apiUrl=d.apiUrl||d.siteUrl+"/api";return apiUrl+"/2/aggregate?callback=?"};a.getTree=function(){var d=a.queryData();jQuery.ajax({url:a.queryUrl(),cache:true,data:d,dataType:a.config.localApiCache!==undefined?"json":"jsonp",context:a,success:a.onJSONTreeLoaded})};a.getCSVURL=function(){var d=a.queryUrl();var e=a.queryData();e.format="csv";return d+"?"+jQuery.param(e)};a.onJSONTreeLoaded=function(e){var d=a.buildTree(e);if(jQuery.isFunction(a.config.callback)){a.config.callback(d)}};a.buildTree=function(n){var o=n.drilldown,f=a.config,j=f.drilldowns,e=f.breakdown,h={label:f.rootNodeLabel},d={},q={id:"root",label:"Total",color:"#555",children:[],level:0,breakdowns:{}};q.currency=_.values(n.summary.currency)[0];_.each(a.config.measure,function(i){q[i]=0});if(h!==undefined){jQuery.extend(true,q,h)}d.root=q;for(var l in j){var k=j[l];d[k]={}}if(n.errors!==undefined){throw"Error"}for(var p=0;p<o.length;p++){var t=a.config.processEntry(o[p],n);a.processEntry(t,d)}return d.root};a.processEntry=function(n,e){var o=e.root,d=0,j,i=a.config.drilldowns,l,f,h;for(var k in i){j=i[k];d=d+1;l=n[j];h=a.toNode(l,o);f=e[h.id];if(f===undefined){f=h;f.children=[];_.each(a.config.measure,function(p){f[p]=0});f.color=l?l.color:undefined;f.level=d;f.breakdowns={};f.currency=o.currency;o.children.push(f);e[f.id]=f}_.each(a.config.measure,function(p){f[p]=f[p]+n[p]});if(d===1){_.each(a.config.measure,function(p){e.root[p]=e.root[p]+n[p]});a.addBreakdown(e.root,n)}a.addBreakdown(f,n);o=f}};a.addBreakdown=function(i,h){var j=a.config.breakdown;if(j===undefined){return}var f,k,e,d={},l;f=h[j];e=a.toNode(f);l=e.id;k=i.breakdowns[l];if(k===undefined){k=e;i.breakdowns[l]=k}_.each(a.config.measure,function(n){k[n]=k[n]+h[n]})};a.toNode=function(h,e){var d=typeof(h);var f={};prefix=e?e.id+"__":"";if(h===undefined||h===null){f.id="others";f.label="Others";f.name="others"}else{if(d==="object"){if(h.id===undefined){f.id="others";f.label="Others";f.name="others"}else{jQuery.extend(true,f,h);if(!f.name){if(f.label){f.name=f.label.toLowerCase().replace(/\W/g,"-")}else{f.name=f.id}}}}else{if(d==="boolean"){if(h){f.id="yes";f.label="Yes";f.name="yes"}else{f.id="no";f.label="No";f.name="no"}}else{if(d==="string"||d==="number"){f.id=h+"";f.label=h+"";f.name=f.id.toLowerCase().replace(/\W/g,"-")}else{throw"unsupported type: "+d}}}}f.id=prefix+f.id;_.each(a.config.measure,function(i){f[i]=0});return f};a.getTree()}};
/*! openspending.amounts.js - Amount formatting for OpenSpending
 * ------------------------------------------------------------------------
 *
 * Copyright 2013 Open Knowledge Foundation
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
;var OpenSpending=OpenSpending||{};OpenSpending.Amounts=OpenSpending.Amounts||{};OpenSpending.Amounts.shorthand=function(e){var c=1000000000;var a=1000000;var f=1000;var d=Math.abs(e);if(d>c){return OpenSpending.Amounts.format(e/c)+"bn"}else{if(d>a){return OpenSpending.Amounts.format(e/a)+"m"}else{if(d>f){return OpenSpending.Amounts.format(e/f)+"k"}else{return OpenSpending.Amounts.format(e,2)}}}};OpenSpending.Amounts.format=function(d,c,a){a=OpenSpending.Amounts.currencySymbol(a);return accounting.formatMoney(d,a,c||0,OpenSpending.localeGroupSeparator,OpenSpending.localeDecimalSeparator)};OpenSpending.Amounts.currencySymbol=function(a){if(a){return OpenSpending.Amounts.currencySymbols[a]||a}else{return""}};OpenSpending.Amounts.currencySymbols={AED:"د.إ",AFN:"؋",ALL:"L",AMD:"դր.",ANG:"ƒ",AOA:"Kz",ARS:"$",AUD:"$",AWG:"ƒ",AZN:"m",BAM:"KM",BBD:"$",BDT:"৳",BGN:"лв",BHD:"ب.د",BIF:"Fr",BMD:"$",BND:"$",BOB:"Bs.",BRL:"R$",BSD:"$",BTN:"Nu",BWP:"P",BYR:"Br",BZD:"$",CAD:"$",CDF:"Fr",CHF:"Fr",CLP:"$",CNY:"¥",COP:"$",CRC:"₡",CUP:"$",CVE:"$, Esc",CZK:"Kč",DJF:"Fr",DKK:"kr",DOP:"$",DZD:"د.ج",EEK:"KR",EGP:"£,ج.م",ERN:"Nfk",ETB:"Br",EUR:"€",FJD:"$",FKP:"£",GBP:"£",GEL:"ლ",GHS:"₵",GIP:"£",GMD:"D",GNF:"Fr",GTQ:"Q",GYD:"$",HKD:"$",HNL:"L",HRK:"kn",HTG:"G",HUF:"Ft",IDR:"Rp",ILS:"₪",INR:"₨",IQD:"ع.د",IRR:"﷼",ISK:"kr",JMD:"$",JOD:"د.ا",JPY:"¥",KES:"KSh",KGS:"лв",KHR:"៛",KMF:"Fr",KPW:"₩",KRW:"₩",KWD:"د.ك",KYD:"$",KZT:"Т",LAK:"₭",LBP:"ل.ل",LKR:"ரூ",LRD:"$",LSL:"L",LTL:"Lt",LVL:"Ls",LYD:"ل.د",MAD:"د.م.",MDL:"MDL",MGA:"Ar",MKD:"ден",MMK:"K",MNT:"₮",MOP:"P",MRO:"UM",MUR:"₨",MVR:"ރ.",MWK:"MK",MXN:"$",MYR:"RM",MZN:"MT",NAD:"$",NGN:"₦",NIO:"C$",NOK:"kr",NPR:"₨",NZD:"$",OMR:"ر.ع.",PAB:"B/.",PEN:"S/.",PGK:"K",PHP:"₱",PKR:"₨",PLN:"zł",PYG:"₲",QAR:"ر.ق",RON:"RON",RSD:"RSD",RUB:"р.",RWF:"Fr",SAR:"ر.س",SBD:"$",SCR:"₨",SDG:"S$",SEK:"kr",SGD:"$",SHP:"£",SLL:"Le",SOS:"Sh",SRD:"$",STD:"Db",SYP:"£, ل.س",SZL:"L",THB:"฿",TJS:"ЅМ",TMT:"m",TND:"د.ت",TOP:"T$",TRY:"₤",TTD:"$",TWD:"$",TZS:"Sh",UAH:"₴",UGX:"Sh",USD:"$",UYU:"$",UZS:"лв",VEF:"Bs",VND:"₫",VUV:"Vt",WST:"T",XAF:"Fr",XCD:"$",XOF:"Fr",XPF:"Fr",YER:"﷼",ZAR:"R",ZMK:"ZK",ZWL:"$"};
/*! openspending.bubble.js - Core OS visualisation component: The bubble
 * ------------------------------------------------------------------------
 *
 * Copyright 2013 Open Knowledge Foundation
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
;function bubble(){var a=35;var d="#830242";var h="#eee";var f=true;var i=false;var e=undefined;function c(j){j.each(function(o,k){$(k).empty();var n=Raphael(k,a*2,a*2+5);var l=n.set();l.push(n.circle(a,a,a).attr({fill:i?"none":d,stroke:"none"}));if(f){l.push(n.circle(a,a,a-2).attr({fill:"none",stroke:i?"none":h,"stroke-dasharray":"- "}))}if(e){$.get(e).then(function(p){if(typeof(p)=="string"){p=$(p);p=p[p.length-1]}if(!p.getElementsByTagName){return}var v="";var A=p.getElementsByTagName("path");for(var t=0;t<A.length;t++){v+=A[t].getAttribute("d")+" "}var u=n.path(v);l.push(u);u.attr({fill:h,stroke:"none"});var z=u.getBBox();u.translate(a-(z.x+z.width/2),a-(z.y+z.height/2));var q=a*2*0.7;var w=q/Math.max(z.width,z.height);u.scale(w,w)})}})}c.radius=function(j){if(!arguments.length){return a}a=j;return c};c.background=function(j){if(!arguments.length){return d}d=j;return c};c.foreground=function(j){if(!arguments.length){return h}h=j;return c};c.inner=function(j){if(!arguments.length){return f}f=j;return c};c.icon=function(j){if(!arguments.length){return e}e=j;return c};c.active=function(j){if(!arguments.length){return i}i=j;return c};return c}
/*! openspending.colors.js - Color palettes for OpenSpending
 * ------------------------------------------------------------------------
 *
 * Copyright 2013 Open Knowledge Foundation
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
;var OpenSpending=OpenSpending||{};OpenSpending.Colors=OpenSpending.Colors||{};OpenSpending.Colors.Fallback="#424242";OpenSpending.Colors.DefaultPalette=["#CA221D","#C22769","#3F93E1","#481B79","#6AAC32","#42928F","#D32645","#CD531C","#EDC92D","#A5B425","#211D79","#449256","#7A2077","#CA221D","#E29826","#44913D","#2458A3","#2458A3","#14388C"];OpenSpending.Colors.Cofog={"01":"#C75746","02":"#0AB971","03":"#EC2406","04":"#790586","05":"#2A3A03","06":"#D33673","07":"#4E6D00","08":"#938626","09":"#EDC92D","10":"#935B3B"};OpenSpending.Colors.DefaultPalette.getColor=function(f,d,e){var c=this.slice(0);if(e){var a=c.indexOf(e.toUpperCase());if(a!==-1){c.splice(a,1)}}if(d===undefined){return OpenSpending.Colors.Fallback}return c[(d||0)%(c.length)]};OpenSpending.Colors.Cofog.getColor=function(f,c,e){var d=(typeof f==="string")?f:(f.name||f.id);if(d===undefined){return OpenSpending.Colors.Fallback}var a=d.substr(0,2);return this[a]||OpenSpending.Colors.Fallback};
/*! openspending.common.js - Common javascript utils for openspendingjs
 * ------------------------------------------------------------------------
 *
 * Copyright 2013 Open Knowledge Foundation
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
;var OpenSpending=OpenSpending||{};OpenSpending.Common=OpenSpending.Common||{};OpenSpending.Common.parseQueryString=function(a){var h=a||window.location.search.substring(1);var c={};var d=function(i){return unescape(i.replace(/\+/g," "))};var f=/([^&=]+)=?([^&]*)/g;var e=undefined;while(e=f.exec(h)){c[d(e[1])]=d(e[2])}return c};
/*! openspending.csvloader.js - CSV load API tools
 * ------------------------------------------------------------------------
 *
 * Copyright 2015 Open Knowledge Foundation
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
;var OpenSpending=OpenSpending||{};OpenSpending.CSVloader=function(){this.get=function(a){CSV.fetch({url:a.aggregated_csv_url}).done(function(e){var k=e.fields.slice(0,e.fields.length-1),c=a.amount_col_name||"amount",i=e.fields.indexOf(c),j=a.currency,f=a.labels;function d(n){if(n!==null){return n.toString().toLowerCase().replace(/\s+/g,"-").replace(/[^\w\-]+/g,"").replace(/\-\-+/g,"-").replace(/^-+/,"").replace(/-+$/,"")}else{return"null_id"}}function h(u,t,o,p,n){var q;if(typeof(f)!=="undefined"&&(typeof(f[o])!=="undefined")){q=f[o]}else{q=o}this.id=String(t);this.name=String(o);this.amount=p;this.label=q;this.level=u;this.children=[];this.currency=n;this.addchild=function(w){for(var v in this.children){var z=this.children[v];if(z.id===w.id){z.amount+=w.amount;return z}}this.children.push(w);return w}}var l=new h(0,"root","root",0,j);e.records.forEach(function(p){var o=p.splice(i,1);var n=function(u,q,t){if(t===(k.length)){}else{n(u.addchild(new h(t+1,d(p[t]),p[t],Number(o),j)),k,t+1)}if(t===0){l.amount+=Number(o)}};n(l,k,0)});a.callback(l)});return{}}};
/*! openspending.icons.js - Icons for OpenSpending
 * ------------------------------------------------------------------------
 *
 * Copyright 2013 Open Knowledge Foundation
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
;var OpenSpending=OpenSpending||{};OpenSpending.Icons=OpenSpending.Icons||{};OpenSpending.Icons.Cofog1={"01":"government-uk.svg","02":"defence.svg","03":"order-safety.svg","04":"social-systems.svg","05":"environment.svg","06":"our-streets.svg","07":"health.svg","08":"culture.svg","09":"schools.svg","10":"helping-others.svg"};OpenSpending.Icons.Cofog2={"01.1":"legislative.svg","01.2":"aid.svg","01.3":"misc-services.svg","01.4":"research.svg","01.6":"unemployment.svg","01.7":"public-debt.svg","01.8":"economic-aid.svg","02.1":"military.svg","02.2":"civil-defence.svg","02.3":"foreign-military-aid.svg","02.4":"defence-research.svg","02.5":"defence-admin.svg","03.1":"police.svg","03.2":"fire-brigade.svg","03.3":"courts.svg","03.4":"prisons.svg","03.5":"rd-order-safety.svg","03.6":"admin-order-safety.svg","04.1":"social-systems.svg","04.2":"farms.svg","04.3":"energy.svg","04.4":"manufactoring-construction.svg","04.5":"transport.svg","04.6":"communication.svg","04.7":"misc-services.svg","04.8":"research.svg","04.9":"money.svg","05.1":"waste.svg","05.2":"toilet.svg","05.3":"pollution.svg","05.4":"tree.svg","05.6":"environment-admin.svg","06.1":"housing.svg","06.2":"community.svg","06.3":"water.svg","06.4":"street-lights.svg","07.2":"health.svg","07.3":"hospital.svg","07.5":"research.svg","07.6":"other-medical.svg","08.2":"culture.svg","08.1":"sports.svg","08.3":"media.svg","08.6":"admin-culture.svg","09.1":"secondary-lower.svg","09.2":"post-secondary.svg","09.4":"education.svg","09.6":"research.svg","09.8":"admin.svg","10.1":"helping-others.svg","10.2":"old-age.svg","10.4":"family.svg","10.5":"unemployment.svg","10.7":"family2.svg","10.9":"admin.svg"};OpenSpending.Icons.Cofog3={"01.1.1":"legislative.svg","01.1.2":"pig.svg","01.1.3":"worldmap.svg","01.2.1":"aid-developing-countries.svg","01.2.2":"economic-aid.svg","01.3.1":"human-resources.svg","01.3.2":"planning.svg","01.3.3":"research.svg","03.1.0":"police.svg","03.3.0":"courts.svg","03.6.0":"admin-order-safety.svg","04.1.1":"social-systems.svg","04.1.2":"labour.svg","04.2.1":"farms.svg","04.2.2":"forest.svg","04.2.3":"fishing.svg","04.3.1":"coal.svg","04.3.2":"petrol.svg","04.3.3":"nuclear.svg","04.3.4":"fuel.svg","04.3.5":"electricity.svg","04.3.6":"wind.svg","04.5.1":"car.svg","04.5.2":"anchor.svg","04.5.3":"railways.svg","04.5.4":"airplane.svg","04.8.4":"coal.svg","04.9.0":"financial-admin.svg","06.1.0":"housing.svg","06.3.0":"water.svg","07.1.1":"medical-supplies.svg","07.1.2":"other-medical-products.svg","07.1.3":"wheelchair.svg","07.2.1":"health.svg","07.2.2":"microscope.svg","07.2.2":"dental.svg","07.3.1":"hospital.svg","07.3.2":"hospital-specialized.svg","07.3.2":"dental.svg","09.1.1":"pre-school.svg","09.1.2":"primary.svg","10.1.2":"helping-others.svg","10.2.0":"old-age.svg","10.5.0":"unemployment.svg"};OpenSpending.Icons.Cofog=jQuery.extend({},OpenSpending.Icons.Cofog1,OpenSpending.Icons.Cofog2,OpenSpending.Icons.Cofog3);OpenSpending.Icons.Cofog.getIcon=function(d,c){if(typeof d=="string"){var a=d.replace(/(\D)/g,".");return(c||"")+(this[a]||"unknown.svg")}return c||"unknown.svg"};
/*! openspending.taxman.js - Taxman API tools
 * ------------------------------------------------------------------------
 *
 * Copyright 2013 Open Knowledge Foundation
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
;var OpenSpending=OpenSpending||{};OpenSpending.Taxman=function(d){var a=this;this.taxes=undefined;var c=$.extend(true,{},OpenSpending.Taxman.defaults,d);this.get=function(f){c.incomeparser(f);var e=$.getJSON(c.site+"/"+c.country+"?callback=?",c.opts).done(function(h){a.taxes=c.success(h);c.callback(a.taxes)});return e}};OpenSpending.Taxman.defaults={site:"http://taxman.openspending.org",country:undefined,opts:{},callback:function(a){},incomeparser:function(a){this.opts.income=a},success:function(a){return a}};!function(a){a.barchart=function(i,f){var d=a(i);var e=a.extend(true,{},a.barchart.defaults,a.barchart.domopts(i),f);var j=Raphael(i,e.width,e.height);var h=function(l){var o=_.max(l.children,function(p){return p.amount});var n=e.width/l.children.length;j.clear();_.each(_.sortBy(l.children,function(p){return p.label}),function(N,v){var q=Math.ceil((N.amount/o.amount)*e.height);var C=(n-10);var t=e.style.bubbletop?C/2:0;var E=n*v;var G=e.height-q;var H=500;var J=j.rect(E,e.height,C,0).attr({fill:e.style.colors.getColor(N,v),stroke:"none"});var O=Raphael.animation({y:G+t,height:q-t},H);var M=j.rect(E,0,C,e.height).attr({fill:"#fff",opacity:0});var u={content:e.style.labels.tooltip.content(N),position:{target:"mouse",adjust:{x:7,y:7}}};a(M.node).qtip(u);M.click(function(){var P=e.click(l);if(P){h(N)}});if(e.style.bubbletop){var F=j.circle(E+t,e.height,t).attr({fill:e.style.colors.getColor(N,v),stroke:"none"});F.data("icon",e.style.icons.svg.getIcon(N.name));console.log(N.name);F.data("bbox",{x:E,y:G,width:C,height:C});F.data("overlay",M);final_bubblepos={cy:G+t};if(q>t){F.animateWith(J,J.animate(O),final_bubblepos,H,"linear",function(){k(F,function(){M.toFront()})})}else{var p=Raphael.animation(final_bubblepos,H);F.animate(p)}}else{J.animate(O)}if(e.style.labels){var B=j.text(E,G+t,e.style.labels.title.content(N));var w=j.text(E,G+t,e.style.labels.value.content(N));var D=B.getBBox();if((q-C)<D.width){var z=(q-C)/D.width;var L=80*z;var I=z;if(L<0){B.attr({"fill-opacity":0})}else{B.attr({fill:"0-"+e.style.labels.title.color+":"+L+"-"+e.style.labels.title.color+":"+I,"fill-opacity":0})}}else{B.attr({fill:e.style.labels.title.color})}B.transform("r270T10,"+(e.height-(D.y+D.width/2)-10));var A=w.getBBox();if((q-C)<A.width){w.attr({"fill-opacity":0})}else{w.attr({fill:e.style.labels.value.color})}w.transform("r270T"+(C-10)+","+(e.height-(A.y+A.width/2)-10))}M.toFront()});var k=function(p,t){var q=e.style.icons.path+p.data("icon");if(q){a.get(q).then(function(u){if(typeof u==="string"){u=a(u);u=u[u.length-1]}if(!u.getElementsByTagName){return}var A="";var D=u.getElementsByTagName("path");for(var w=0;w<D.length;w++){A+=D[w].getAttribute("d")+" "}var z=j.path(A);z.attr({fill:"#fff",stroke:"none"});var C=z.getBBox();bubble_box=p.data("bbox");z.translate((bubble_box.x+bubble_box.width/2)-(C.x+C.width/2),(bubble_box.y+bubble_box.height/2)-(C.y+C.height/2));var v=bubble_box.width*0.6;var B=v/Math.max(C.width,C.height);z.scale(B,B);t()})}}};var c=function(){var k=[];for(var n in e.data.cuts){k.push(n+":"+e.data.cuts[n])}if(e.data.aggregated_csv_url){var l=new OpenSpending.CSVloader();l.get({amount_col_name:e.data.amount_col_name,currency:e.data.currency,aggregated_csv_url:e.data.aggregated_csv_url,callback:h})}else{if(e.data.drilldowns){var o=new OpenSpending.Aggregator();o.get({siteUrl:e.data.site,dataset:e.data.dataset,drilldowns:e.data.drilldowns,inflate:e.data.inflate,cuts:k,rootNodeLabel:"total",callback:h})}}};c()};a.barchart.defaults={data:{site:"https://openspending.org/",dataset:undefined,drilldowns:[],year:undefined,cuts:{},inflate:undefined},click:function(c){return true},width:600,height:400,style:{bubbletop:true,labels:{title:{content:function(c){return c.label},color:"#fff"},value:{content:function(c){return OpenSpending.Amounts.shorthand(c.amount)},color:"#fff"},tooltip:{content:function(c){return c.label+": "+OpenSpending.Amounts.format(c.amount,0,c.currency)}}},colors:OpenSpending.Colors.Cofog,icons:{svg:OpenSpending.Icons.Cofog,path:"https://rawgit.com/openspending/openspendingjs/master/src/svg/"}},currency:undefined};a.barchart.domopts=function(d){var c=a(d);return{data:{site:c.attr("data-site"),dataset:c.attr("data-dataset"),drilldowns:c.attr("data-drilldowns")?c.attr("data-drilldowns").split(","):undefined,year:c.attr("data-year"),cuts:c.attr("data-cuts")?JSON.parse(c.attr("data-cuts")):undefined,inflate:c.attr("data-inflate")},width:c.attr("data-width"),height:c.attr("data-height"),style:{colors:c.attr("data-color")?{getColor:function(){return c.attr("data-color")}}:undefined,icons:{path:c.attr("data-icons-path")}}}};a.fn.extend({barchart:function(c){if(c==undefined){c={}}this.each(function(){a.barchart(this,c)})}});a(".barchart[data-dataset]").barchart()}(jQuery);
/*! jquery.bubbletree.js - Bubbletree visualisation for OpenSpending
 * ------------------------------------------------------------------------
 *
 * Copyright 2013 Open Knowledge Foundation
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
;!function(a){a.bubbletree=function(f,e){$element=a(f);$element.css("width",$element.width());$element.css("height",$element.width());$element.addClass("openspending-bt");var d=a.extend(true,{},a.bubbletree.defaults,a.bubbletree.domopts(f),e);var i={aggregated_csv_url:d.data.aggregated_csv_url,drilldowns:d.data.drilldowns,breakdown:d.data.breakdown};var h=function(l){var k=a('<div class="tooltip">Tooltip</div>');$element.append(k);k.hide();self.bubbleTree=new BubbleTree({data:l,container:$element,bubbleType:d.style.bubbletype,clearColors:d.style.clearcolor,bubbleStyles:d.style,tooltip:{qtip:true,delay:800,content:function(n){var o=OpenSpending.Amounts.format(n.amount,0,n.currency);return[n.label,(n.description?'<div class="desc">'+n.description+"</div>":"")+'<div class="amount">'+o+"</div>"]}}})};var j=function(){$element.empty();self.state=i;var k=[];for(var n in d.data.cuts){if(_.isArray(d.data.cuts[n])){_.each(d.data.cuts[n],function(p){k.push(n+":"+p)})}else{k.push(n+":"+d.data.cuts[n])}}if(d.data.year){k.push("time.year:"+d.data.year)}if(i.aggregated_csv_url){var l=new OpenSpending.CSVloader();l.get({amount_col_name:d.data.amount_col_name,currency:d.data.currency,aggregated_csv_url:d.data.aggregated_csv_url,labels:d.data.labels,callback:h})}else{if(i.drilldowns){var o=new OpenSpending.Aggregator();o.get({siteUrl:d.data.site,dataset:d.data.dataset,rootNodeLabel:d.root.label,drilldowns:i.drilldowns,inflate:d.data.inflate,cuts:k,breakdown:i.breakdown,callback:h})}}};var c=function(){$element.addClass("bubbletree-widget");var k=a('<div class="tooltip"/>');$element.append(k);k.hide();j(self.state)};c()};a.bubbletree.defaults={data:{site:"https://openspending.org/",dataset:undefined,breakdown:[],drilldowns:[],year:undefined,cuts:{},inflate:undefined},root:{label:"Total"},click:function(c){return true},style:{bubbletype:"icon",clearcolor:false,radius:{max:40,padding:10},icons:{svg:OpenSpending.Icons.Cofog,path:"https://rawgit.com/openspending/openspendingjs/master/src/svg/"},colors:OpenSpending.Colors.Cofog},currency:undefined};a.bubbletree.domopts=function(d){var c=a(d);return{data:{site:c.attr("data-site"),dataset:c.attr("data-dataset"),drilldowns:a(d).attr("data-drilldowns")?c.attr("data-drilldowns").split(","):undefined,year:c.attr("data-year"),cuts:a(d).attr("data-cuts")?JSON.parse(c.attr("data-cuts")):undefined,inflate:c.attr("data-inflate")},style:{radius:{max:c.attr("data-max-radius"),padding:c.attr("data-radius-padding")},icons:{path:c.attr("data-icons-path")}},currency:c.attr("data-currency")}};a.fn.extend({bubbletree:function(c){if(c==undefined){c={}}this.each(function(){a.bubbletree(this,c)})}});a(".bubbletree").bubbletree()}(jQuery);
/*! openspending.choropleth.js - Choropleth map creator
 * ------------------------------------------------------------------------
 *
 * Copyright 2013 Open Knowledge Foundation
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
;!function(a){a.choropleth=function(e,d){var c=a.extend(true,{},a.choropleth.defaults,a.choropleth.domopts(e),d);var f=$K.map(e,c.width,c.height);f.loadMap(c.map.url,function(h){a.ajax({url:c.data.url,dataType:"jsonp",success:function(j){var i={};a.each(c.data.objects(j),function(k,l){i[c.data.id(l)]=c.data.intensity(l)});h.addLayer({id:c.map.group,className:"bg",key:c.map.id,filter:function(k){return !i.hasOwnProperty(k[c.map.id])}});h.addLayer({id:c.map.group,key:c.map.id,filter:function(k){return i.hasOwnProperty(k[c.map.id])}});h.choropleth({data:i,colors:function(k){if(k===null){return"#fff"}return c.colorscale.getColor(k)},duration:function(k){return Math.min(900,300*k)},delay:function(k){return 100+200*(10-k)+Math.random()*300}});h.onLayerEvent("click",function(k){c.click(k)})}})},{padding:5})};a.choropleth.defaults={width:640,height:320,data:{url:"http://openspending.org/datasets.json",objects:function(c){return c.territories},intensity:function(c){return c.count},id:function(c){return c.code}},map:{url:"http://openspending.org/static/openspendingjs/app/spending-map/world.svg",group:"regions",id:"iso2"},click:function(c){},colorscale:new chroma.ColorScale({colors:chroma.brewer.Greens,limits:[-2,-1,0,1,2,3,4,5,6,7]})};a.choropleth.domopts=function(c){return{width:a(c).attr("data-map-width"),height:a(c).attr("data-map-height"),data:{url:a(c).attr("data-url"),objects:a(c).attr("data-objects")?function(d){return d[a(c).attr("data-objects")]}:undefined,intensity:a(c).attr("data-intensity")?function(d){return d[a(c).attr("data-intensity")]}:undefined,id:a(c).attr("data-id")?function(d){return d[a(c).attr("data-id")]}:undefined},map:{url:a(c).attr("data-map-url"),group:a(c).attr("data-map-group"),id:a(c).attr("data-map-path-id")}}};a.fn.extend({choropleth:function(c){if(c==undefined){c={}}this.each(function(){a.choropleth(this,c)})}});a(".choropleth").choropleth()}(jQuery);
/*! jquery.dailybread.js - Dailybread visualisation for OpenSpending
 * ------------------------------------------------------------------------
 *
 * Copyright 2013 Open Knowledge Foundation
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
;!function(a){a.dailybread=function(j,q){var o=a(j);var p=undefined;var f=a.extend(true,{},a.dailybread.defaults,a.dailybread.domopts(j),q);var d=function(v,u,z){var G=a('<div class="slice"/>').css("width",u);var E=a('<h5 class="header" />').text(v.label);var w=a('<div class="bubble" />').attr("id",v.id);var B=f.style.radius.fixed||Math.min(u/2-f.style.radius.padding,f.style.radius.max);var F=_.keys(v.children);var C=(F.length>1)||(F.length===1&&v.children[F[0]].label!==v.label);var D=bubble().icon(f.style.icons.svg.getIcon(v.name,f.style.icons.path)).radius(B).inner(C).background(f.style.colors.getColor(v));D.call(this,w);G.data("bubble",D);G.click(function(H){var I=f.click(H);if(C&&I){a("."+v.data.taxonomy+" .active.slice").each(function(J){l(a(this));a(this).removeClass("active")});if(!D.active()){G.addClass("active")}l(G);h(v)}});var t=a('<p class="amount" />').data("key",v.key).data("percentage",v.data.percentage);var A=v.data.percentage*(p.taxes.direct||0);a.each(v.key,function(H,I){A+=p.taxes.contributions[I].total});t.text(OpenSpending.Amounts.format((A/f.salary.division),2,f.currency));G.append(E);G.append(w);G.append(t);return G};var e=function(t,u){a(".amount").each(function(v){$slice=a(this);var w=$slice.data("percentage")*t;a.each($slice.data("key"),function(z,A){w+=u[A].total});$slice.text(OpenSpending.Amounts.format((w/f.salary.division),2,f.currency))})};var l=function(u){var t=u.data("bubble");t.active(!t.active());var v=t.background();t.background(t.foreground());t.foreground(v);t.call(this,u.find(".bubble"))};var k=function(u){var v=_.sortBy(u,function(z){return -z.order});var t=a('<div class="slices"/>');o.append(t);var w=Math.floor(t.width()/v.length);a.each(v,function(z){t.append(d(this,w))});return t};var c=function(w,u){if(u===undefined){u={}}var v={id:w.id,label:w.label||w.name,name:w.name,amount:w.amount,key:w.key||[],children:{},data:{taxonomy:w.taxonomy||(w.data||{}).taxonomy,node:w,currency:w.currency,percentage:((u.data||{}).percentage||1)*((w.amount||0)/(u.amount||w.amount))}};v.order=v.data.percentage*p.taxes.direct;for(var t in (w.children||[])){var z=w.children[t];v.children[z.name]=c(z,v)}return v};var n=function(u,w,t){var v=_.filter(w,function(z){return z.name.lastIndexOf((u.name||""),0)===0});_.each(v,function(B){var z=B.name.substr(0,t);if(!_.contains(u.key,B.key)){u.key.push(B.key)}var A=u.children[z];if(A===undefined){var A=c(_.clone(B),u);A.key=[];u.children[z]=A}if(!_.contains(A.key,B.key)){A.key.push(B.key)}A.order+=p.taxes.contributions[B.key].total})};var h=function(z){var w=c(z,z);var A=_.values(w.children)[0];var u=A.data.taxonomy;n(w,f.data.extra,A.name.length);f.currency=f.currency||w.data.currency;var t=k(w.children);var v=f.data.drilldowns.slice(f.data.drilldowns.indexOf(u));a("."+v.join(", .")).remove();t.addClass(u)};var i=function(){var t=[];for(var w in f.data.cuts){if(_.isArray(f.data.cuts[w])){_.each(f.data.cuts[w],function(z){t.push(w+":"+z)})}else{t.push(w+":"+f.data.cuts[w])}}if(f.data.year){t.push("time.year:"+f.data.year)}p=new OpenSpending.Taxman({country:f.taxman.country,opts:f.taxman.opts,incomeparser:f.taxman.income,success:function(z){return{direct:z.calculation.income_tax,indirect:z.calculation.indirects.vat,total:z.calculation.income_tax+z.calculation.indirects.vat,contributions:z.calculation.contributions}},callback:function(z){var A=v.checkbox.attr("checked")?z.direct+z.indirect:z.direct;v.tax(A+z.contributions.total);e(A,z.contributions)}});var v=new a.dailybread.controls(f,function(A,z){this.salary(z.value)},function(A,z){this.salary(z.value);p.get(z.value)});o.html(v.container);v.salary(f.salary.initial);v.checkbox.change(function(){var z=a(this).attr("checked")?p.taxes.total:p.taxes.direct;v.tax(z+p.taxes.contributions.total);e(z,p.taxes.contributions)});var u=p.get(f.salary.initial);if(f.data.drilldowns){u.done(function(z){var A=new OpenSpending.Aggregator();A.get({siteUrl:f.data.site,dataset:f.data.dataset,drilldowns:f.data.drilldowns,cuts:t,rootNodeLabel:"Total",callback:h})})}};i()};a.dailybread.controls=function(e,c,h){var d=this;this.container=a('<div class="controls" />');this.salary=function(i){if(!arguments.length){return a('<div class="salary" />').append(a("<h3/>").append(e.taxman.docs.salary)).append("<p></p>")}else{a(".salary p").text(OpenSpending.Amounts.format(i,0,e.currency))}};this.container.append(this.salary());this.slider=a('<div class="slider" />').append(a("<h2/>").append(e.taxman.docs.slider)).append(a("<div />").slider({value:e.salary.initial,min:e.salary.min,max:e.salary.max,step:e.salary.step,animate:true,slide:function(){c.apply(d,arguments)},change:function(){h.apply(d,arguments)}}));this.container.append(this.slider);this.tax=function(i){if(!arguments.length){return a('<div class="tax" />').append(a("<h3/>").append(e.taxman.docs.tax)).append("<p></p>")}else{a(".tax p").text(OpenSpending.Amounts.format(i,0,e.currency))}};this.container.append(this.tax());if(e.taxman.opts.indirects){var f=a("<span/>").css({color:"#828282","font-size":"12px"}).append(e.taxman.docs.assumption);this.checkbox=a('<input type="checkbox" name="indirects"/>');this.indirects=a('<div class="indirects" />').append(a("<label></label>").append(this.checkbox).append(e.taxman.docs.indirects+" ").append(f));this.container.append(this.indirects)}};a.dailybread.defaults={data:{site:"https://openspending.org/",dataset:undefined,drilldowns:[],year:undefined,cuts:{},extra:[]},click:function(c){return true},salary:{division:1,initial:0,min:0,max:0,step:0},taxman:{country:undefined,docs:{salary:"Salary",tax:"Your tax",slider:"Select your salary",indirects:"Include indirect taxes?",assumption:"Assumes you spend all of your net salary"},opts:{},income:function(c){this.opts.income=c}},style:{radius:{max:40,padding:10},icons:{svg:OpenSpending.Icons.Cofog,path:"/icons/"},colors:OpenSpending.Colors.Cofog},currency:undefined};a.dailybread.domopts=function(d){var c=a(d);return{data:{site:c.attr("data-site"),dataset:c.attr("data-dataset"),drilldowns:a(d).attr("data-drilldowns")?c.attr("data-drilldowns").split(","):undefined,year:c.attr("data-year"),cuts:a(d).attr("data-cuts")?JSON.parse(c.attr("data-cuts")):undefined},salary:{division:c.attr("data-salary-division"),initial:c.attr("data-salary-initial"),min:c.attr("data-salary-minimum"),max:c.attr("data-salary-maximum"),step:c.attr("data-salary-step")},taxman:{country:c.attr("data-taxman-country"),docs:{salary:c.attr("data-taxman-docs-salary"),tax:c.attr("data-taxman-docs-tax"),slider:c.attr("data-taxman-docs-slider"),indirects:c.attr("data-taxman-docs-indirects")}},style:{radius:{max:c.attr("data-max-radius"),padding:c.attr("data-radius-padding")},icons:{path:c.attr("data-icons-path")}},currency:c.attr("data-currency")}};a.fn.extend({dailybread:function(c){if(c==undefined){c={}}this.each(function(){a.dailybread(this,c)})}});a(".dailybreads").dailybread()}(jQuery);!function(a){a.linebars=function(f,e){var d=a.extend(true,{},a.linebars.defaults,a.linebars.domopts(f),e);var i=[20,0,20,50];var h=d.width-i[1]-i[3];var c=d.height-i[0]-i[2];var j=function(l){var k=[l.data.siteUrl,"/api/2/aggregate?dataset=",l.data.dataset,"&measure=",l.data.measure];if(l.data.drilldowns){k.push("&drilldown=");k.push(l.data.drilldowns.join("|"))}if(l.data.cuts){k.push("&cut=");k.push(l.data.cuts.join("|"))}return k.join("")};d3.json(j(d),function(p){var q=d3.select(f).append("svg").attr("width",d.width).attr("height",d.height);var A=_.unique(_.pluck(_.pluck(p.drilldown,_.last(d.data.drilldowns)),"label"));var v=_.map(_.unique(_.pluck(_.pluck(p.drilldown,"time"),"year")),function(E){return parseInt(E)});var t=_.values(_.reduce(p.drilldown,function(E,G){var F=G[_.last(d.data.drilldowns)].label;E[F]=E[F]||[];E[F].push(G);return E},{}));t=_.map(t,function(F){var E=_.map(_.pluck(_.pluck(F,"time"),"year"),function(G){return parseInt(G)});_.each(_.difference(v,E),function(G){var H={time:{year:G}};H[d.data.measure]=0;H[_.last(d.data.drilldowns)]={label:_.first(F)[_.last(d.data.drilldowns)].label};F.push(H)});return F});t=_.map(t,function(E){return _.sortBy(_.map(E,function(F){F.time.year=parseInt(F.time.year);return F}),function(F){return F.time.year})});var w=(h/A.length)*0.7;var C=(h/A.length)*0.3;var l=d3.scale.linear().domain([_.min(v),_.max(v)]).range([0,w]);var B=function(F,E){return E(_.map(F,function(G){return E(_.pluck(G,d.data.measure))}))};var o=d3.scale.linear().domain([0,B(t,_.max)]).range([c-i[2],i[0]]);var D=d3.svg.line().x(function(E){return l(E.time.year)}).y(function(E){return o(E[d.data.measure])});var u=_.map(t,function(H){var G={time:{year:_.min(v)}};G[d.data.measure]=0;G[_.last(d.data.drilldowns)]={label:_.first(H)[_.last(d.data.drilldowns)].label};var F=[G];_.each(H,function(I){F.push(I)});var E={time:{year:_.max(v)}};E[d.data.measure]=0;E[_.last(d.data.drilldowns)]={label:_.first(H)[_.last(d.data.drilldowns)].label};F.push(E);return F});var z=q.selectAll("g.bar").data(u).enter().append("g").attr("class","bar").attr("transform",function(F,E){return"translate("+[i[3]+E*(w+C),0]+")"});z.append("path").attr("d",function(E){return D(E)}).attr("class","bar");z.append("path").attr("d",function(E){return D(_.rest(_.initial(E)))}).attr("class","topline");z.append("text").attr("x",w/2).attr("y",c-i[2]+30).attr("text-anchor","middle").text(function(E){return _.first(E)[_.last(d.data.drilldowns)].label});z.selectAll("text.dotlabel").data(function(E){return _.initial(_.rest(E))}).enter().append("text").attr("class","dotlabel").attr("x",function(E){return l(E.time.year)}).attr("y",function(E){return o(E[d.data.measure])-7}).attr("text-anchor","middle").text(function(E){return d3.format(".2s")(E[d.data.measure])});z.selectAll("text.yearlabel").data([_.first(v),_.last(v)]).enter().append("text").attr("class","yearlabel").attr("x",function(E){return l(E)}).attr("y",c-i[2]+10).attr("text-anchor","middle").text(function(E){return E});z.on("click",function(G,F,E){if(d3.select(this).classed("selected")){this.setAttribute("class","bar")}else{this.setAttribute("class","bar selected")}});var k=d3.scale.linear().domain([B(t,_.min),B(t,_.max)]).range([o(B(t,_.min)),o(B(t,_.max))]);var n=d3.svg.axis().orient("left").scale(k).ticks(5).tickFormat(d3.format("s"));q.append("g").attr("class","axis").attr("transform","translate(45,0)").call(n)})};a.linebars.defaults={data:{siteUrl:"https://openspending.org",measure:"amount",dataset:undefined,drilldowns:[],cuts:[]},width:600,height:400};a.linebars.domopts=function(d){var c=a(d);return{data:{site:c.attr("data-site"),dataset:c.attr("data-dataset"),drilldowns:c.attr("data-drilldowns")?c.attr("data-drilldowns").split(","):undefined,cuts:c.attr("data-cuts")?c.attr("data-cuts").split(","):undefined},width:c.attr("data-width"),height:c.attr("data-height")}};a.fn.extend({linebars:function(c){if(c==undefined){c={}}this.each(function(){a.linebars(this,c)})}});a(".linebars[data-dataset]").linebars()}(jQuery);!function(a){a.stackedbar=function(h,n){var e=a.extend(true,{},a.stackedbar.defaults,a.stackedbar.domopts(h),n);var d=e.width;var l=e.height;var f=f={left:20,right:20,top:35,bottom:20};var j=[];var i=function(u,p){var t=(l/u.length)*0.6;var q=(l-t*u.length)/(u.length*1);u=_.sortBy(u,function(v){return -v.amount});scale=d3.scale.linear().domain([0,u[0].amount]).range([0,d]);_.each(u,function(w,v){w.dy=(q+t)*v;w.dx=0;w.dh=q;w.dw=scale(w.amount)});p.selectAll("g.bar").remove();var o=p.selectAll("g.bar").data(u).enter().append("g").attr("class","bar").append("rect").attr("x",function(v){return v.x}).attr("y",function(v){return v.y}).attr("width",function(v){return v.width}).attr("height",function(v){return v.height});o.transition().attr("height",function(v){return v.dh}).transition().attr("y",function(v){return v.dy}).transition().attr("x",function(v){return v.dx}).transition().attr("width",function(v){return v.dw});setTimeout(function(){k(u,p)},2000)};console.log("declaring draw");var k=function(w,u){w=_.sortBy(w,function(B){return -B.amount});u.selectAll("g").remove();var z=(l/w.length)*0.6;var t=(l-z*w.length)/(w.length*1);var q=d3.scale.linear().domain([0,w[0].amount]).range([0,d]);_.each(w,function(E,D){var F=(t+z)*D;var C=0;var B=t;if(E.children.length===0){E.children=[E]}_.each(E.children,function(G){G.x=C;G.y=F;G.height=B;G.width=q(G.amount);C=C+G.width})});var o=d3.format(",f");var p=u.selectAll("g.bar").data(w).enter().append("g").attr("class","bar").on("click",function(B){if(B.children.length>1){i(B.children,u)}});var A=p.selectAll("rect").data(function(B){return B.children}).enter().append("rect").attr("x",function(B){return B.x}).attr("y",function(B){return B.y}).attr("width",function(B){return B.width}).attr("height",function(B){return B.height}).append("title").text(function(B){return B.label+" "+o(B.amount)+B.currency});var v=p.append("text").text(function(B){return B.label+" "+o(B.amount)+B.currency}).attr("x",0).attr("y",function(C,B){return(t+z)*B}).attr("text-anchor","top");j.push({label:_.first(w).taxonomy,data:w});console.log(j);u.selectAll("svg ul").remove();u.append("foreignObject").attr("x",0).attr("y",-35).attr("width",d).attr("height",20).append("xhtml:body").append("ul").attr("class","sb-breadcrumbs").selectAll("li").data(j).enter().append("li").text(function(B){return B.label}).on("click",function(B){j=j.slice(0,j.indexOf(B));k(B.data,u)})};this.callback=function(o){var p=d3.select(h).append("svg").attr("width",d+f.left+f.right).attr("height",l+f.top+f.bottom).append("g").attr("transform","translate("+f.left+","+f.top+")");this.currency=o.currency;k(o.children,p)};e.data.callback=this.callback;var c=new OpenSpending.Aggregator();c.get(e.data)};a.stackedbar.defaults={data:{siteUrl:"https://openspending.org",measure:"amount",dataset:undefined,drilldowns:[],cuts:[]},width:600,height:600};a.stackedbar.domopts=function(d){var c=a(d);return{data:{site:c.attr("data-site"),dataset:c.attr("data-dataset"),drilldowns:c.attr("data-drilldowns")?c.attr("data-drilldowns").split(","):undefined,cuts:c.attr("data-cuts")?c.attr("data-cuts").split(","):undefined},width:c.attr("data-width"),height:c.attr("data-height")}};a.fn.extend({stackedbar:function(c){if(c==undefined){c={}}this.each(function(){a.stackedbar(this,c)})}});a(".stackedbar[data-dataset]").stackedbar()}(jQuery);!function(a){a.treemap=function(i,h){var e=a(i);if(!e.attr("id")){e.attr("id",Math.random().toString().substr(2))}var f=a.extend(true,{},a.treemap.defaults,a.treemap.domopts(i),h);var k={aggregated_csv_url:f.data.aggregated_csv_url,drilldowns:f.data.drilldowns,cuts:f.data.cuts,year:f.data.year,last:[]};var d=function(n){e.empty();if(!n.children.length){e.hide();return}e.show();var l=new $jit.TM.Squarified({injectInto:i,width:f.width,height:f.height,levelsToShow:1,titleHeight:0,animate:f.transition.animate,transition:f.transition.type,duration:f.transition.duration,offset:2,Label:{type:"HTML",size:12,family:"Tahoma, Verdana, Arial",color:"#DDE7F0"},onCreateLabel:function(p,o){f.node.label(p,o)},Tips:{enable:true,type:"Native",offsetX:20,offsetY:20,onShow:function(p,o){p.innerHTML=f.node.tooltip(o)}},Node:{color:"#243448",CanvasStyles:{shadowBlur:0,shadowColor:"#000"}},Events:{enable:true,onRightClick:function(o){var p=k.last.pop();if(k.last.length>0){j(k.last.pop())}else{k.last.push(p);alert("Not able to go any further")}},onClick:function(p){if(p){var q=f.click(p);if(q){if(p.data.node.children.length){j(p.data.node)}else{if(p.data.link){var o=this.embed?p.data.link+"?embed=true":p.data.link;document.location.href=o}else{alert("Not able to go any further")}}}}},onMouseEnter:function(o,p,q){if(o){if(o.data.link===undefined){e.find("#"+o.id).css("cursor","default")}o.setCanvasStyle("shadowBlur",8);o.orig_color=o.getData("color");o.setData("color","#A3B3C7");l.fx.plotNode(o,l.canvas)}},onMouseLeave:function(o){if(o){o.removeData("color");o.removeCanvasStyle("shadowBlur");o.setData("color",o.orig_color);l.plot()}}},request:function(t,u,q){var o=json;var p=$jit.json.getSubtree(o,t);$jit.json.prune(p,1);q.onComplete(t,p)}});l.loadJSON(n);l.refresh()};var j=function(l){k.last.push(l);var n={children:_.map(l.children,function(p,o){return{id:p.id,name:p.label||p.name,data:{node:p,value:p.amount,currency:p.currency,percentage:(p.amount/l.amount)*100,$area:p.amount,link:p.html_url,$color:p.color||f.colorscale.getColor(p,o)}}})};d(n)};var c=function(){k.drilldowns=k.drilldowns||[k.drilldown];k.cuts=k.cuts||{};var l=[];for(var o in k.cuts){l.push(o+":"+k.cuts[o])}if(k.year){l.push("time.year:"+k.year)}if(k.aggregated_csv_url){var n=new OpenSpending.CSVloader();n.get({amount_col_name:f.data.amount_col_name,currency:f.data.currency,aggregated_csv_url:f.data.aggregated_csv_url,labels:f.data.labels,callback:j})}else{if(k.drilldowns){var p=new OpenSpending.Aggregator();p.get({siteUrl:f.data.site,dataset:f.data.dataset,drilldowns:k.drilldowns,inflate:f.data.inflate,cuts:l,rootNodeLabel:"Total",callback:j})}}};e.addClass("treemap-widget");c()};a.treemap.defaults={data:{site:"https://openspending.org",dataset:undefined,drilldowns:[],year:undefined,cuts:{},inflate:undefined},click:function(c){return true},width:600,height:400,embed:false,colorscale:OpenSpending.Colors.DefaultPalette,transition:{animate:true,type:$jit.Trans.Expo.easeOut,duration:1000},node:{label:function(d,c){if(c.data.percentage>3){d.innerHTML=['<div class="desc"><div class="amount">',OpenSpending.Amounts.format(c.data.value,0,c.data.currency),'</div><div class="lbl">',c.name,"</div></div>"].join("")}},tooltip:function(c){return[c.name," (",OpenSpending.Amounts.format(c.data.percentage,2),"%)"].join("")}}};a.treemap.domopts=function(d){var c=a(d);return{data:{site:c.attr("data-site"),dataset:c.attr("data-dataset"),drilldowns:a(d).attr("data-drilldowns")?c.attr("data-drilldowns").split(","):undefined,year:c.attr("data-year"),cuts:a(d).attr("data-cuts")?JSON.parse(c.attr("data-cuts")):undefined,inflate:c.attr("data-inflate")},width:c.attr("data-width"),height:c.attr("data-height"),transition:{duration:c.attr("data-duration")}}};a.fn.extend({treemap:function(c){if(c==undefined){c={}}this.each(function(){a.treemap(this,c)})}});a(".treemap[data-dataset]").treemap()}(jQuery);